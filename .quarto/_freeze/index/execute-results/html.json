{
  "hash": "6762a852fa1452b05b012b639a5660e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"SQL handbook\"\nauthor: \"Tony Duan\"\nexecute:\n  warning: false\n  error: false\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\n\nThis document provides a comprehensive guide to performing common data manipulation tasks using SQL, R, and Python. It serves as a reference for understanding how to achieve similar outcomes across these three popular data analysis tools.\n\n## Introduction to Data Analytics Tools\n\nIn data analysis, we work with different tools, each with its strengths:\n\n- **SQL**: Excellent for structured query and database operations\n- **R**: Powerful statistical computing and data visualization\n- **Python**: Versatile programming with great data science libraries\n\nThis tutorial shows how to accomplish the same data manipulation tasks across all three tools, helping you choose the right approach for your needs.\n\n\n# Setup and Configuration\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(reticulate)\npy_require(c(\"pandas\",\"Great-Tables\",\"polars\",\"pyarrow\"))\n\n# Load libraries for database interaction, data manipulation, and connections.\nlibrary(DBI)\nlibrary(tidyverse)\nlibrary(RSQLite)\nlibrary(connections)\nlibrary(duckdb)\n\n# Prepare the R dataframes.\n# Remove the existing mtcars dataset if it exists.\nrm(mtcars)\n# Create the mtcars dataframe from the base R dataset, adding the row names as a new column.\nmtcars = cbind(model_name = rownames(mtcars), mtcars) |> head(10)\n# Create the iris dataframe from the base R dataset.\niris = iris |> head(10)\n\n# Remove the database file if it already exists to start with a clean slate.\nif (file.exists(\"my-db.duckdb\")) {\n  file.remove(\"my-db.duckdb\")\n}\n# Establish a connection to the DuckDB database.\ncon <- dbConnect(duckdb(), dbdir = \"my-db.duckdb\", read_only = FALSE)\n# Write the iris and mtcars dataframes to the database as tables.\ndbWriteTable(con, \"iris_table\", iris, overwrite = TRUE)\ndbWriteTable(con, \"mtcars_table\", mtcars, overwrite = TRUE)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code  code-fold=\"true\"}\nimport pandas as pd\nimport polars as pl\nimport os\n\nfrom platform import python_version\n#print(python_version())\n\ncities_pd = pd.DataFrame({\n    'country': ['NL', 'NL', 'NL', 'US', 'US', 'US', 'US', 'US', 'US'],\n    'name': ['Amsterdam', 'Amsterdam', 'Amsterdam', 'Seattle', 'Seattle', 'Seattle', 'New York City', 'New York City', 'New York City'],\n    'year': [2000, 2010, 2020, 2000, 2010, 2020, 2000, 2010, 2020],\n    'population': [1005, 1065, 1158, 564, 608, 738, 8015, 8175, 8772]\n})\n\n# Make the R dataframes available in the Python environment.\nmtcars_pd = r.mtcars\niris_pd = r.iris\nmtcars_pl = pl.from_pandas(mtcars_pd)\niris_pl = pl.from_pandas(iris_pd)\ncities_pl=pl.from_pandas(cities_pd)\n```\n:::\n\n\n\n- There are tables `iris_table` and `mtcars_table` in the DuckDB database `my-db.duckdb`.\n- There are dataframes `iris` and `mtcars` in the R environment.\n- There are dataframes `iris` and `mtcars` in the Python environment.\n\n# Getting Started with Data Exploration\n\n## Show All Tables\n\nThis section demonstrates how to list all available tables or dataframes in each environment.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Show all tables in the connected database.\nSHOW ALL TABLES;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 2 records\n\n|database |schema |name         |column_names                                                                                                                             |column_types                                                                                                                                                                                                          |temporary |\n|:--------|:------|:------------|:----------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------|\n|my-db    |main   |iris_table   |Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species                                                                          |DOUBLE                                   , DOUBLE                                   , DOUBLE                                   , DOUBLE                                   , ENUM('setosa', 'versicolor', 'virginica') |FALSE     |\n|my-db    |main   |mtcars_table |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |FALSE     |\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# List all dataframes in the current R environment.\ndflist <- Filter(is.data.frame, as.list(.GlobalEnv))\nnames(dflist)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"mtcars\" \"iris\"  \n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# List all pandas dataframes in the current Python environment.\nimport pandas as pd\nalldfs = [var for var in dir() if isinstance(eval(var), pd.core.frame.DataFrame)]\nprint(alldfs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['cities_pd', 'iris_pd', 'mtcars_pd']\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport polars as pl\n\nalldfs = [name for name, val in globals().items() if isinstance(val, pl.DataFrame)]\nprint(alldfs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['mtcars_pl', 'iris_pl', 'cities_pl']\n```\n\n\n:::\n:::\n\n\n\n:::\n\n# Describe a Table\n\nThis section shows how to get a summary of a table's structure and statistics.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Describe the columns and data types of the mtcars_table.\nDESCRIBE mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|column_name |column_type |null |key |default |extra |\n|:-----------|:-----------|:----|:---|:-------|:-----|\n|model_name  |VARCHAR     |YES  |NA  |NA      |NA    |\n|mpg         |DOUBLE      |YES  |NA  |NA      |NA    |\n|cyl         |DOUBLE      |YES  |NA  |NA      |NA    |\n|disp        |DOUBLE      |YES  |NA  |NA      |NA    |\n|hp          |DOUBLE      |YES  |NA  |NA      |NA    |\n|drat        |DOUBLE      |YES  |NA  |NA      |NA    |\n|wt          |DOUBLE      |YES  |NA  |NA      |NA    |\n|qsec        |DOUBLE      |YES  |NA  |NA      |NA    |\n|vs          |DOUBLE      |YES  |NA  |NA      |NA    |\n|am          |DOUBLE      |YES  |NA  |NA      |NA    |\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Provide a detailed summary of the mtcars dataframe.\nskimr::skim(mtcars)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |       |\n|:------------------------|:------|\n|Name                     |mtcars |\n|Number of rows           |10     |\n|Number of columns        |12     |\n|_______________________  |       |\n|Column type frequency:   |       |\n|character                |1      |\n|numeric                  |11     |\n|________________________ |       |\n|Group variables          |None   |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|model_name    |         0|             1|   7|  17|     0|       10|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|     p0|    p25|    p50|    p75|   p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|------:|------:|------:|------:|------:|:-----|\n|mpg           |         0|             1|  20.37|  2.91|  14.30|  18.82|  21.00|  22.45|  24.40|▂▂▅▇▇ |\n|cyl           |         0|             1|   5.80|  1.48|   4.00|   4.50|   6.00|   6.00|   8.00|▅▁▇▁▃ |\n|disp          |         0|             1| 208.61| 90.37| 108.00| 150.02| 163.80| 249.75| 360.00|▇▇▅▁▅ |\n|hp            |         0|             1| 122.80| 51.45|  62.00|  97.50| 110.00| 119.75| 245.00|▅▇▁▂▂ |\n|drat          |         0|             1|   3.54|  0.44|   2.76|   3.16|   3.77|   3.90|   3.92|▁▃▁▁▇ |\n|wt            |         0|             1|   3.13|  0.41|   2.32|   2.94|   3.20|   3.44|   3.57|▂▂▂▆▇ |\n|qsec          |         0|             1|  18.58|  2.14|  15.84|  17.02|  18.45|  19.86|  22.90|▇▃▃▂▂ |\n|vs            |         0|             1|   0.60|  0.52|   0.00|   0.00|   1.00|   1.00|   1.00|▅▁▁▁▇ |\n|am            |         0|             1|   0.30|  0.48|   0.00|   0.00|   0.00|   0.75|   1.00|▇▁▁▁▃ |\n|gear          |         0|             1|   3.60|  0.52|   3.00|   3.00|   4.00|   4.00|   4.00|▅▁▁▁▇ |\n|carb          |         0|             1|   2.50|  1.35|   1.00|   1.25|   2.00|   4.00|   4.00|▆▆▁▁▇ |\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Generate descriptive statistics for the mtcars dataframe.\nmtcars_pd.describe(include='all')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       model_name        mpg       cyl  ...         am       gear       carb\ncount          10  10.000000  10.00000  ...  10.000000  10.000000  10.000000\nunique         10        NaN       NaN  ...        NaN        NaN        NaN\ntop     Mazda RX4        NaN       NaN  ...        NaN        NaN        NaN\nfreq            1        NaN       NaN  ...        NaN        NaN        NaN\nmean          NaN  20.370000   5.80000  ...   0.300000   3.600000   2.500000\nstd           NaN   2.907099   1.47573  ...   0.483046   0.516398   1.354006\nmin           NaN  14.300000   4.00000  ...   0.000000   3.000000   1.000000\n25%           NaN  18.825000   4.50000  ...   0.000000   3.000000   1.250000\n50%           NaN  21.000000   6.00000  ...   0.000000   4.000000   2.000000\n75%           NaN  22.450000   6.00000  ...   0.750000   4.000000   4.000000\nmax           NaN  24.400000   8.00000  ...   1.000000   4.000000   4.000000\n\n[11 rows x 12 columns]\n```\n\n\n:::\n:::\n\n\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.describe()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (9, 13)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>statistic</th><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;count&quot;</td><td>&quot;10&quot;</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td><td>10.0</td></tr><tr><td>&quot;null_count&quot;</td><td>&quot;0&quot;</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;mean&quot;</td><td>null</td><td>20.37</td><td>5.8</td><td>208.61</td><td>122.8</td><td>3.538</td><td>3.128</td><td>18.581</td><td>0.6</td><td>0.3</td><td>3.6</td><td>2.5</td></tr><tr><td>&quot;std&quot;</td><td>null</td><td>2.907099</td><td>1.47573</td><td>90.373896</td><td>51.449652</td><td>0.440651</td><td>0.40649</td><td>2.135845</td><td>0.516398</td><td>0.483046</td><td>0.516398</td><td>1.354006</td></tr><tr><td>&quot;min&quot;</td><td>&quot;Datsun 710&quot;</td><td>14.3</td><td>4.0</td><td>108.0</td><td>62.0</td><td>2.76</td><td>2.32</td><td>15.84</td><td>0.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;25%&quot;</td><td>null</td><td>18.7</td><td>4.0</td><td>146.7</td><td>95.0</td><td>3.15</td><td>2.875</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;50%&quot;</td><td>null</td><td>21.0</td><td>6.0</td><td>167.6</td><td>110.0</td><td>3.85</td><td>3.215</td><td>18.61</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr><tr><td>&quot;75%&quot;</td><td>null</td><td>22.8</td><td>6.0</td><td>258.0</td><td>123.0</td><td>3.9</td><td>3.44</td><td>20.0</td><td>1.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;max&quot;</td><td>&quot;Valiant&quot;</td><td>24.4</td><td>8.0</td><td>360.0</td><td>245.0</td><td>3.92</td><td>3.57</td><td>22.9</td><td>1.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n:::\n\n# Show Column Names\n\nThis section demonstrates how to retrieve the column names of a table.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Show information about the columns in mtcars_table.\nPRAGMA table_info(mtcars_table);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|cid |name       |type    |notnull |dflt_value |pk    |\n|:---|:----------|:-------|:-------|:----------|:-----|\n|0   |model_name |VARCHAR |FALSE   |NA         |FALSE |\n|1   |mpg        |DOUBLE  |FALSE   |NA         |FALSE |\n|2   |cyl        |DOUBLE  |FALSE   |NA         |FALSE |\n|3   |disp       |DOUBLE  |FALSE   |NA         |FALSE |\n|4   |hp         |DOUBLE  |FALSE   |NA         |FALSE |\n|5   |drat       |DOUBLE  |FALSE   |NA         |FALSE |\n|6   |wt         |DOUBLE  |FALSE   |NA         |FALSE |\n|7   |qsec       |DOUBLE  |FALSE   |NA         |FALSE |\n|8   |vs         |DOUBLE  |FALSE   |NA         |FALSE |\n|9   |am         |DOUBLE  |FALSE   |NA         |FALSE |\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the names of the columns in the mtcars dataframe.\nnames(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"model_name\" \"mpg\"        \"cyl\"        \"disp\"       \"hp\"        \n [6] \"drat\"       \"wt\"         \"qsec\"       \"vs\"         \"am\"        \n[11] \"gear\"       \"carb\"      \n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get a list of column names from the mtcars dataframe.\nimport pandas as pd\nlist(mtcars_pd.columns.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']\n```\n\n\n:::\n:::\n\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get a list of column names from the mtcars dataframe.\nmtcars_pl.columns\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n# Select\n\n## Select Top 6 and Rename\n\nThis section shows how to select a subset of columns, rename them, and limit the number of rows returned.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Select and rename columns, limiting the result to the top 6 rows.\nSELECT model_name as model, mpg, cyl FROM mtcars_table LIMIT 6;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 6 records\n\n|model             |  mpg| cyl|\n|:-----------------|----:|---:|\n|Mazda RX4         | 21.0|   6|\n|Mazda RX4 Wag     | 21.0|   6|\n|Datsun 710        | 22.8|   4|\n|Hornet 4 Drive    | 21.4|   6|\n|Hornet Sportabout | 18.7|   8|\n|Valiant           | 18.1|   6|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select and rename columns from the first 6 rows of the mtcars dataframe.\nhead(mtcars, 6) |> select(model = model_name, mpg, cyl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                              model  mpg cyl\nMazda RX4                 Mazda RX4 21.0   6\nMazda RX4 Wag         Mazda RX4 Wag 21.0   6\nDatsun 710               Datsun 710 22.8   4\nHornet 4 Drive       Hornet 4 Drive 21.4   6\nHornet Sportabout Hornet Sportabout 18.7   8\nValiant                     Valiant 18.1   6\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Rename a column in the mtcars dataframe.\nmtcars_pd.rename(columns={'model_name': 'model'})\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                               model   mpg  cyl   disp  ...   vs   am  gear  carb\nMazda RX4                  Mazda RX4  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0\nMazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0\nDatsun 710                Datsun 710  22.8  4.0  108.0  ...  1.0  1.0   4.0   1.0\nHornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  1.0  0.0   3.0   1.0\nHornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0  0.0   3.0   2.0\nValiant                      Valiant  18.1  6.0  225.0  ...  1.0  0.0   3.0   1.0\nDuster 360                Duster 360  14.3  8.0  360.0  ...  0.0  0.0   3.0   4.0\nMerc 240D                  Merc 240D  24.4  4.0  146.7  ...  1.0  0.0   4.0   2.0\nMerc 230                    Merc 230  22.8  4.0  140.8  ...  1.0  0.0   4.0   2.0\nMerc 280                    Merc 280  19.2  6.0  167.6  ...  1.0  0.0   4.0   4.0\n\n[10 rows x 12 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.select(pl.col(\"model_name\").alias(\"model\"), pl.col(\"mpg\"), pl.col(\"cyl\")).head(6)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (6, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model</th><th>mpg</th><th>cyl</th></tr><tr><td>str</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n## Select Distinct\n\nThis section demonstrates how to retrieve unique rows based on specified columns.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Select distinct combinations of mpg and cyl.\nSELECT DISTINCT mpg, cyl FROM mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 8 records\n\n|  mpg| cyl|\n|----:|---:|\n| 22.8|   4|\n| 18.1|   6|\n| 14.3|   8|\n| 18.7|   8|\n| 19.2|   6|\n| 21.0|   6|\n| 21.4|   6|\n| 24.4|   4|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get distinct rows based on mpg and cyl.\nmtcars |> distinct(mpg, cyl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   mpg cyl\nMazda RX4         21.0   6\nDatsun 710        22.8   4\nHornet 4 Drive    21.4   6\nHornet Sportabout 18.7   8\nValiant           18.1   6\nDuster 360        14.3   8\nMerc 240D         24.4   4\nMerc 280          19.2   6\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Select specific columns and drop duplicate rows.\ndf = mtcars_pd[[\"mpg\", \"cyl\"]]\nprint(df.drop_duplicates())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    mpg  cyl\nMazda RX4          21.0  6.0\nDatsun 710         22.8  4.0\nHornet 4 Drive     21.4  6.0\nHornet Sportabout  18.7  8.0\nValiant            18.1  6.0\nDuster 360         14.3  8.0\nMerc 240D          24.4  4.0\nMerc 280           19.2  6.0\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.select(pl.col(\"mpg\"), pl.col(\"cyl\")).unique()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (8, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>mpg</th><th>cyl</th></tr><tr><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>18.1</td><td>6.0</td></tr><tr><td>14.3</td><td>8.0</td></tr><tr><td>18.7</td><td>8.0</td></tr><tr><td>19.2</td><td>6.0</td></tr><tr><td>21.4</td><td>6.0</td></tr><tr><td>22.8</td><td>4.0</td></tr><tr><td>24.4</td><td>4.0</td></tr><tr><td>21.0</td><td>6.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Check Row and Column Number\n\nThis section shows how to find the dimensions of a table.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Get the total number of rows.\nSELECT count(*) AS row_number FROM mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| row_number|\n|----------:|\n|         10|\n\n</div>\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Get the total number of columns.\nSELECT count(*) AS column_number FROM (DESCRIBE mtcars_table);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| column_number|\n|-------------:|\n|            12|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the number of rows.\nnrow(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the number of columns.\nncol(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 12\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get the number of rows.\nmtcars_pd.shape[0]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n10\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get the number of columns.\nmtcars_pd.shape[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n12\n```\n\n\n:::\n:::\n\n\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get the number of rows.\nmtcars_pl.shape[0]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n10\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get the number of columns.\nmtcars_pl.shape[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n12\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n# Create Column\n\nThis section demonstrates how to add a new column to a table based on existing data.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Create a new column by performing a calculation on an existing column.\nSELECT *, mpg + 1 AS new_mpg FROM mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|model_name        |  mpg| cyl|  disp|  hp| drat|    wt|  qsec| vs| am| gear| carb| new_mpg|\n|:-----------------|----:|---:|-----:|---:|----:|-----:|-----:|--:|--:|----:|----:|-------:|\n|Mazda RX4         | 21.0|   6| 160.0| 110| 3.90| 2.620| 16.46|  0|  1|    4|    4|    22.0|\n|Mazda RX4 Wag     | 21.0|   6| 160.0| 110| 3.90| 2.875| 17.02|  0|  1|    4|    4|    22.0|\n|Datsun 710        | 22.8|   4| 108.0|  93| 3.85| 2.320| 18.61|  1|  1|    4|    1|    23.8|\n|Hornet 4 Drive    | 21.4|   6| 258.0| 110| 3.08| 3.215| 19.44|  1|  0|    3|    1|    22.4|\n|Hornet Sportabout | 18.7|   8| 360.0| 175| 3.15| 3.440| 17.02|  0|  0|    3|    2|    19.7|\n|Valiant           | 18.1|   6| 225.0| 105| 2.76| 3.460| 20.22|  1|  0|    3|    1|    19.1|\n|Duster 360        | 14.3|   8| 360.0| 245| 3.21| 3.570| 15.84|  0|  0|    3|    4|    15.3|\n|Merc 240D         | 24.4|   4| 146.7|  62| 3.69| 3.190| 20.00|  1|  0|    4|    2|    25.4|\n|Merc 230          | 22.8|   4| 140.8|  95| 3.92| 3.150| 22.90|  1|  0|    4|    2|    23.8|\n|Merc 280          | 19.2|   6| 167.6| 123| 3.92| 3.440| 18.30|  1|  0|    4|    4|    20.2|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add a new column to the dataframe.\nmtcars |> mutate(new_mpg = mpg + 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am\nMazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1\nMazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1\nDatsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1\nHornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0\nHornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0\nValiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0\nDuster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0\nMerc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0\nMerc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0\nMerc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0\n                  gear carb new_mpg\nMazda RX4            4    4    22.0\nMazda RX4 Wag        4    4    22.0\nDatsun 710           4    1    23.8\nHornet 4 Drive       3    1    22.4\nHornet Sportabout    3    2    19.7\nValiant              3    1    19.1\nDuster 360           3    4    15.3\nMerc 240D            4    2    25.4\nMerc 230             4    2    23.8\nMerc 280             4    4    20.2\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Create a new column in the dataframe.\nmtcars_pd[\"new_mpg\"] = mtcars_pd[\"mpg\"] + 1\nmtcars_pd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          model_name   mpg  cyl  ...  gear  carb  new_mpg\nMazda RX4                  Mazda RX4  21.0  6.0  ...   4.0   4.0     22.0\nMazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0\nDatsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8\nHornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4\nHornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7\nValiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1\nDuster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3\nMerc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4\nMerc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8\nMerc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2\n\n[10 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.with_columns((pl.col(\"mpg\") + 1).alias(\"new_mpg\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 13)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th><th>new_mpg</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td><td>22.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td><td>22.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td><td>23.8</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td><td>22.4</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td><td>19.7</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td><td>225.0</td><td>105.0</td><td>2.76</td><td>3.46</td><td>20.22</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td><td>19.1</td></tr><tr><td>&quot;Duster 360&quot;</td><td>14.3</td><td>8.0</td><td>360.0</td><td>245.0</td><td>3.21</td><td>3.57</td><td>15.84</td><td>0.0</td><td>0.0</td><td>3.0</td><td>4.0</td><td>15.3</td></tr><tr><td>&quot;Merc 240D&quot;</td><td>24.4</td><td>4.0</td><td>146.7</td><td>62.0</td><td>3.69</td><td>3.19</td><td>20.0</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td><td>25.4</td></tr><tr><td>&quot;Merc 230&quot;</td><td>22.8</td><td>4.0</td><td>140.8</td><td>95.0</td><td>3.92</td><td>3.15</td><td>22.9</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td><td>23.8</td></tr><tr><td>&quot;Merc 280&quot;</td><td>19.2</td><td>6.0</td><td>167.6</td><td>123.0</td><td>3.92</td><td>3.44</td><td>18.3</td><td>1.0</td><td>0.0</td><td>4.0</td><td>4.0</td><td>20.2</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Filter\n\nThis section shows how to select rows that meet specific criteria.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Use the AND operator to filter rows based on multiple conditions.\nSELECT * FROM mtcars_table WHERE mpg = 21 AND cyl = 6;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 2 records\n\n|model_name    | mpg| cyl| disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|\n|:-------------|---:|---:|----:|---:|----:|-----:|-----:|--:|--:|----:|----:|\n|Mazda RX4     |  21|   6|  160| 110|  3.9| 2.620| 16.46|  0|  1|    4|    4|\n|Mazda RX4 Wag |  21|   6|  160| 110|  3.9| 2.875| 17.02|  0|  1|    4|    4|\n\n</div>\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Use the OR operator to filter rows.\nSELECT * FROM mtcars_table WHERE mpg = 21 OR cyl = 6;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|model_name     |  mpg| cyl|  disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|\n|:--------------|----:|---:|-----:|---:|----:|-----:|-----:|--:|--:|----:|----:|\n|Mazda RX4      | 21.0|   6| 160.0| 110| 3.90| 2.620| 16.46|  0|  1|    4|    4|\n|Mazda RX4 Wag  | 21.0|   6| 160.0| 110| 3.90| 2.875| 17.02|  0|  1|    4|    4|\n|Hornet 4 Drive | 21.4|   6| 258.0| 110| 3.08| 3.215| 19.44|  1|  0|    3|    1|\n|Valiant        | 18.1|   6| 225.0| 105| 2.76| 3.460| 20.22|  1|  0|    3|    1|\n|Merc 280       | 19.2|   6| 167.6| 123| 3.92| 3.440| 18.30|  1|  0|    4|    4|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use the & operator for \"and\" filtering.\nmtcars |> filter(mpg == 21 & cyl == 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         Mazda RX4  21   6  160 110  3.9 2.620 16.46  0  1    4    4\nMazda RX4 Wag Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use the | operator for \"or\" filtering.\nmtcars |> filter(mpg == 21 | cyl == 6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear\nMazda RX4           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4\nMazda RX4 Wag   Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4\nHornet 4 Drive Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3\nValiant               Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3\nMerc 280             Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4\n               carb\nMazda RX4         4\nMazda RX4 Wag     4\nHornet 4 Drive    1\nValiant           1\nMerc 280          4\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Use the query method for \"and\" filtering.\nmtcars_pd.query('mpg == 21 and cyl == 6')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg\nMazda RX4          Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0\nMazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0\n\n[2 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Use the query method for \"or\" filtering.\nmtcars_pd.query('mpg == 21 or cyl == 6')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg\nMazda RX4            Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0\nMazda RX4 Wag    Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0\nHornet 4 Drive  Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4\nValiant                Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1\nMerc 280              Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2\n\n[5 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# \"and\" filtering with polars\nmtcars_pl.filter((pl.col(\"mpg\") == 21) & (pl.col(\"cyl\") == 6))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (2, 12)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# \"or\" filtering with polars\nmtcars_pl.filter((pl.col(\"mpg\") == 21) | (pl.col(\"cyl\") == 6))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 12)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td><td>225.0</td><td>105.0</td><td>2.76</td><td>3.46</td><td>20.22</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Merc 280&quot;</td><td>19.2</td><td>6.0</td><td>167.6</td><td>123.0</td><td>3.92</td><td>3.44</td><td>18.3</td><td>1.0</td><td>0.0</td><td>4.0</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Order\n\nThis section demonstrates how to sort a table based on one or more columns.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Order the results by mpg in descending order and show the top 3.\nSELECT model_name AS model, mpg, cyl FROM mtcars_table ORDER BY mpg DESC LIMIT 3;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 3 records\n\n|model      |  mpg| cyl|\n|:----------|----:|---:|\n|Merc 240D  | 24.4|   4|\n|Datsun 710 | 22.8|   4|\n|Merc 230   | 22.8|   4|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Arrange the dataframe by mpg in descending order.\nmtcars |> select(model = model_name, mpg, cyl) |> arrange(desc(mpg)) |> head(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                model  mpg cyl\nMerc 240D   Merc 240D 24.4   4\nDatsun 710 Datsun 710 22.8   4\nMerc 230     Merc 230 22.8   4\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Sort the dataframe by mpg in descending order.\nmtcars_pd[[\"model_name\", \"mpg\", \"cyl\"]].sort_values(by='mpg', ascending=False).head(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            model_name   mpg  cyl\nMerc 240D    Merc 240D  24.4  4.0\nDatsun 710  Datsun 710  22.8  4.0\nMerc 230      Merc 230  22.8  4.0\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.select(\"model_name\", \"mpg\", \"cyl\").sort(\"mpg\", descending=True).head(3)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th></tr><tr><td>str</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Merc 240D&quot;</td><td>24.4</td><td>4.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td></tr><tr><td>&quot;Merc 230&quot;</td><td>22.8</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Group By\n\nThis section shows how to group rows and perform aggregate calculations.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Group by model_name and calculate the sum of mpg and the mean of cyl.\nSELECT model_name, sum(mpg) AS total_mpg, mean(cyl) AS cyl_mean FROM mtcars_table\nGROUP BY 1 LIMIT 5;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|model_name     | total_mpg| cyl_mean|\n|:--------------|---------:|--------:|\n|Mazda RX4      |      21.0|        6|\n|Datsun 710     |      22.8|        4|\n|Mazda RX4 Wag  |      21.0|        6|\n|Hornet 4 Drive |      21.4|        6|\n|Merc 240D      |      24.4|        4|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Group by model_name and summarize the data.\nmtcars |> group_by(model_name) |> summarise(total_mpg = sum(mpg), cyl_mean = mean(cyl)) |> head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  model_name        total_mpg cyl_mean\n  <chr>                 <dbl>    <dbl>\n1 Datsun 710             22.8        4\n2 Duster 360             14.3        8\n3 Hornet 4 Drive         21.4        6\n4 Hornet Sportabout      18.7        8\n5 Mazda RX4              21          6\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Group by model_name and aggregate the data.\nmtcars_pd.groupby('model_name').agg({'mpg': 'sum', 'cyl': 'mean'}).head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    mpg  cyl\nmodel_name                  \nDatsun 710         22.8  4.0\nDuster 360         14.3  8.0\nHornet 4 Drive     21.4  6.0\nHornet Sportabout  18.7  8.0\nMazda RX4          21.0  6.0\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.group_by(\"model_name\").agg([\n    pl.sum(\"mpg\").alias(\"total_mpg\"),\n    pl.mean(\"cyl\").alias(\"cyl_mean\")\n]).head(5)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>total_mpg</th><th>cyl_mean</th></tr><tr><td>str</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td></tr><tr><td>&quot;Duster 360&quot;</td><td>14.3</td><td>8.0</td></tr><tr><td>&quot;Merc 280&quot;</td><td>19.2</td><td>6.0</td></tr><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Create Table\n\n## CREATE OR REPLACE\n\nThis command creates a new table or overwrites an existing one.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Create a temporary table, replacing it if it already exists.\nCREATE OR REPLACE TEMP TABLE mtcars_table_group AS\nSELECT model_name, sum(mpg) AS total_mpg, mean(cyl) AS cyl_mean FROM mtcars_table\nGROUP BY 1;\n```\n:::\n\n\n## CREATE TABLE IF NOT EXISTS\n\nThis command creates a table only if it does not already exist.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Create a new table only if it does not already exist.\nCREATE TABLE IF NOT EXISTS new_mtcars_table_group AS\nSELECT model_name, sum(mpg) AS total_mpg, mean(cyl) AS cyl_mean FROM mtcars_table\nGROUP BY 1;\n```\n:::\n\n\n# Unique\n\n## Check Unique\n\nThis section demonstrates how to verify the uniqueness of values in a column.\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Count the total number of rows and the number of distinct model names.\nSELECT count(*), count(DISTINCT model_name) FROM mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| count_star()| count(DISTINCT model_name)|\n|------------:|--------------------------:|\n|           10|                         10|\n\n</div>\n:::\n\n\n### Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Count the total number of rows and the number of distinct model names.\nprint(len(mtcars_pd), mtcars_pd.model_name.nunique())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n10 10\n```\n\n\n:::\n:::\n\n\n### Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Count the total number of rows and the number of distinct model names.\nmtcars_pl.select(pl.count(), pl.col(\"model_name\").n_unique())\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (1, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>count</th><th>model_name</th></tr><tr><td>u32</td><td>u32</td></tr></thead><tbody><tr><td>10</td><td>10</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n## Get Duplicate and Non-Duplicate Data\n\nThis section demonstrates how to get duplicate and non-duplicate data based on a single column.\n\n::: panel-tabset\n\n### SQL\n\n#### Show all Duplicate\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Get duplicate rows based on the mpg column.\nSELECT * FROM mtcars_table WHERE mpg IN (SELECT mpg FROM mtcars_table GROUP BY mpg HAVING count(*) > 1);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 4 records\n\n|model_name    |  mpg| cyl|  disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|\n|:-------------|----:|---:|-----:|---:|----:|-----:|-----:|--:|--:|----:|----:|\n|Mazda RX4     | 21.0|   6| 160.0| 110| 3.90| 2.620| 16.46|  0|  1|    4|    4|\n|Mazda RX4 Wag | 21.0|   6| 160.0| 110| 3.90| 2.875| 17.02|  0|  1|    4|    4|\n|Datsun 710    | 22.8|   4| 108.0|  93| 3.85| 2.320| 18.61|  1|  1|    4|    1|\n|Merc 230      | 22.8|   4| 140.8|  95| 3.92| 3.150| 22.90|  1|  0|    4|    2|\n\n</div>\n:::\n\n\n#### Keep non-Duplicate\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Get non-duplicate rows based on the mpg column.\nSELECT * FROM mtcars_table WHERE mpg IN (SELECT mpg FROM mtcars_table GROUP BY mpg HAVING count(*) = 1);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 6 records\n\n|model_name        |  mpg| cyl|  disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|\n|:-----------------|----:|---:|-----:|---:|----:|-----:|-----:|--:|--:|----:|----:|\n|Hornet 4 Drive    | 21.4|   6| 258.0| 110| 3.08| 3.215| 19.44|  1|  0|    3|    1|\n|Hornet Sportabout | 18.7|   8| 360.0| 175| 3.15| 3.440| 17.02|  0|  0|    3|    2|\n|Valiant           | 18.1|   6| 225.0| 105| 2.76| 3.460| 20.22|  1|  0|    3|    1|\n|Duster 360        | 14.3|   8| 360.0| 245| 3.21| 3.570| 15.84|  0|  0|    3|    4|\n|Merc 240D         | 24.4|   4| 146.7|  62| 3.69| 3.190| 20.00|  1|  0|    4|    2|\n|Merc 280          | 19.2|   6| 167.6| 123| 3.92| 3.440| 18.30|  1|  0|    4|    4|\n\n</div>\n:::\n\n\n### R\n\n#### Show all Duplicate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get duplicate rows based on the mpg column.\nmtcars |> filter(duplicated(mpg) | duplicated(mpg, fromLast = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710       Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1\nMerc 230           Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2\n```\n\n\n:::\n:::\n\n\n#### keep non Duplicate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get non-duplicate rows based on the mpg column.\nmtcars |> filter(!duplicated(mpg) & !duplicated(mpg, fromLast = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am\nHornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0\nHornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0\nValiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0\nDuster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0\nMerc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0\nMerc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0\n                  gear carb\nHornet 4 Drive       3    1\nHornet Sportabout    3    2\nValiant              3    1\nDuster 360           3    4\nMerc 240D            4    2\nMerc 280             4    4\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n#### Show all Duplicate\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get duplicate rows based on the mpg column.\nmtcars_pd[mtcars_pd.duplicated(subset=['mpg'], keep=False)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg\nMazda RX4          Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0\nMazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0\nDatsun 710        Datsun 710  22.8  4.0  108.0  ...  1.0   4.0   1.0     23.8\nMerc 230            Merc 230  22.8  4.0  140.8  ...  0.0   4.0   2.0     23.8\n\n[4 rows x 13 columns]\n```\n\n\n:::\n:::\n\n#### keep non Duplicate\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get non-duplicate rows based on the mpg column.\nmtcars_pd[~mtcars_pd.duplicated(subset=['mpg'], keep=False)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          model_name   mpg  cyl  ...  gear  carb  new_mpg\nHornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4\nHornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7\nValiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1\nDuster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3\nMerc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4\nMerc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2\n\n[6 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n### Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get duplicate rows based on the mpg column.\nmtcars_pl.filter(pl.col(\"mpg\").is_duplicated())\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (4, 12)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td></tr><tr><td>&quot;Merc 230&quot;</td><td>22.8</td><td>4.0</td><td>140.8</td><td>95.0</td><td>3.92</td><td>3.15</td><td>22.9</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n#### keep non Duplicate\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Get non-duplicate rows based on the mpg column.\nmtcars_pl.filter(pl.col(\"mpg\").is_unique())\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (6, 12)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td><td>225.0</td><td>105.0</td><td>2.76</td><td>3.46</td><td>20.22</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Duster 360&quot;</td><td>14.3</td><td>8.0</td><td>360.0</td><td>245.0</td><td>3.21</td><td>3.57</td><td>15.84</td><td>0.0</td><td>0.0</td><td>3.0</td><td>4.0</td></tr><tr><td>&quot;Merc 240D&quot;</td><td>24.4</td><td>4.0</td><td>146.7</td><td>62.0</td><td>3.69</td><td>3.19</td><td>20.0</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr><tr><td>&quot;Merc 280&quot;</td><td>19.2</td><td>6.0</td><td>167.6</td><td>123.0</td><td>3.92</td><td>3.44</td><td>18.3</td><td>1.0</td><td>0.0</td><td>4.0</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n\n# Join\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Select all data from the newly created temporary table.\nSELECT * FROM mtcars_table_group t1;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: Displaying records 1 - 10\n\n|model_name        | total_mpg| cyl_mean|\n|:-----------------|---------:|--------:|\n|Merc 240D         |      24.4|        4|\n|Mazda RX4         |      21.0|        6|\n|Datsun 710        |      22.8|        4|\n|Mazda RX4 Wag     |      21.0|        6|\n|Hornet 4 Drive    |      21.4|        6|\n|Merc 280          |      19.2|        6|\n|Hornet Sportabout |      18.7|        8|\n|Duster 360        |      14.3|        8|\n|Merc 230          |      22.8|        4|\n|Valiant           |      18.1|        6|\n\n</div>\n:::\n\n\n## Left Join\n\nThis section shows how to perform a left join to combine data from two tables.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Perform a left join between mtcars_table and mtcars_table_group.\nSELECT t1.model_name, t1.mpg, t1.cyl, t2.* FROM mtcars_table t1\nLEFT JOIN mtcars_table_group t2 ON t1.model_name = t2.model_name\nLIMIT 5;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|model_name        |  mpg| cyl|model_name        | total_mpg| cyl_mean|\n|:-----------------|----:|---:|:-----------------|---------:|--------:|\n|Mazda RX4         | 21.0|   6|Mazda RX4         |      21.0|        6|\n|Mazda RX4 Wag     | 21.0|   6|Mazda RX4 Wag     |      21.0|        6|\n|Datsun 710        | 22.8|   4|Datsun 710        |      22.8|        4|\n|Hornet 4 Drive    | 21.4|   6|Hornet 4 Drive    |      21.4|        6|\n|Hornet Sportabout | 18.7|   8|Hornet Sportabout |      18.7|        8|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform a left join on the mtcars dataframe with itself.\nmtcars |> left_join(mtcars, by = join_by(model_name == model_name)) |> head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x\n1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1\n2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1\n3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1\n4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0\n5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0\n  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y\n1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4\n2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4\n3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4\n4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3\n5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3\n  carb.y\n1      4\n2      4\n3      1\n4      1\n5      2\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Perform a left join using pandas.\npd.merge(mtcars_pd, mtcars_pd, left_on='model_name', right_on='model_name', how='left').head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y\n0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0\n1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0\n2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8\n3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4\n4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7\n\n[5 rows x 25 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.join(mtcars_pl, on=\"model_name\", how=\"left\").head(5)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 23)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th><th>mpg_right</th><th>cyl_right</th><th>disp_right</th><th>hp_right</th><th>drat_right</th><th>wt_right</th><th>qsec_right</th><th>vs_right</th><th>am_right</th><th>gear_right</th><th>carb_right</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n## Inner Join\n\nThis section demonstrates how to perform an inner join.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Perform an inner join with a subquery.\nSELECT t1.model_name, t1.mpg, t1.cyl, t2.* FROM mtcars_table t1\nINNER JOIN (SELECT * FROM mtcars_table_group LIMIT 5) t2 ON t1.model_name = t2.model_name;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|model_name     |  mpg| cyl|model_name     | total_mpg| cyl_mean|\n|:--------------|----:|---:|:--------------|---------:|--------:|\n|Mazda RX4      | 21.0|   6|Mazda RX4      |      21.0|        6|\n|Mazda RX4 Wag  | 21.0|   6|Mazda RX4 Wag  |      21.0|        6|\n|Datsun 710     | 22.8|   4|Datsun 710     |      22.8|        4|\n|Hornet 4 Drive | 21.4|   6|Hornet 4 Drive |      21.4|        6|\n|Merc 240D      | 24.4|   4|Merc 240D      |      24.4|        4|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform an inner join.\nmtcars |> inner_join(mtcars, by = join_by(model_name == model_name)) |> head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x\n1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1\n2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1\n3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1\n4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0\n5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0\n  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y\n1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4\n2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4\n3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4\n4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3\n5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3\n  carb.y\n1      4\n2      4\n3      1\n4      1\n5      2\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Perform an inner join with pandas.\npd.merge(mtcars_pd, mtcars_pd, left_on='model_name', right_on='model_name', how='inner').head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y\n0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0\n1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0\n2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8\n3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4\n4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7\n\n[5 rows x 25 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.join(mtcars_pl, on=\"model_name\", how=\"inner\").head(5)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 23)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th><th>mpg_right</th><th>cyl_right</th><th>disp_right</th><th>hp_right</th><th>drat_right</th><th>wt_right</th><th>qsec_right</th><th>vs_right</th><th>am_right</th><th>gear_right</th><th>carb_right</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Append Rows\n\n## Append Without Duplicate Elimination (`union all`)\n\nThis section shows how to combine rows from two tables, keeping all duplicates.\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Count the rows in the original table.\nSELECT count(*) FROM mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| count_star()|\n|------------:|\n|           10|\n\n</div>\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Create a new table by appending mtcars_table to itself, including duplicates.\nCREATE TEMP TABLE double_mtcars_table AS\nSELECT * FROM mtcars_table\nUNION ALL\nSELECT * FROM mtcars_table;\n```\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Count the rows in the new table.\nSELECT count(*) FROM double_mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| count_star()|\n|------------:|\n|           20|\n\n</div>\n:::\n\n\n### R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Append rows using bind_rows.\nmtcars %>% bind_rows(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                              model_name  mpg cyl  disp  hp drat    wt  qsec vs\nMazda RX4...1                  Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0\nMazda RX4 Wag...2          Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0\nDatsun 710...3                Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1\nHornet 4 Drive...4        Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1\nHornet Sportabout...5  Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0\nValiant...6                      Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1\nDuster 360...7                Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0\nMerc 240D...8                  Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1\nMerc 230...9                    Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1\nMerc 280...10                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1\nMazda RX4...11                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0\nMazda RX4 Wag...12         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0\nDatsun 710...13               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1\nHornet 4 Drive...14       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1\nHornet Sportabout...15 Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0\nValiant...16                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1\nDuster 360...17               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0\nMerc 240D...18                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1\nMerc 230...19                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1\nMerc 280...20                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1\n                       am gear carb\nMazda RX4...1           1    4    4\nMazda RX4 Wag...2       1    4    4\nDatsun 710...3          1    4    1\nHornet 4 Drive...4      0    3    1\nHornet Sportabout...5   0    3    2\nValiant...6             0    3    1\nDuster 360...7          0    3    4\nMerc 240D...8           0    4    2\nMerc 230...9            0    4    2\nMerc 280...10           0    4    4\nMazda RX4...11          1    4    4\nMazda RX4 Wag...12      1    4    4\nDatsun 710...13         1    4    1\nHornet 4 Drive...14     0    3    1\nHornet Sportabout...15  0    3    2\nValiant...16            0    3    1\nDuster 360...17         0    3    4\nMerc 240D...18          0    4    2\nMerc 230...19           0    4    2\nMerc 280...20           0    4    4\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Concatenate dataframes, keeping all rows.\npd.concat([mtcars_pd, mtcars_pd], ignore_index=True)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg\n0           Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0\n1       Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0\n2          Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8\n3      Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4\n4   Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7\n5             Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1\n6          Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3\n7           Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4\n8            Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8\n9            Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2\n10          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0\n11      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0\n12         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8\n13     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4\n14  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7\n15            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1\n16         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3\n17          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4\n18           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8\n19           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2\n\n[20 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n:::\n\n## Append With Duplicate Elimination (`union`)\n\nThis section demonstrates how to combine rows while removing duplicate entries.\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Create a table, removing duplicate rows.\nCREATE OR REPLACE TEMP TABLE union_mtcars_table AS\nSELECT * FROM mtcars_table\nUNION\nSELECT * FROM mtcars_table;\n```\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Count the rows in the new table (should be same as original since all rows are identical).\nSELECT count(*) AS union_row_count FROM union_mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| union_row_count|\n|---------------:|\n|              10|\n\n</div>\n:::\n\n\n### R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Append rows and then remove duplicates.\nmtcars %>% bind_rows(mtcars) |> distinct()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am\nMazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1\nMazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1\nDatsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1\nHornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0\nHornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0\nValiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0\nDuster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0\nMerc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0\nMerc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0\nMerc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0\n                  gear carb\nMazda RX4            4    4\nMazda RX4 Wag        4    4\nDatsun 710           4    1\nHornet 4 Drive       3    1\nHornet Sportabout    3    2\nValiant              3    1\nDuster 360           3    4\nMerc 240D            4    2\nMerc 230             4    2\nMerc 280             4    4\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Concatenate dataframes and then drop duplicates.\npd.concat([mtcars_pd, mtcars_pd], ignore_index=True).drop_duplicates().reset_index(drop=True)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg\n0          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0\n1      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0\n2         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8\n3     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4\n4  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7\n5            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1\n6         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3\n7          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4\n8           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8\n9           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2\n\n[10 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n:::\n\n# Delete Rows\n\nThis section shows how to remove rows from a table based on a condition.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Delete a specific row from the table.\nDELETE FROM mtcars_table WHERE model_name = 'Mazda RX4';\n```\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Verify the row count after deletion.\nSELECT count(*) FROM mtcars_table;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n| count_star()|\n|------------:|\n|            9|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter out the specified row.\nmtcars |> filter(model_name != 'Mazda RX4')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am\nMazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1\nDatsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1\nHornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0\nHornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0\nValiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0\nDuster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0\nMerc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0\nMerc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0\nMerc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0\n                  gear carb\nMazda RX4 Wag        4    4\nDatsun 710           4    1\nHornet 4 Drive       3    1\nHornet Sportabout    3    2\nValiant              3    1\nDuster 360           3    4\nMerc 240D            4    2\nMerc 230             4    2\nMerc 280             4    4\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Select all rows except the one specified.\nmtcars_pd[mtcars_pd['model_name'] != 'Mazda RX4']\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          model_name   mpg  cyl  ...  gear  carb  new_mpg\nMazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0\nDatsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8\nHornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4\nHornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7\nValiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1\nDuster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3\nMerc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4\nMerc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8\nMerc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2\n\n[9 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.filter(pl.col(\"model_name\") != 'Mazda RX4')\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (9, 12)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td><td>225.0</td><td>105.0</td><td>2.76</td><td>3.46</td><td>20.22</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Duster 360&quot;</td><td>14.3</td><td>8.0</td><td>360.0</td><td>245.0</td><td>3.21</td><td>3.57</td><td>15.84</td><td>0.0</td><td>0.0</td><td>3.0</td><td>4.0</td></tr><tr><td>&quot;Merc 240D&quot;</td><td>24.4</td><td>4.0</td><td>146.7</td><td>62.0</td><td>3.69</td><td>3.19</td><td>20.0</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr><tr><td>&quot;Merc 230&quot;</td><td>22.8</td><td>4.0</td><td>140.8</td><td>95.0</td><td>3.92</td><td>3.15</td><td>22.9</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr><tr><td>&quot;Merc 280&quot;</td><td>19.2</td><td>6.0</td><td>167.6</td><td>123.0</td><td>3.92</td><td>3.44</td><td>18.3</td><td>1.0</td><td>0.0</td><td>4.0</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Update Rows\n\nThis section demonstrates how to modify existing data in a table.\n\n::: panel-tabset\n\n## SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Select the row to be updated.\nSELECT model_name, mpg FROM mtcars_table WHERE model_name = 'Mazda RX4 Wag';\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n|model_name    | mpg|\n|:-------------|---:|\n|Mazda RX4 Wag |  21|\n\n</div>\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Update the value of a column for a specific row.\nUPDATE mtcars_table\nSET mpg = 999\nWHERE model_name = 'Mazda RX4 Wag';\n```\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Verify the update.\nSELECT model_name, mpg FROM mtcars_table WHERE model_name = 'Mazda RX4 Wag';\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 1 records\n\n|model_name    | mpg|\n|:-------------|---:|\n|Mazda RX4 Wag | 999|\n\n</div>\n:::\n\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Update a value within a filtered selection.\nmtcars |> filter(model_name == 'Mazda RX4 Wag') |> mutate(mpg = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4 Wag Mazda RX4 Wag 999   6  160 110  3.9 2.875 17.02  0  1    4    4\n```\n\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Update a specific value using .loc.\nmtcars_pd.loc[mtcars_pd['model_name'] == 'Mazda RX4 Wag', 'mpg'] = 999\nmtcars_pd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          model_name    mpg  cyl  ...  gear  carb  new_mpg\nMazda RX4                  Mazda RX4   21.0  6.0  ...   4.0   4.0     22.0\nMazda RX4 Wag          Mazda RX4 Wag  999.0  6.0  ...   4.0   4.0     22.0\nDatsun 710                Datsun 710   22.8  4.0  ...   4.0   1.0     23.8\nHornet 4 Drive        Hornet 4 Drive   21.4  6.0  ...   3.0   1.0     22.4\nHornet Sportabout  Hornet Sportabout   18.7  8.0  ...   3.0   2.0     19.7\nValiant                      Valiant   18.1  6.0  ...   3.0   1.0     19.1\nDuster 360                Duster 360   14.3  8.0  ...   3.0   4.0     15.3\nMerc 240D                  Merc 240D   24.4  4.0  ...   4.0   2.0     25.4\nMerc 230                    Merc 230   22.8  4.0  ...   4.0   2.0     23.8\nMerc 280                    Merc 280   19.2  6.0  ...   4.0   4.0     20.2\n\n[10 rows x 13 columns]\n```\n\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.with_columns(\n    pl.when(pl.col(\"model_name\") == 'Mazda RX4 Wag')\n    .then(999)\n    .otherwise(pl.col(\"mpg\"))\n    .alias(\"mpg\")\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 12)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>mpg</th><th>cyl</th><th>disp</th><th>hp</th><th>drat</th><th>wt</th><th>qsec</th><th>vs</th><th>am</th><th>gear</th><th>carb</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Mazda RX4&quot;</td><td>21.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.62</td><td>16.46</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>999.0</td><td>6.0</td><td>160.0</td><td>110.0</td><td>3.9</td><td>2.875</td><td>17.02</td><td>0.0</td><td>1.0</td><td>4.0</td><td>4.0</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>22.8</td><td>4.0</td><td>108.0</td><td>93.0</td><td>3.85</td><td>2.32</td><td>18.61</td><td>1.0</td><td>1.0</td><td>4.0</td><td>1.0</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>21.4</td><td>6.0</td><td>258.0</td><td>110.0</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>18.7</td><td>8.0</td><td>360.0</td><td>175.0</td><td>3.15</td><td>3.44</td><td>17.02</td><td>0.0</td><td>0.0</td><td>3.0</td><td>2.0</td></tr><tr><td>&quot;Valiant&quot;</td><td>18.1</td><td>6.0</td><td>225.0</td><td>105.0</td><td>2.76</td><td>3.46</td><td>20.22</td><td>1.0</td><td>0.0</td><td>3.0</td><td>1.0</td></tr><tr><td>&quot;Duster 360&quot;</td><td>14.3</td><td>8.0</td><td>360.0</td><td>245.0</td><td>3.21</td><td>3.57</td><td>15.84</td><td>0.0</td><td>0.0</td><td>3.0</td><td>4.0</td></tr><tr><td>&quot;Merc 240D&quot;</td><td>24.4</td><td>4.0</td><td>146.7</td><td>62.0</td><td>3.69</td><td>3.19</td><td>20.0</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr><tr><td>&quot;Merc 230&quot;</td><td>22.8</td><td>4.0</td><td>140.8</td><td>95.0</td><td>3.92</td><td>3.15</td><td>22.9</td><td>1.0</td><td>0.0</td><td>4.0</td><td>2.0</td></tr><tr><td>&quot;Merc 280&quot;</td><td>19.2</td><td>6.0</td><td>167.6</td><td>123.0</td><td>3.92</td><td>3.44</td><td>18.3</td><td>1.0</td><td>0.0</td><td>4.0</td><td>4.0</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# Drop Table\n\nThis section shows how to remove a table from the database.\n\nBefore dropping the table:\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Show all tables before dropping one.\nSHOW ALL TABLES;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 6 records\n\n|database |schema |name                   |column_names                                                                                                                             |column_types                                                                                                                                                                                                          |temporary |\n|:--------|:------|:----------------------|:----------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------|\n|my-db    |main   |iris_table             |Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species                                                                          |DOUBLE                                   , DOUBLE                                   , DOUBLE                                   , DOUBLE                                   , ENUM('setosa', 'versicolor', 'virginica') |FALSE     |\n|my-db    |main   |mtcars_table           |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |FALSE     |\n|my-db    |main   |new_mtcars_table_group |model_name, total_mpg , cyl_mean                                                                                                         |VARCHAR, DOUBLE , DOUBLE                                                                                                                                                                                              |FALSE     |\n|temp     |main   |double_mtcars_table    |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |TRUE      |\n|temp     |main   |mtcars_table_group     |model_name, total_mpg , cyl_mean                                                                                                         |VARCHAR, DOUBLE , DOUBLE                                                                                                                                                                                              |TRUE      |\n|temp     |main   |union_mtcars_table     |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |TRUE      |\n\n</div>\n:::\n\n\nDropping the table:\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Drop the specified table if it exists.\nDROP TABLE IF EXISTS mtcars_table_group;\n```\n:::\n\n\nAfter dropping the table:\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Show all tables again to confirm the deletion.\nSHOW ALL TABLES;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 5 records\n\n|database |schema |name                   |column_names                                                                                                                             |column_types                                                                                                                                                                                                          |temporary |\n|:--------|:------|:----------------------|:----------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------|\n|my-db    |main   |iris_table             |Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species                                                                          |DOUBLE                                   , DOUBLE                                   , DOUBLE                                   , DOUBLE                                   , ENUM('setosa', 'versicolor', 'virginica') |FALSE     |\n|my-db    |main   |mtcars_table           |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |FALSE     |\n|my-db    |main   |new_mtcars_table_group |model_name, total_mpg , cyl_mean                                                                                                         |VARCHAR, DOUBLE , DOUBLE                                                                                                                                                                                              |FALSE     |\n|temp     |main   |double_mtcars_table    |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |TRUE      |\n|temp     |main   |union_mtcars_table     |model_name, mpg       , cyl       , disp      , hp        , drat      , wt        , qsec      , vs        , am        , gear      , carb |VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE                                                                                                             |TRUE      |\n\n</div>\n:::\n\n\n# PIVOT\n\nThis section demonstrates how to transform data from a long to a wide format.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Create a temporary table for the pivot demonstration.\nDROP TABLE IF EXISTS cities;\nCREATE TEMP TABLE cities (\n    country VARCHAR, name VARCHAR, year INTEGER, population INTEGER\n);\nINSERT INTO cities VALUES\n    ('NL', 'Amsterdam', 2000, 1005),\n    ('NL', 'Amsterdam', 2010, 1065),\n    ('NL', 'Amsterdam', 2020, 1158),\n    ('US', 'Seattle', 2000, 564),\n    ('US', 'Seattle', 2010, 608),\n    ('US', 'Seattle', 2020, 738),\n    ('US', 'New York City', 2000, 8015),\n    ('US', 'New York City', 2010, 8175),\n    ('US', 'New York City', 2020, 8772);\n```\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- View the raw data.\nSELECT * FROM cities;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 9 records\n\n|country |name          | year| population|\n|:-------|:-------------|----:|----------:|\n|NL      |Amsterdam     | 2000|       1005|\n|NL      |Amsterdam     | 2010|       1065|\n|NL      |Amsterdam     | 2020|       1158|\n|US      |Seattle       | 2000|        564|\n|US      |Seattle       | 2010|        608|\n|US      |Seattle       | 2020|        738|\n|US      |New York City | 2000|       8015|\n|US      |New York City | 2010|       8175|\n|US      |New York City | 2020|       8772|\n\n</div>\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n## PIVOT on One Column\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Pivot the table on the 'year' column.\nPIVOT cities\nON year\nUSING sum(population)\nGROUP BY country;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 2 records\n\n|country | 2000| 2010| 2020|\n|:-------|----:|----:|----:|\n|US      | 8579| 8783| 9510|\n|NL      | 1005| 1065| 1158|\n\n</div>\n:::\n\n\n### R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pivot on year, summing population, grouped by country.\ncities |> \n  select(country, year, population) |> \n  pivot_wider(names_from = year, values_from = population, values_fn = sum)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  country `2000` `2010` `2020`\n  <chr>    <dbl>  <dbl>  <dbl>\n1 NL        1005   1065   1158\n2 US        8579   8783   9510\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncities_pd.pivot_table(index='country', columns='year', values='population', aggfunc='sum').reset_index()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nyear country  2000  2010  2020\n0         NL  1005  1065  1158\n1         US  8579  8783  9510\n```\n\n\n:::\n:::\n\n\n### Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncities_pl.pivot(index='country', columns='year', values='population', aggregate_function='sum')\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (2, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>country</th><th>2000</th><th>2010</th><th>2020</th></tr><tr><td>str</td><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;NL&quot;</td><td>1005</td><td>1065</td><td>1158</td></tr><tr><td>&quot;US&quot;</td><td>8579</td><td>8783</td><td>9510</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n## PIVOT on Two Columns\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Pivot on both 'country' and 'name'.\nPIVOT cities\nON country, name\nUSING sum(population);\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 3 records\n\n| year| NL_Amsterdam| NL_New York City| NL_Seattle| US_Amsterdam| US_New York City| US_Seattle|\n|----:|------------:|----------------:|----------:|------------:|----------------:|----------:|\n| 2000|         1005|               NA|         NA|           NA|             8015|        564|\n| 2010|         1065|               NA|         NA|           NA|             8175|        608|\n| 2020|         1158|               NA|         NA|           NA|             8772|        738|\n\n</div>\n:::\n\n\n### R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pivot on year, summing population, keeping all other columns (country, name).\ncities |> \n  pivot_wider(names_from = year, values_from = population, values_fn = sum)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  country name          `2000` `2010` `2020`\n  <chr>   <chr>          <dbl>  <dbl>  <dbl>\n1 NL      Amsterdam       1005   1065   1158\n2 US      Seattle          564    608    738\n3 US      New York City   8015   8175   8772\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncities_pd.pivot_table(index=['country', 'name'], columns='year', values='population', aggfunc='sum').reset_index()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nyear country           name  2000  2010  2020\n0         NL      Amsterdam  1005  1065  1158\n1         US  New York City  8015  8175  8772\n2         US        Seattle   564   608   738\n```\n\n\n:::\n:::\n\n\n### Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncities_pl.pivot(index=['country', 'name'], columns='year', values='population', aggregate_function='sum')\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>country</th><th>name</th><th>2000</th><th>2010</th><th>2020</th></tr><tr><td>str</td><td>str</td><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;NL&quot;</td><td>&quot;Amsterdam&quot;</td><td>1005</td><td>1065</td><td>1158</td></tr><tr><td>&quot;US&quot;</td><td>&quot;Seattle&quot;</td><td>564</td><td>608</td><td>738</td></tr><tr><td>&quot;US&quot;</td><td>&quot;New York City&quot;</td><td>8015</td><td>8175</td><td>8772</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# UNPIVOT\n\nThis section shows how to transform data from a wide to a long format.\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Unpivot the previously pivoted table.\nUNPIVOT\n(\n  PIVOT cities\n  ON year\n  USING sum(population)\n  GROUP BY country\n)\nON COLUMNS(* EXCLUDE (country))\nINTO\n    NAME year\n    VALUE population;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 6 records\n\n|country |year | population|\n|:-------|:----|----------:|\n|NL      |2000 |       1005|\n|NL      |2010 |       1065|\n|NL      |2020 |       1158|\n|US      |2000 |       8579|\n|US      |2010 |       8783|\n|US      |2020 |       9510|\n\n</div>\n:::\n\n\n### R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pivot and then unpivot.\ncities_pivot <- cities |> \n  select(country, year, population) |> \n  pivot_wider(names_from = year, values_from = population, values_fn = sum)\n\ncities_pivot |> \n  pivot_longer(cols = -country, names_to = \"year\", values_to = \"population\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  country year  population\n  <chr>   <chr>      <dbl>\n1 NL      2000        1005\n2 NL      2010        1065\n3 NL      2020        1158\n4 US      2000        8579\n5 US      2010        8783\n6 US      2020        9510\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncities_pivot_pd = cities_pd.pivot_table(index='country', columns='year', values='population', aggfunc='sum').reset_index()\ncities_pivot_pd.melt(id_vars='country', value_vars=[2000, 2010, 2020], var_name='year', value_name='population')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  country  year  population\n0      NL  2000        1005\n1      US  2000        8579\n2      NL  2010        1065\n3      US  2010        8783\n4      NL  2020        1158\n5      US  2020        9510\n```\n\n\n:::\n:::\n\n\n### Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\ncities_pivot_pl = cities_pl.pivot(index='country', columns='year', values='population', aggregate_function='sum')\ncities_pivot_pl.unpivot(index='country', on=['2000', '2010', '2020'], variable_name='year', value_name='population')\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (6, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>country</th><th>year</th><th>population</th></tr><tr><td>str</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;NL&quot;</td><td>&quot;2000&quot;</td><td>1005</td></tr><tr><td>&quot;US&quot;</td><td>&quot;2000&quot;</td><td>8579</td></tr><tr><td>&quot;NL&quot;</td><td>&quot;2010&quot;</td><td>1065</td></tr><tr><td>&quot;US&quot;</td><td>&quot;2010&quot;</td><td>8783</td></tr><tr><td>&quot;NL&quot;</td><td>&quot;2020&quot;</td><td>1158</td></tr><tr><td>&quot;US&quot;</td><td>&quot;2020&quot;</td><td>9510</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n# EXPLAIN\n\nThis section demonstrates how to analyze the execution plan of a query.\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Show the logical execution plan of a query.\nEXPLAIN\nSELECT t1.model_name, t1.mpg, t1.cyl, t2.* FROM mtcars_table t1\nINNER JOIN (SELECT * FROM mtcars_table LIMIT 5) t2 ON t1.model_name = t2.model_name;\n```\n:::\n\n\n\n::: {.cell}\n\n```{.sql .cell-code}\n-- Show the detailed execution plan, including timing information.\nEXPLAIN ANALYZE\nSELECT t1.model_name, t1.mpg, t1.cyl, t2.* FROM mtcars_table t1\nINNER JOIN (SELECT * FROM mtcars_table LIMIT 5) t2 ON t1.model_name = t2.model_name;\n```\n:::\n\n\n\n\n# Display Beautiful Table\n\nThis section shows how to create nicely formatted tables for presentation.\n\n::: panel-tabset\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use the gt library to create a formatted table.\nlibrary(gt)\nmtcars |> gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"oiawnugcmp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#oiawnugcmp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#oiawnugcmp thead, #oiawnugcmp tbody, #oiawnugcmp tfoot, #oiawnugcmp tr, #oiawnugcmp td, #oiawnugcmp th {\n  border-style: none;\n}\n\n#oiawnugcmp p {\n  margin: 0;\n  padding: 0;\n}\n\n#oiawnugcmp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#oiawnugcmp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#oiawnugcmp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#oiawnugcmp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#oiawnugcmp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#oiawnugcmp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#oiawnugcmp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#oiawnugcmp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#oiawnugcmp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#oiawnugcmp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#oiawnugcmp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#oiawnugcmp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#oiawnugcmp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#oiawnugcmp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#oiawnugcmp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oiawnugcmp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#oiawnugcmp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#oiawnugcmp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#oiawnugcmp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oiawnugcmp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#oiawnugcmp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oiawnugcmp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#oiawnugcmp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oiawnugcmp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#oiawnugcmp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#oiawnugcmp .gt_left {\n  text-align: left;\n}\n\n#oiawnugcmp .gt_center {\n  text-align: center;\n}\n\n#oiawnugcmp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#oiawnugcmp .gt_font_normal {\n  font-weight: normal;\n}\n\n#oiawnugcmp .gt_font_bold {\n  font-weight: bold;\n}\n\n#oiawnugcmp .gt_font_italic {\n  font-style: italic;\n}\n\n#oiawnugcmp .gt_super {\n  font-size: 65%;\n}\n\n#oiawnugcmp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#oiawnugcmp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#oiawnugcmp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#oiawnugcmp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#oiawnugcmp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#oiawnugcmp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#oiawnugcmp .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#oiawnugcmp .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#oiawnugcmp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"model_name\">model_name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mpg\">mpg</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cyl\">cyl</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"disp\">disp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hp\">hp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"drat\">drat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"wt\">wt</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"qsec\">qsec</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"vs\">vs</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"am\">am</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gear\">gear</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"carb\">carb</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Mazda RX4</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">21.0</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">6</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">160.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">110</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.90</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">2.620</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">16.46</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">0</td>\n<td headers=\"am\" class=\"gt_row gt_right\">1</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">4</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Mazda RX4 Wag</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">21.0</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">6</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">160.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">110</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.90</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">2.875</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">17.02</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">0</td>\n<td headers=\"am\" class=\"gt_row gt_right\">1</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">4</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Datsun 710</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">22.8</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">4</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">108.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">93</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.85</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">2.320</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">18.61</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">1</td>\n<td headers=\"am\" class=\"gt_row gt_right\">1</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">4</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Hornet 4 Drive</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">21.4</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">6</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">258.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">110</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.08</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.215</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">19.44</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">1</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">3</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Hornet Sportabout</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">18.7</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">8</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">360.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">175</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.15</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.440</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">17.02</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">0</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">3</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Valiant</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">18.1</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">6</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">225.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">105</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">2.76</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.460</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">20.22</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">1</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">3</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Duster 360</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">14.3</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">8</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">360.0</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">245</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.21</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.570</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">15.84</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">0</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">3</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Merc 240D</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">24.4</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">4</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">146.7</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">62</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.69</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.190</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">20.00</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">1</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">4</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Merc 230</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">22.8</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">4</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">140.8</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">95</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.92</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.150</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">22.90</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">1</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">4</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"model_name\" class=\"gt_row gt_left\">Merc 280</td>\n<td headers=\"mpg\" class=\"gt_row gt_right\">19.2</td>\n<td headers=\"cyl\" class=\"gt_row gt_right\">6</td>\n<td headers=\"disp\" class=\"gt_row gt_right\">167.6</td>\n<td headers=\"hp\" class=\"gt_row gt_right\">123</td>\n<td headers=\"drat\" class=\"gt_row gt_right\">3.92</td>\n<td headers=\"wt\" class=\"gt_row gt_right\">3.440</td>\n<td headers=\"qsec\" class=\"gt_row gt_right\">18.30</td>\n<td headers=\"vs\" class=\"gt_row gt_right\">1</td>\n<td headers=\"am\" class=\"gt_row gt_right\">0</td>\n<td headers=\"gear\" class=\"gt_row gt_right\">4</td>\n<td headers=\"carb\" class=\"gt_row gt_right\">4</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n## Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Use the great_tables library to create a formatted table.\nfrom great_tables import GT\nGT(mtcars_pd)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fjspgoomfj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#fjspgoomfj table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#fjspgoomfj thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#fjspgoomfj p { margin: 0; padding: 0; }\n #fjspgoomfj .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #fjspgoomfj .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #fjspgoomfj .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #fjspgoomfj .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #fjspgoomfj .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #fjspgoomfj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #fjspgoomfj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #fjspgoomfj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #fjspgoomfj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #fjspgoomfj .gt_column_spanner_outer:first-child { padding-left: 0; }\n #fjspgoomfj .gt_column_spanner_outer:last-child { padding-right: 0; }\n #fjspgoomfj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }\n #fjspgoomfj .gt_spanner_row { border-bottom-style: hidden; }\n #fjspgoomfj .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }\n #fjspgoomfj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }\n #fjspgoomfj .gt_from_md> :first-child { margin-top: 0; }\n #fjspgoomfj .gt_from_md> :last-child { margin-bottom: 0; }\n #fjspgoomfj .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }\n #fjspgoomfj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #fjspgoomfj .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #fjspgoomfj .gt_row_group_first td { border-top-width: 2px; }\n #fjspgoomfj .gt_row_group_first th { border-top-width: 2px; }\n #fjspgoomfj .gt_striped { color: #333333; background-color: #F4F4F4; }\n #fjspgoomfj .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #fjspgoomfj .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }\n #fjspgoomfj .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }\n #fjspgoomfj .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }\n #fjspgoomfj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #fjspgoomfj .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #fjspgoomfj .gt_left { text-align: left; }\n #fjspgoomfj .gt_center { text-align: center; }\n #fjspgoomfj .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #fjspgoomfj .gt_font_normal { font-weight: normal; }\n #fjspgoomfj .gt_font_bold { font-weight: bold; }\n #fjspgoomfj .gt_font_italic { font-style: italic; }\n #fjspgoomfj .gt_super { font-size: 65%; }\n #fjspgoomfj .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #fjspgoomfj .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"model_name\">model_name</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mpg\">mpg</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cyl\">cyl</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"disp\">disp</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hp\">hp</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"drat\">drat</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"wt\">wt</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"qsec\">qsec</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"vs\">vs</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"am\">am</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gear\">gear</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"carb\">carb</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"new_mpg\">new_mpg</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr>\n    <td class=\"gt_row gt_left\">Mazda RX4</td>\n    <td class=\"gt_row gt_right\">21.0</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">160.0</td>\n    <td class=\"gt_row gt_right\">110.0</td>\n    <td class=\"gt_row gt_right\">3.9</td>\n    <td class=\"gt_row gt_right\">2.62</td>\n    <td class=\"gt_row gt_right\">16.46</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">22.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Mazda RX4 Wag</td>\n    <td class=\"gt_row gt_right\">999.0</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">160.0</td>\n    <td class=\"gt_row gt_right\">110.0</td>\n    <td class=\"gt_row gt_right\">3.9</td>\n    <td class=\"gt_row gt_right\">2.875</td>\n    <td class=\"gt_row gt_right\">17.02</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">22.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Datsun 710</td>\n    <td class=\"gt_row gt_right\">22.8</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">108.0</td>\n    <td class=\"gt_row gt_right\">93.0</td>\n    <td class=\"gt_row gt_right\">3.85</td>\n    <td class=\"gt_row gt_right\">2.32</td>\n    <td class=\"gt_row gt_right\">18.61</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">23.8</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Hornet 4 Drive</td>\n    <td class=\"gt_row gt_right\">21.4</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">258.0</td>\n    <td class=\"gt_row gt_right\">110.0</td>\n    <td class=\"gt_row gt_right\">3.08</td>\n    <td class=\"gt_row gt_right\">3.215</td>\n    <td class=\"gt_row gt_right\">19.44</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">22.4</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Hornet Sportabout</td>\n    <td class=\"gt_row gt_right\">18.7</td>\n    <td class=\"gt_row gt_right\">8.0</td>\n    <td class=\"gt_row gt_right\">360.0</td>\n    <td class=\"gt_row gt_right\">175.0</td>\n    <td class=\"gt_row gt_right\">3.15</td>\n    <td class=\"gt_row gt_right\">3.44</td>\n    <td class=\"gt_row gt_right\">17.02</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">2.0</td>\n    <td class=\"gt_row gt_right\">19.7</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Valiant</td>\n    <td class=\"gt_row gt_right\">18.1</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">225.0</td>\n    <td class=\"gt_row gt_right\">105.0</td>\n    <td class=\"gt_row gt_right\">2.76</td>\n    <td class=\"gt_row gt_right\">3.46</td>\n    <td class=\"gt_row gt_right\">20.22</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">19.1</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Duster 360</td>\n    <td class=\"gt_row gt_right\">14.3</td>\n    <td class=\"gt_row gt_right\">8.0</td>\n    <td class=\"gt_row gt_right\">360.0</td>\n    <td class=\"gt_row gt_right\">245.0</td>\n    <td class=\"gt_row gt_right\">3.21</td>\n    <td class=\"gt_row gt_right\">3.57</td>\n    <td class=\"gt_row gt_right\">15.84</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">15.3</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Merc 240D</td>\n    <td class=\"gt_row gt_right\">24.4</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">146.7</td>\n    <td class=\"gt_row gt_right\">62.0</td>\n    <td class=\"gt_row gt_right\">3.69</td>\n    <td class=\"gt_row gt_right\">3.19</td>\n    <td class=\"gt_row gt_right\">20.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">2.0</td>\n    <td class=\"gt_row gt_right\">25.4</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Merc 230</td>\n    <td class=\"gt_row gt_right\">22.8</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">140.8</td>\n    <td class=\"gt_row gt_right\">95.0</td>\n    <td class=\"gt_row gt_right\">3.92</td>\n    <td class=\"gt_row gt_right\">3.15</td>\n    <td class=\"gt_row gt_right\">22.9</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">2.0</td>\n    <td class=\"gt_row gt_right\">23.8</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Merc 280</td>\n    <td class=\"gt_row gt_right\">19.2</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">167.6</td>\n    <td class=\"gt_row gt_right\">123.0</td>\n    <td class=\"gt_row gt_right\">3.92</td>\n    <td class=\"gt_row gt_right\">3.44</td>\n    <td class=\"gt_row gt_right\">18.3</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">20.2</td>\n  </tr>\n</tbody>\n\n\n</table>\n\n</div>\n        \n```\n\n:::\n:::\n\n\n## Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Use the great_tables library to create a formatted table.\nfrom great_tables import GT\nGT(mtcars_pl)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nvxqtvqyfd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>\n#nvxqtvqyfd table {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n          -webkit-font-smoothing: antialiased;\n          -moz-osx-font-smoothing: grayscale;\n        }\n\n#nvxqtvqyfd thead, tbody, tfoot, tr, td, th { border-style: none; }\n tr { background-color: transparent; }\n#nvxqtvqyfd p { margin: 0; padding: 0; }\n #nvxqtvqyfd .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }\n #nvxqtvqyfd .gt_caption { padding-top: 4px; padding-bottom: 4px; }\n #nvxqtvqyfd .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }\n #nvxqtvqyfd .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }\n #nvxqtvqyfd .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #nvxqtvqyfd .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #nvxqtvqyfd .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }\n #nvxqtvqyfd .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }\n #nvxqtvqyfd .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }\n #nvxqtvqyfd .gt_column_spanner_outer:first-child { padding-left: 0; }\n #nvxqtvqyfd .gt_column_spanner_outer:last-child { padding-right: 0; }\n #nvxqtvqyfd .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }\n #nvxqtvqyfd .gt_spanner_row { border-bottom-style: hidden; }\n #nvxqtvqyfd .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }\n #nvxqtvqyfd .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }\n #nvxqtvqyfd .gt_from_md> :first-child { margin-top: 0; }\n #nvxqtvqyfd .gt_from_md> :last-child { margin-bottom: 0; }\n #nvxqtvqyfd .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }\n #nvxqtvqyfd .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }\n #nvxqtvqyfd .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }\n #nvxqtvqyfd .gt_row_group_first td { border-top-width: 2px; }\n #nvxqtvqyfd .gt_row_group_first th { border-top-width: 2px; }\n #nvxqtvqyfd .gt_striped { color: #333333; background-color: #F4F4F4; }\n #nvxqtvqyfd .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }\n #nvxqtvqyfd .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }\n #nvxqtvqyfd .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }\n #nvxqtvqyfd .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }\n #nvxqtvqyfd .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }\n #nvxqtvqyfd .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }\n #nvxqtvqyfd .gt_left { text-align: left; }\n #nvxqtvqyfd .gt_center { text-align: center; }\n #nvxqtvqyfd .gt_right { text-align: right; font-variant-numeric: tabular-nums; }\n #nvxqtvqyfd .gt_font_normal { font-weight: normal; }\n #nvxqtvqyfd .gt_font_bold { font-weight: bold; }\n #nvxqtvqyfd .gt_font_italic { font-style: italic; }\n #nvxqtvqyfd .gt_super { font-size: 65%; }\n #nvxqtvqyfd .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }\n #nvxqtvqyfd .gt_asterisk { font-size: 100%; vertical-align: 0; }\n \n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n<thead>\n\n<tr class=\"gt_col_headings\">\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"model_name\">model_name</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mpg\">mpg</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cyl\">cyl</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"disp\">disp</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hp\">hp</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"drat\">drat</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"wt\">wt</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"qsec\">qsec</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"vs\">vs</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"am\">am</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gear\">gear</th>\n  <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"carb\">carb</th>\n</tr>\n</thead>\n<tbody class=\"gt_table_body\">\n  <tr>\n    <td class=\"gt_row gt_left\">Mazda RX4</td>\n    <td class=\"gt_row gt_right\">21.0</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">160.0</td>\n    <td class=\"gt_row gt_right\">110.0</td>\n    <td class=\"gt_row gt_right\">3.9</td>\n    <td class=\"gt_row gt_right\">2.62</td>\n    <td class=\"gt_row gt_right\">16.46</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Mazda RX4 Wag</td>\n    <td class=\"gt_row gt_right\">21.0</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">160.0</td>\n    <td class=\"gt_row gt_right\">110.0</td>\n    <td class=\"gt_row gt_right\">3.9</td>\n    <td class=\"gt_row gt_right\">2.875</td>\n    <td class=\"gt_row gt_right\">17.02</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Datsun 710</td>\n    <td class=\"gt_row gt_right\">22.8</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">108.0</td>\n    <td class=\"gt_row gt_right\">93.0</td>\n    <td class=\"gt_row gt_right\">3.85</td>\n    <td class=\"gt_row gt_right\">2.32</td>\n    <td class=\"gt_row gt_right\">18.61</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Hornet 4 Drive</td>\n    <td class=\"gt_row gt_right\">21.4</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">258.0</td>\n    <td class=\"gt_row gt_right\">110.0</td>\n    <td class=\"gt_row gt_right\">3.08</td>\n    <td class=\"gt_row gt_right\">3.215</td>\n    <td class=\"gt_row gt_right\">19.44</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Hornet Sportabout</td>\n    <td class=\"gt_row gt_right\">18.7</td>\n    <td class=\"gt_row gt_right\">8.0</td>\n    <td class=\"gt_row gt_right\">360.0</td>\n    <td class=\"gt_row gt_right\">175.0</td>\n    <td class=\"gt_row gt_right\">3.15</td>\n    <td class=\"gt_row gt_right\">3.44</td>\n    <td class=\"gt_row gt_right\">17.02</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">2.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Valiant</td>\n    <td class=\"gt_row gt_right\">18.1</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">225.0</td>\n    <td class=\"gt_row gt_right\">105.0</td>\n    <td class=\"gt_row gt_right\">2.76</td>\n    <td class=\"gt_row gt_right\">3.46</td>\n    <td class=\"gt_row gt_right\">20.22</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Duster 360</td>\n    <td class=\"gt_row gt_right\">14.3</td>\n    <td class=\"gt_row gt_right\">8.0</td>\n    <td class=\"gt_row gt_right\">360.0</td>\n    <td class=\"gt_row gt_right\">245.0</td>\n    <td class=\"gt_row gt_right\">3.21</td>\n    <td class=\"gt_row gt_right\">3.57</td>\n    <td class=\"gt_row gt_right\">15.84</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">3.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Merc 240D</td>\n    <td class=\"gt_row gt_right\">24.4</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">146.7</td>\n    <td class=\"gt_row gt_right\">62.0</td>\n    <td class=\"gt_row gt_right\">3.69</td>\n    <td class=\"gt_row gt_right\">3.19</td>\n    <td class=\"gt_row gt_right\">20.0</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">2.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Merc 230</td>\n    <td class=\"gt_row gt_right\">22.8</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">140.8</td>\n    <td class=\"gt_row gt_right\">95.0</td>\n    <td class=\"gt_row gt_right\">3.92</td>\n    <td class=\"gt_row gt_right\">3.15</td>\n    <td class=\"gt_row gt_right\">22.9</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">2.0</td>\n  </tr>\n  <tr>\n    <td class=\"gt_row gt_left\">Merc 280</td>\n    <td class=\"gt_row gt_right\">19.2</td>\n    <td class=\"gt_row gt_right\">6.0</td>\n    <td class=\"gt_row gt_right\">167.6</td>\n    <td class=\"gt_row gt_right\">123.0</td>\n    <td class=\"gt_row gt_right\">3.92</td>\n    <td class=\"gt_row gt_right\">3.44</td>\n    <td class=\"gt_row gt_right\">18.3</td>\n    <td class=\"gt_row gt_right\">1.0</td>\n    <td class=\"gt_row gt_right\">0.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n    <td class=\"gt_row gt_right\">4.0</td>\n  </tr>\n</tbody>\n\n\n</table>\n\n</div>\n        \n```\n\n:::\n:::\n\n\n\n\n\n:::\n\n# Window Functions\n\nThis section demonstrates how to use window functions to perform calculations across a set of table rows that are somehow related to the current row.\n\n## Rank\n\nRank rows within partitions. Here we rank cars by `mpg` (descending) within each `cyl` group.\n\n::: panel-tabset\n\n### SQL\n\n\n::: {.cell}\n\n```{.sql .cell-code}\nSELECT model_name, cyl, mpg, \n       rank() OVER (PARTITION BY cyl ORDER BY mpg DESC) as rank \nFROM mtcars_table \nORDER BY cyl, rank\nLIMIT 10;\n```\n\n\n<div class=\"knitsql-table\">\n\n\nTable: 9 records\n\n|model_name        | cyl|   mpg| rank|\n|:-----------------|---:|-----:|----:|\n|Merc 240D         |   4|  24.4|    1|\n|Datsun 710        |   4|  22.8|    2|\n|Merc 230          |   4|  22.8|    2|\n|Mazda RX4 Wag     |   6| 999.0|    1|\n|Hornet 4 Drive    |   6|  21.4|    2|\n|Merc 280          |   6|  19.2|    3|\n|Valiant           |   6|  18.1|    4|\n|Hornet Sportabout |   8|  18.7|    1|\n|Duster 360        |   8|  14.3|    2|\n\n</div>\n:::\n\n\n### R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars |> \n  select(model_name, cyl, mpg) |> \n  group_by(cyl) |> \n  mutate(rank = min_rank(desc(mpg))) |> \n  arrange(cyl, rank) |> \n  head(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n# Groups:   cyl [3]\n   model_name          cyl   mpg  rank\n   <chr>             <dbl> <dbl> <int>\n 1 Merc 240D             4  24.4     1\n 2 Datsun 710            4  22.8     2\n 3 Merc 230              4  22.8     2\n 4 Hornet 4 Drive        6  21.4     1\n 5 Mazda RX4             6  21       2\n 6 Mazda RX4 Wag         6  21       2\n 7 Merc 280              6  19.2     4\n 8 Valiant               6  18.1     5\n 9 Hornet Sportabout     8  18.7     1\n10 Duster 360            8  14.3     2\n```\n\n\n:::\n:::\n\n\n### Python pandas\n\n\n::: {.cell}\n\n```{.python .cell-code}\n# Rank within groups\nmtcars_pd[['model_name', 'cyl', 'mpg']].assign(\n    rank=mtcars_pd.groupby('cyl')['mpg'].rank(method='min', ascending=False)\n).sort_values(['cyl', 'rank']).head(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          model_name  cyl    mpg  rank\nMerc 240D                  Merc 240D  4.0   24.4   1.0\nDatsun 710                Datsun 710  4.0   22.8   2.0\nMerc 230                    Merc 230  4.0   22.8   2.0\nMazda RX4 Wag          Mazda RX4 Wag  6.0  999.0   1.0\nHornet 4 Drive        Hornet 4 Drive  6.0   21.4   2.0\nMazda RX4                  Mazda RX4  6.0   21.0   3.0\nMerc 280                    Merc 280  6.0   19.2   4.0\nValiant                      Valiant  6.0   18.1   5.0\nHornet Sportabout  Hornet Sportabout  8.0   18.7   1.0\nDuster 360                Duster 360  8.0   14.3   2.0\n```\n\n\n:::\n:::\n\n\n### Python Polars\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmtcars_pl.select(\"model_name\", \"cyl\", \"mpg\").with_columns(\n    pl.col(\"mpg\").rank(method=\"min\", descending=True).over(\"cyl\").alias(\"rank\")\n).sort(\"cyl\", \"rank\").head(10)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>model_name</th><th>cyl</th><th>mpg</th><th>rank</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>u32</td></tr></thead><tbody><tr><td>&quot;Merc 240D&quot;</td><td>4.0</td><td>24.4</td><td>1</td></tr><tr><td>&quot;Datsun 710&quot;</td><td>4.0</td><td>22.8</td><td>2</td></tr><tr><td>&quot;Merc 230&quot;</td><td>4.0</td><td>22.8</td><td>2</td></tr><tr><td>&quot;Hornet 4 Drive&quot;</td><td>6.0</td><td>21.4</td><td>1</td></tr><tr><td>&quot;Mazda RX4&quot;</td><td>6.0</td><td>21.0</td><td>2</td></tr><tr><td>&quot;Mazda RX4 Wag&quot;</td><td>6.0</td><td>21.0</td><td>2</td></tr><tr><td>&quot;Merc 280&quot;</td><td>6.0</td><td>19.2</td><td>4</td></tr><tr><td>&quot;Valiant&quot;</td><td>6.0</td><td>18.1</td><td>5</td></tr><tr><td>&quot;Hornet Sportabout&quot;</td><td>8.0</td><td>18.7</td><td>1</td></tr><tr><td>&quot;Duster 360&quot;</td><td>8.0</td><td>14.3</td><td>2</td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Disconnect from the database and shut it down.\ndbDisconnect(con, shutdown = TRUE)\n```\n:::\n\n\n# Reference:\n\n- [DuckDB R Client Documentation](https://duckdb.org/docs/stable/clients/r.html)\n- [DuckDB SQL Statements](https://duckdb.org/docs/stable/sql/statements)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}