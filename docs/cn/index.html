<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="cn" xml:lang="cn">
<head>
<link rel="alternate" hreflang="en" href="https://jcwinning.github.io/Into_sql/index.html" />
<link rel="alternate" hreflang="cn" href="https://jcwinning.github.io/Into_sql/cn/index.cn.html" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Tony Duan">
<title>SQL handbook – SQL入门</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><meta name="quarto:offset" content="./">
<link href="./SQL-Database.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script><script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script><script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e25b16015d6561c5b4cb640ab6ae3af4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-8409e167475d50c6ab33f47afc963055.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-e25b16015d6561c5b4cb640ab6ae3af4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-fixed quarto-light">
<script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script><div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./SQL-Database.png" alt="" class="navbar-logo light-content"><img src="./SQL-Database.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SQL入门</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item"><div class="dropdown" id="languages-links-parent">
<button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" id="languages-button"><i class="bi bi-globe2"></i> 中文</button><ul class="dropdown-menu" id="languages-links"><li><a class="dropdown-item" href="https://jcwinning.github.io/Into_sql/index.html" id="language-link-en">EN</a></li></ul>
</div></li>
<li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#%E4%BB%8B%E7%BB%8D%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7" id="toc-介绍数据分析工具" class="nav-link active" data-scroll-target="#介绍数据分析工具"><span class="header-section-number">0.1</span> 介绍数据分析工具</a></li>
  <li><a href="#%E8%AE%BE%E7%BD%AE%E4%B8%8E%E9%85%8D%E7%BD%AE" id="toc-设置与配置" class="nav-link" data-scroll-target="#设置与配置"><span class="header-section-number">1</span> 设置与配置</a></li>
  <li><a href="#%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E8%A1%A8" id="toc-显示所有表" class="nav-link" data-scroll-target="#显示所有表"><span class="header-section-number">2</span> 显示所有表</a></li>
  <li><a href="#%E6%8F%8F%E8%BF%B0%E8%A1%A8" id="toc-描述表" class="nav-link" data-scroll-target="#描述表"><span class="header-section-number">3</span> 描述表</a></li>
  <li><a href="#%E6%98%BE%E7%A4%BA%E5%88%97%E5%90%8D" id="toc-显示列名" class="nav-link" data-scroll-target="#显示列名"><span class="header-section-number">4</span> 显示列名</a></li>
  <li>
<a href="#%E9%80%89%E6%8B%A9" id="toc-选择" class="nav-link" data-scroll-target="#选择"><span class="header-section-number">5</span> 选择</a>
  <ul class="collapse">
<li><a href="#%E9%80%89%E6%8B%A9%E5%89%8D-6-%E8%A1%8C%E5%B9%B6%E9%87%8D%E5%91%BD%E5%90%8D" id="toc-选择前-6-行并重命名" class="nav-link" data-scroll-target="#选择前-6-行并重命名"><span class="header-section-number">5.1</span> 选择前 6 行并重命名</a></li>
  <li><a href="#%E9%80%89%E6%8B%A9%E4%B8%8D%E5%90%8C%E8%A1%8C" id="toc-选择不同行" class="nav-link" data-scroll-target="#选择不同行"><span class="header-section-number">5.2</span> 选择不同行</a></li>
  </ul>
</li>
  <li><a href="#%E6%A3%80%E6%9F%A5%E8%A1%8C%E6%95%B0%E5%92%8C%E5%88%97%E6%95%B0" id="toc-检查行数和列数" class="nav-link" data-scroll-target="#检查行数和列数"><span class="header-section-number">6</span> 检查行数和列数</a></li>
  <li><a href="#%E5%88%9B%E5%BB%BA%E5%88%97" id="toc-创建列" class="nav-link" data-scroll-target="#创建列"><span class="header-section-number">7</span> 创建列</a></li>
  <li><a href="#%E7%AD%9B%E9%80%89" id="toc-筛选" class="nav-link" data-scroll-target="#筛选"><span class="header-section-number">8</span> 筛选</a></li>
  <li><a href="#%E6%8E%92%E5%BA%8F" id="toc-排序" class="nav-link" data-scroll-target="#排序"><span class="header-section-number">9</span> 排序</a></li>
  <li><a href="#%E5%88%86%E7%BB%84" id="toc-分组" class="nav-link" data-scroll-target="#分组"><span class="header-section-number">10</span> 分组</a></li>
  <li>
<a href="#%E5%88%9B%E5%BB%BA%E8%A1%A8" id="toc-创建表" class="nav-link" data-scroll-target="#创建表"><span class="header-section-number">11</span> 创建表</a>
  <ul class="collapse">
<li><a href="#create-or-replace" id="toc-create-or-replace" class="nav-link" data-scroll-target="#create-or-replace"><span class="header-section-number">11.1</span> CREATE OR REPLACE</a></li>
  <li><a href="#create-table-if-not-exists" id="toc-create-table-if-not-exists" class="nav-link" data-scroll-target="#create-table-if-not-exists"><span class="header-section-number">11.2</span> CREATE TABLE IF NOT EXISTS</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%94%AF%E4%B8%80%E5%80%BC" id="toc-唯一值" class="nav-link" data-scroll-target="#唯一值"><span class="header-section-number">12</span> 唯一值</a>
  <ul class="collapse">
<li><a href="#%E6%A3%80%E6%9F%A5%E5%94%AF%E4%B8%80%E5%80%BC" id="toc-检查唯一值" class="nav-link" data-scroll-target="#检查唯一值"><span class="header-section-number">12.1</span> 检查唯一值</a></li>
  <li><a href="#%E8%8E%B7%E5%8F%96%E9%87%8D%E5%A4%8D%E5%92%8C%E9%9D%9E%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE" id="toc-获取重复和非重复数据" class="nav-link" data-scroll-target="#获取重复和非重复数据"><span class="header-section-number">12.2</span> 获取重复和非重复数据</a></li>
  </ul>
</li>
  <li>
<a href="#%E8%BF%9E%E6%8E%A5" id="toc-连接" class="nav-link" data-scroll-target="#连接"><span class="header-section-number">13</span> 连接</a>
  <ul class="collapse">
<li><a href="#%E5%B7%A6%E8%BF%9E%E6%8E%A5" id="toc-左连接" class="nav-link" data-scroll-target="#左连接"><span class="header-section-number">13.1</span> 左连接</a></li>
  <li><a href="#%E5%86%85%E8%BF%9E%E6%8E%A5" id="toc-内连接" class="nav-link" data-scroll-target="#内连接"><span class="header-section-number">13.2</span> 内连接</a></li>
  </ul>
</li>
  <li>
<a href="#%E8%BF%BD%E5%8A%A0%E8%A1%8C" id="toc-追加行" class="nav-link" data-scroll-target="#追加行"><span class="header-section-number">14</span> 追加行</a>
  <ul class="collapse">
<li><a href="#%E8%BF%BD%E5%8A%A0%E6%97%B6%E4%B8%8D%E6%B6%88%E9%99%A4%E9%87%8D%E5%A4%8D%E9%A1%B9-union-all" id="toc-追加时不消除重复项-union-all" class="nav-link" data-scroll-target="#追加时不消除重复项-union-all"><span class="header-section-number">14.1</span> 追加时不消除重复项 (<code>union all</code>)</a></li>
  <li><a href="#%E8%BF%BD%E5%8A%A0%E6%97%B6%E6%B6%88%E9%99%A4%E9%87%8D%E5%A4%8D%E9%A1%B9-union" id="toc-追加时消除重复项-union" class="nav-link" data-scroll-target="#追加时消除重复项-union"><span class="header-section-number">14.2</span> 追加时消除重复项 (<code>union</code>)</a></li>
  </ul>
</li>
  <li><a href="#%E5%88%A0%E9%99%A4%E8%A1%8C" id="toc-删除行" class="nav-link" data-scroll-target="#删除行"><span class="header-section-number">15</span> 删除行</a></li>
  <li><a href="#%E6%9B%B4%E6%96%B0%E8%A1%8C" id="toc-更新行" class="nav-link" data-scroll-target="#更新行"><span class="header-section-number">16</span> 更新行</a></li>
  <li><a href="#%E5%88%A0%E9%99%A4%E8%A1%A8" id="toc-删除表" class="nav-link" data-scroll-target="#删除表"><span class="header-section-number">17</span> 删除表</a></li>
  <li>
<a href="#pivot-%E9%80%8F%E8%A7%86" id="toc-pivot-透视" class="nav-link" data-scroll-target="#pivot-透视"><span class="header-section-number">18</span> PIVOT (透视)</a>
  <ul class="collapse">
<li><a href="#%E5%AF%B9%E4%B8%80%E5%88%97%E8%BF%9B%E8%A1%8C%E9%80%8F%E8%A7%86" id="toc-对一列进行透视" class="nav-link" data-scroll-target="#对一列进行透视"><span class="header-section-number">18.1</span> 对一列进行透视</a></li>
  <li><a href="#%E5%AF%B9%E4%B8%A4%E5%88%97%E8%BF%9B%E8%A1%8C%E9%80%8F%E8%A7%86" id="toc-对两列进行透视" class="nav-link" data-scroll-target="#对两列进行透视"><span class="header-section-number">18.2</span> 对两列进行透视</a></li>
  </ul>
</li>
  <li><a href="#unpivot-%E9%80%86%E9%80%8F%E8%A7%86" id="toc-unpivot-逆透视" class="nav-link" data-scroll-target="#unpivot-逆透视"><span class="header-section-number">19</span> UNPIVOT (逆透视)</a></li>
  <li><a href="#explain-%E8%A7%A3%E9%87%8A" id="toc-explain-解释" class="nav-link" data-scroll-target="#explain-解释"><span class="header-section-number">20</span> EXPLAIN (解释)</a></li>
  <li><a href="#%E6%98%BE%E7%A4%BA%E7%B2%BE%E7%BE%8E%E7%9A%84%E8%A1%A8%E6%A0%BC" id="toc-显示精美的表格" class="nav-link" data-scroll-target="#显示精美的表格"><span class="header-section-number">21</span> 显示精美的表格</a></li>
  <li>
<a href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0" id="toc-窗口函数" class="nav-link" data-scroll-target="#窗口函数"><span class="header-section-number">22</span> 窗口函数</a>
  <ul class="collapse">
<li><a href="#%E6%8E%92%E5%90%8D" id="toc-排名" class="nav-link" data-scroll-target="#排名"><span class="header-section-number">22.1</span> 排名</a></li>
  </ul>
</li>
  <li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" id="toc-参考资料" class="nav-link" data-scroll-target="#参考资料"><span class="header-section-number">23</span> 参考资料:</a></li>
  </ul></nav>
</div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div>
<h1 class="title">SQL handbook</h1>
<button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu">
<li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li>
<li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li>
<li><hr class="dropdown-divider"></li>
<li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li>
</ul>
</div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tony Duan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><p>本文档提供了使用 SQL、R 和 Python 执行常见数据操作任务的综合指南。它可作为理解如何在这三种流行的数据分析工具中实现相似结果的参考。</p>
<section id="介绍数据分析工具" class="level2" data-number="0.1"><h2 data-number="0.1" class="anchored" data-anchor-id="介绍数据分析工具">
<span class="header-section-number">0.1</span> 介绍数据分析工具</h2>
<p>在数据分析中，我们使用不同的工具，每个工具都有其优势：</p>
<ul>
<li>
<strong>SQL</strong>：擅长结构化查询和数据库操作</li>
<li>
<strong>R</strong>：强大的统计计算和数据可视化</li>
<li>
<strong>Python</strong>：多功能编程，拥有优秀的数据科学库</li>
</ul>
<p>本教程展示了如何在所有三个工具中完成相同的数据操作任务，帮助您为您的需求选择正确的方法。</p>
</section><section id="设置与配置" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> 设置与配置</h1>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_require</span>(<span class="fu">c</span>(<span class="st">"pandas"</span>,<span class="st">"Great-Tables"</span>,<span class="st">"polars"</span>,<span class="st">"pyarrow"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries for database interaction, data manipulation, and connections.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the R dataframes.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the existing mtcars dataset if it exists.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mtcars)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the mtcars dataframe from the base R dataset, adding the row names as a new column.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">model_name =</span> <span class="fu">rownames</span>(mtcars), mtcars) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the iris dataframe from the base R dataset.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">=</span> iris <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the database file if it already exists to start with a clean slate.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"my-db.duckdb"</span>)) {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(<span class="st">"my-db.duckdb"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a connection to the DuckDB database.</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"my-db.duckdb"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the iris and mtcars dataframes to the database as tables.</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"iris_table"</span>, iris, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"mtcars_table"</span>, mtcars, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(python_version())</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>cities_pd <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'country'</span>: [<span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>],</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>],</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'year'</span>: [<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>],</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'population'</span>: [<span class="dv">1005</span>, <span class="dv">1065</span>, <span class="dv">1158</span>, <span class="dv">564</span>, <span class="dv">608</span>, <span class="dv">738</span>, <span class="dv">8015</span>, <span class="dv">8175</span>, <span class="dv">8772</span>]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the R dataframes available in the Python environment.</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>mtcars_pd <span class="op">=</span> r.mtcars</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>iris_pd <span class="op">=</span> r.iris</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>mtcars_pl <span class="op">=</span> pl.from_pandas(mtcars_pd)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>iris_pl <span class="op">=</span> pl.from_pandas(iris_pd)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>cities_pl<span class="op">=</span>pl.from_pandas(cities_pd)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<ul>
<li>DuckDB 数据库 <code>my-db.duckdb</code> 中有 <code>iris_table</code> 和 <code>mtcars_table</code> 表。</li>
<li>R 环境中有 <code>iris</code> 和 <code>mtcars</code> 数据框。</li>
<li>Python 环境中有 <code>iris</code> 和 <code>mtcars</code> 数据框。</li>
</ul></section><section id="显示所有表" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> 显示所有表</h1>
<p>本节演示如何列出每个环境中的所有可用表或数据框。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示所连接数据库中的所有表。</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 35%">
<col style="width: 54%">
<col style="width: 2%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 列出当前 R 环境中的所有数据框。</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.data.frame, <span class="fu">as.list</span>(.GlobalEnv))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dflist)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "mtcars" "iris"  </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 列出当前 Python 环境中的所有 pandas 数据框。</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">dir</span>() <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">eval</span>(var), pd.core.frame.DataFrame)]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>['cities_pd', 'iris_pd', 'mtcars_pd']</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [name <span class="cf">for</span> name, val <span class="kw">in</span> <span class="bu">globals</span>().items() <span class="cf">if</span> <span class="bu">isinstance</span>(val, pl.DataFrame)]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>['mtcars_pl', 'iris_pl', 'cities_pl']</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="描述表" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> 描述表</h1>
<p>本节介绍如何获取表结构和统计信息的摘要。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 描述 mtcars_table 的列和数据类型。</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>DESCRIBE mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead><tr class="header">
<th style="text-align: left;">column_name</th>
<th style="text-align: left;">column_type</th>
<th style="text-align: left;">null</th>
<th style="text-align: left;">key</th>
<th style="text-align: left;">default</th>
<th style="text-align: left;">extra</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">model_name</td>
<td style="text-align: left;">VARCHAR</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cyl</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vs</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提供 mtcars 数据框的详细摘要。</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mtcars)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mtcars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">model_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr></tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.37</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">14.30</td>
<td style="text-align: right;">18.82</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">22.45</td>
<td style="text-align: right;">24.40</td>
<td style="text-align: left;">▂▂▅▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cyl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.80</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">▅▁▇▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">208.61</td>
<td style="text-align: right;">90.37</td>
<td style="text-align: right;">108.00</td>
<td style="text-align: right;">150.02</td>
<td style="text-align: right;">163.80</td>
<td style="text-align: right;">249.75</td>
<td style="text-align: right;">360.00</td>
<td style="text-align: left;">▇▇▅▁▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">122.80</td>
<td style="text-align: right;">51.45</td>
<td style="text-align: right;">62.00</td>
<td style="text-align: right;">97.50</td>
<td style="text-align: right;">110.00</td>
<td style="text-align: right;">119.75</td>
<td style="text-align: right;">245.00</td>
<td style="text-align: left;">▅▇▁▂▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: left;">▁▃▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">3.57</td>
<td style="text-align: left;">▂▂▂▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.58</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">18.45</td>
<td style="text-align: right;">19.86</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: left;">▇▃▃▂▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">vs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">am</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">gear</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">carb</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▆▆▁▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成 mtcars 数据框的描述性统计信息。</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.describe(include<span class="op">=</span><span class="st">'all'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>       model_name        mpg       cyl  ...         am       gear       carb
count          10  10.000000  10.00000  ...  10.000000  10.000000  10.000000
unique         10        NaN       NaN  ...        NaN        NaN        NaN
top     Mazda RX4        NaN       NaN  ...        NaN        NaN        NaN
freq            1        NaN       NaN  ...        NaN        NaN        NaN
mean          NaN  20.370000   5.80000  ...   0.300000   3.600000   2.500000
std           NaN   2.907099   1.47573  ...   0.483046   0.516398   1.354006
min           NaN  14.300000   4.00000  ...   0.000000   3.000000   1.000000
25%           NaN  18.825000   4.50000  ...   0.000000   3.000000   1.250000
50%           NaN  21.000000   6.00000  ...   0.000000   4.000000   2.000000
75%           NaN  22.450000   6.00000  ...   0.750000   4.000000   4.000000
max           NaN  24.400000   8.00000  ...   1.000000   4.000000   4.000000

[11 rows x 12 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.describe()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 13)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">statistic</th>
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"count"</td>
<td>"10"</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>"null_count"</td>
<td>"0"</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>"mean"</td>
<td>null</td>
<td>20.37</td>
<td>5.8</td>
<td>208.61</td>
<td>122.8</td>
<td>3.538</td>
<td>3.128</td>
<td>18.581</td>
<td>0.6</td>
<td>0.3</td>
<td>3.6</td>
<td>2.5</td>
</tr>
<tr class="even">
<td>"std"</td>
<td>null</td>
<td>2.907099</td>
<td>1.47573</td>
<td>90.373896</td>
<td>51.449652</td>
<td>0.440651</td>
<td>0.40649</td>
<td>2.135845</td>
<td>0.516398</td>
<td>0.483046</td>
<td>0.516398</td>
<td>1.354006</td>
</tr>
<tr class="odd">
<td>"min"</td>
<td>"Datsun 710"</td>
<td>14.3</td>
<td>4.0</td>
<td>108.0</td>
<td>62.0</td>
<td>2.76</td>
<td>2.32</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"25%"</td>
<td>null</td>
<td>18.7</td>
<td>4.0</td>
<td>146.7</td>
<td>95.0</td>
<td>3.15</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"50%"</td>
<td>null</td>
<td>21.0</td>
<td>6.0</td>
<td>167.6</td>
<td>110.0</td>
<td>3.85</td>
<td>3.215</td>
<td>18.61</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"75%"</td>
<td>null</td>
<td>22.8</td>
<td>6.0</td>
<td>258.0</td>
<td>123.0</td>
<td>3.9</td>
<td>3.44</td>
<td>20.0</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"max"</td>
<td>"Valiant"</td>
<td>24.4</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.92</td>
<td>3.57</td>
<td>22.9</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="显示列名" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> 显示列名</h1>
<p>本节演示如何检索表的列名。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示 mtcars_table 中列的信息。</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>PRAGMA table_info(mtcars_table);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead><tr class="header">
<th style="text-align: left;">cid</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">notnull</th>
<th style="text-align: left;">dflt_value</th>
<th style="text-align: left;">pk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">model_name</td>
<td style="text-align: left;">VARCHAR</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">cyl</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">disp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">hp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">drat</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">wt</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">vs</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">am</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取 mtcars 数据框的列名。</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "model_name" "mpg"        "cyl"        "disp"       "hp"        
 [6] "drat"       "wt"         "qsec"       "vs"         "am"        
[11] "gear"       "carb"      </code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 mtcars 数据框获取列名列表。</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(mtcars_pd.columns.values)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 mtcars 数据框获取列名列表。</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.columns</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="选择" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> 选择</h1>
<section id="选择前-6-行并重命名" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="选择前-6-行并重命名">
<span class="header-section-number">5.1</span> 选择前 6 行并重命名</h2>
<p>本节介绍如何选择列的子集、重命名它们并限制返回的行数。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 选择并重命名列，将结果限制为前 6 行。</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">6</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 mtcars 数据框的前 6 行中选择并重命名列。</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars, <span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              model  mpg cyl
Mazda RX4                 Mazda RX4 21.0   6
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6
Datsun 710               Datsun 710 22.8   4
Hornet 4 Drive       Hornet 4 Drive 21.4   6
Hornet Sportabout Hornet Sportabout 18.7   8
Valiant                     Valiant 18.1   6</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 重命名 mtcars 数据框中的列。</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.rename(columns<span class="op">=</span>{<span class="st">'model_name'</span>: <span class="st">'model'</span>})</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                               model   mpg  cyl   disp  ...   vs   am  gear  carb
Mazda RX4                  Mazda RX4  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0
Datsun 710                Datsun 710  22.8  4.0  108.0  ...  1.0  1.0   4.0   1.0
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  1.0  0.0   3.0   1.0
Hornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0  0.0   3.0   2.0
Valiant                      Valiant  18.1  6.0  225.0  ...  1.0  0.0   3.0   1.0
Duster 360                Duster 360  14.3  8.0  360.0  ...  0.0  0.0   3.0   4.0
Merc 240D                  Merc 240D  24.4  4.0  146.7  ...  1.0  0.0   4.0   2.0
Merc 230                    Merc 230  22.8  4.0  140.8  ...  1.0  0.0   4.0   2.0
Merc 280                    Merc 280  19.2  6.0  167.6  ...  1.0  0.0   4.0   4.0

[10 rows x 12 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"model_name"</span>).alias(<span class="st">"model"</span>), pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).head(<span class="dv">6</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="选择不同行" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="选择不同行">
<span class="header-section-number">5.2</span> 选择不同行</h2>
<p>本节演示如何根据指定的列检索唯一的行。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 选择 mpg 和 cyl 的不同组合。</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> mpg, cyl <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>8 records</caption>
<thead><tr class="header">
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 和 cyl 获取不同的行。</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(mpg, cyl)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl
Mazda RX4         21.0   6
Datsun 710        22.8   4
Hornet 4 Drive    21.4   6
Hornet Sportabout 18.7   8
Valiant           18.1   6
Duster 360        14.3   8
Merc 240D         24.4   4
Merc 280          19.2   6</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择特定列并删除重复行。</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> mtcars_pd[[<span class="st">"mpg"</span>, <span class="st">"cyl"</span>]]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.drop_duplicates())</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cyl
Mazda RX4          21.0  6.0
Datsun 710         22.8  4.0
Hornet 4 Drive     21.4  6.0
Hornet Sportabout  18.7  8.0
Valiant            18.1  6.0
Duster 360         14.3  8.0
Merc 240D          24.4  4.0
Merc 280           19.2  6.0</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).unique()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
</tr>
<tr class="even">
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14.3</td>
<td>8.0</td>
</tr>
<tr class="even">
<td>18.1</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>21.4</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>22.8</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>24.4</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>19.2</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>18.7</td>
<td>8.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="检查行数和列数" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> 检查行数和列数</h1>
<p>本节介绍如何查找表的维度。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 获取总行数。</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> <span class="fu">row_number</span> <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">row_number</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">10</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 获取总列数。</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> column_number <span class="kw">FROM</span> (DESCRIBE mtcars_table);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">column_number</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">12</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取行数。</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取列数。</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mtcars)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取行数。</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">0</span>]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取列数。</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">1</span>]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取行数。</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">0</span>]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取列数。</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">1</span>]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="创建列" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> 创建列</h1>
<p>本节演示如何基于现有数据向表中添加新列。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 通过对现有列执行计算来创建新列。</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, mpg <span class="op">+</span> <span class="dv">1</span> <span class="kw">AS</span> new_mpg <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
<th style="text-align: right;">new_mpg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108.0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">19.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">245</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.570</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">15.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">146.7</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">25.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">140.8</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 向数据框添加新列。</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_mpg =</span> mpg <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb new_mpg
Mazda RX4            4    4    22.0
Mazda RX4 Wag        4    4    22.0
Datsun 710           4    1    23.8
Hornet 4 Drive       3    1    22.4
Hornet Sportabout    3    2    19.7
Valiant              3    1    19.1
Duster 360           3    4    15.3
Merc 240D            4    2    25.4
Merc 230             4    2    23.8
Merc 280             4    4    20.2</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 在数据框中创建新列。</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="st">"new_mpg"</span>] <span class="op">=</span> mtcars_pd[<span class="st">"mpg"</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4                  Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  108.0  ...  1.0   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  360.0  ...  0.0   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  146.7  ...  0.0   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  140.8  ...  0.0   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns((pl.col(<span class="st">"mpg"</span>) <span class="op">+</span> <span class="dv">1</span>).alias(<span class="st">"new_mpg"</span>))</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 13)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
<th data-quarto-table-cell-role="th">new_mpg</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>22.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>22.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>23.8</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>22.4</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>19.7</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>19.1</td>
</tr>
<tr class="odd">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
<td>15.3</td>
</tr>
<tr class="even">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
<td>25.4</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
<td>23.8</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
<td>20.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="筛选" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> 筛选</h1>
<p>本节介绍如何选择满足特定条件的行。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 使用 AND 运算符根据多个条件筛选行。</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">AND</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 使用 OR 运算符筛选行。</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">OR</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 &amp; 运算符进行“与”筛选。</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">&amp;</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         Mazda RX4  21   6  160 110  3.9 2.620 16.46  0  1    4    4
Mazda RX4 Wag Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 | 运算符进行“或”筛选。</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">|</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                   model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear
Mazda RX4           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4
Mazda RX4 Wag   Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4
Hornet 4 Drive Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3
Valiant               Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3
Merc 280             Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4
               carb
Mazda RX4         4
Mazda RX4 Wag     4
Hornet 4 Drive    1
Valiant           1
Merc 280          4</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 query 方法进行“与”筛选。</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 and cyl == 6'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                  model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
Mazda RX4          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
Mazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0

[2 rows x 13 columns]</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 query 方法进行“或”筛选。</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 or cyl == 6'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4            Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag    Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Hornet 4 Drive  Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Valiant                Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Merc 280              Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[5 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># polars 的“与”筛选</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># polars 的“或”筛选</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">|</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="排序" class="level1" data-number="9"><h1 data-number="9">
<span class="header-section-number">9</span> 排序</h1>
<p>本节演示如何根据一个或多个列对表进行排序。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 按 mpg 降序对结果进行排序，并显示前 3 行。</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">AS</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">ORDER</span> <span class="kw">BY</span> mpg <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">3</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>3 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 mpg 降序排列数据框。</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                model  mpg cyl
Merc 240D   Merc 240D 24.4   4
Datsun 710 Datsun 710 22.8   4
Merc 230     Merc 230 22.8   4</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 mpg 降序对数据框进行排序。</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[[<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>]].sort_values(by<span class="op">=</span><span class="st">'mpg'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">3</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>            model_name   mpg  cyl
Merc 240D    Merc 240D  24.4  4.0
Datsun 710  Datsun 710  22.8  4.0
Merc 230      Merc 230  22.8  4.0</code></pre>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>).sort(<span class="st">"mpg"</span>, descending<span class="op">=</span><span class="va">True</span>).head(<span class="dv">3</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="分组" class="level1" data-number="10"><h1 data-number="10">
<span class="header-section-number">10</span> 分组</h1>
<p>本节介绍如何对行进行分组并执行聚合计算。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 按 model_name 分组，并计算 mpg 的总和和 cyl 的平均值。</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span> <span class="kw">LIMIT</span> <span class="dv">5</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 model_name 分组并汇总数据。</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">group_by</span>(model_name) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">total_mpg =</span> <span class="fu">sum</span>(mpg), <span class="at">cyl_mean =</span> <span class="fu">mean</span>(cyl)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  model_name        total_mpg cyl_mean
  &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;
1 Datsun 710             22.8        4
2 Duster 360             14.3        8
3 Hornet 4 Drive         21.4        6
4 Hornet Sportabout      18.7        8
5 Mazda RX4              21          6</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 model_name 分组并聚合数据。</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.groupby(<span class="st">'model_name'</span>).agg({<span class="st">'mpg'</span>: <span class="st">'sum'</span>, <span class="st">'cyl'</span>: <span class="st">'mean'</span>}).head(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cyl
model_name                  
Datsun 710         22.8  4.0
Duster 360         14.3  8.0
Hornet 4 Drive     21.4  6.0
Hornet Sportabout  18.7  8.0
Mazda RX4          21.0  6.0</code></pre>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.group_by(<span class="st">"model_name"</span>).agg([</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    pl.<span class="bu">sum</span>(<span class="st">"mpg"</span>).alias(<span class="st">"total_mpg"</span>),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    pl.mean(<span class="st">"cyl"</span>).alias(<span class="st">"cyl_mean"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>]).head(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">total_mpg</th>
<th data-quarto-table-cell-role="th">cyl_mean</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="创建表" class="level1" data-number="11"><h1 data-number="11">
<span class="header-section-number">11</span> 创建表</h1>
<section id="create-or-replace" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="create-or-replace">
<span class="header-section-number">11.1</span> CREATE OR REPLACE</h2>
<p>此命令创建新表或覆盖现有表。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 创建一个临时表，如果它已存在则替换它。</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> mtcars_table_group <span class="kw">AS</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
</section><section id="create-table-if-not-exists" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="create-table-if-not-exists">
<span class="header-section-number">11.2</span> CREATE TABLE IF NOT EXISTS</h2>
<p>此命令仅在表尚不存在时创建表。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 仅在尚不存在的情况下创建新表。</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> new_mtcars_table_group <span class="kw">AS</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
</section></section><section id="唯一值" class="level1" data-number="12"><h1 data-number="12">
<span class="header-section-number">12</span> 唯一值</h1>
<section id="检查唯一值" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="检查唯一值">
<span class="header-section-number">12.1</span> 检查唯一值</h2>
<p>本节演示如何验证列中值的唯一性。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算总行数和不同 model_name 的数量。</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>), <span class="fu">count</span>(<span class="kw">DISTINCT</span> model_name) <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">count_star()</th>
<th style="text-align: right;">count(DISTINCT model_name)</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算总行数和不同 model_name 的数量。</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(mtcars_pd), mtcars_pd.model_name.nunique())</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>10 10</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算总行数和不同 model_name 的数量。</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.count(), pl.col(<span class="st">"model_name"</span>).n_unique())</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">model_name</th>
</tr>
<tr class="even">
<td>u32</td>
<td>u32</td>
</tr>
</thead>
<tbody><tr class="odd">
<td>10</td>
<td>10</td>
</tr></tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="获取重复和非重复数据" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="获取重复和非重复数据">
<span class="header-section-number">12.2</span> 获取重复和非重复数据</h2>
<p>本节演示如何根据单个列获取重复和非重复数据。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<section id="显示所有重复项" class="level4" data-number="12.2.0.1"><h4 data-number="12.2.0.1" class="anchored" data-anchor-id="显示所有重复项">
<span class="header-section-number">12.2.0.1</span> 显示所有重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 根据 mpg 列获取重复行。</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">&gt;</span> <span class="dv">1</span>);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108.0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">140.8</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="保留非重复项" class="level4" data-number="12.2.0.2"><h4 data-number="12.2.0.2" class="anchored" data-anchor-id="保留非重复项">
<span class="header-section-number">12.2.0.2</span> 保留非重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 根据 mpg 列获取非重复行。</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">=</span> <span class="dv">1</span>);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">245</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.570</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">146.7</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<section id="显示所有重复项-1" class="level4" data-number="12.2.0.3"><h4 data-number="12.2.0.3" class="anchored" data-anchor-id="显示所有重复项-1">
<span class="header-section-number">12.2.0.3</span> 显示所有重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取重复行。</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">duplicated</span>(mpg) <span class="sc">|</span> <span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710       Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Merc 230           Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2</code></pre>
</div>
</div>
</section><section id="保留非重复项-1" class="level4" data-number="12.2.0.4"><h4 data-number="12.2.0.4" class="anchored" data-anchor-id="保留非重复项-1">
<span class="header-section-number">12.2.0.4</span> 保留非重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取非重复行。</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(mpg) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 280             4    4</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<section id="显示所有重复项-2" class="level4" data-number="12.2.0.5"><h4 data-number="12.2.0.5" class="anchored" data-anchor-id="显示所有重复项-2">
<span class="header-section-number">12.2.0.5</span> 显示所有重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取重复行。</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                  model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
Mazda RX4          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
Mazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
Datsun 710        Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
Merc 230            Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8

[4 rows x 13 columns]</code></pre>
</div>
</div>
</section><section id="保留非重复项-2" class="level4" data-number="12.2.0.6"><h4 data-number="12.2.0.6" class="anchored" data-anchor-id="保留非重复项-2">
<span class="header-section-number">12.2.0.6</span> 保留非重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取非重复行。</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="op">~</span>mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  360.0  ...  0.0   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  146.7  ...  0.0   4.0   2.0     25.4
Merc 280                    Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[6 rows x 13 columns]</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取重复行。</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_duplicated())</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="保留非重复项-3" class="level4" data-number="12.2.0.7"><h4 data-number="12.2.0.7" class="anchored" data-anchor-id="保留非重复项-3">
<span class="header-section-number">12.2.0.7</span> 保留非重复项</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取非重复行。</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_unique())</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</section></section><section id="连接" class="level1" data-number="13"><h1 data-number="13">
<span class="header-section-number">13</span> 连接</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 从新创建的临时表中选择所有数据。</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group t1;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="左连接" class="level2" data-number="13.1"><h2 data-number="13.1" class="anchored" data-anchor-id="左连接">
<span class="header-section-number">13.1</span> 左连接</h2>
<p>本节介绍如何执行左连接以组合来自两个表的数据。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 在 mtcars_table 和 mtcars_table_group 之间执行左连接。</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> mtcars_table_group t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 对 mtcars 数据框与其自身执行左连接。</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">left_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x
1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1
2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1
3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1
4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0
5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0
  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y
1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4
2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4
3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4
4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3
5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3
  carb.y
1      4
2      4
3      1
4      1
5      2</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 pandas 执行左连接。</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'left'</span>).head(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"left"</span>).head(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 23)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
<th data-quarto-table-cell-role="th">mpg_right</th>
<th data-quarto-table-cell-role="th">cyl_right</th>
<th data-quarto-table-cell-role="th">disp_right</th>
<th data-quarto-table-cell-role="th">hp_right</th>
<th data-quarto-table-cell-role="th">drat_right</th>
<th data-quarto-table-cell-role="th">wt_right</th>
<th data-quarto-table-cell-role="th">qsec_right</th>
<th data-quarto-table-cell-role="th">vs_right</th>
<th data-quarto-table-cell-role="th">am_right</th>
<th data-quarto-table-cell-role="th">gear_right</th>
<th data-quarto-table-cell-role="th">carb_right</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="内连接" class="level2" data-number="13.2"><h2 data-number="13.2" class="anchored" data-anchor-id="内连接">
<span class="header-section-number">13.2</span> 内连接</h2>
<p>本节演示如何执行内连接。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 使用子查询执行内连接。</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行内连接。</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x
1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1
2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1
3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1
4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0
5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0
  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y
1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4
2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4
3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4
4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3
5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3
  carb.y
1      4
2      4
3      1
4      1
5      2</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 pandas 执行内连接。</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'inner'</span>).head(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"inner"</span>).head(<span class="dv">5</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 23)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
<th data-quarto-table-cell-role="th">mpg_right</th>
<th data-quarto-table-cell-role="th">cyl_right</th>
<th data-quarto-table-cell-role="th">disp_right</th>
<th data-quarto-table-cell-role="th">hp_right</th>
<th data-quarto-table-cell-role="th">drat_right</th>
<th data-quarto-table-cell-role="th">wt_right</th>
<th data-quarto-table-cell-role="th">qsec_right</th>
<th data-quarto-table-cell-role="th">vs_right</th>
<th data-quarto-table-cell-role="th">am_right</th>
<th data-quarto-table-cell-role="th">gear_right</th>
<th data-quarto-table-cell-role="th">carb_right</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="追加行" class="level1" data-number="14"><h1 data-number="14">
<span class="header-section-number">14</span> 追加行</h1>
<section id="追加时不消除重复项-union-all" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="追加时不消除重复项-union-all">
<span class="header-section-number">14.1</span> 追加时不消除重复项 (<code>union all</code>)</h2>
<p>本节介绍如何组合来自两个表的行，并保留所有重复项。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false" href="">Python pandas</a></li>
</ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算原始表中的行数。</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">count_star()</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">10</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 通过将 mtcars_table 追加到自身（包括重复项）来创建新表。</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算新表中的行数。</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">count_star()</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">20</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 bind_rows 追加行。</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                              model_name  mpg cyl  disp  hp drat    wt  qsec vs
Mazda RX4...1                  Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0
Mazda RX4 Wag...2          Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0
Datsun 710...3                Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1
Hornet 4 Drive...4        Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1
Hornet Sportabout...5  Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0
Valiant...6                      Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1
Duster 360...7                Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0
Merc 240D...8                  Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1
Merc 230...9                    Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1
Merc 280...10                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1
Mazda RX4...11                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0
Mazda RX4 Wag...12         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0
Datsun 710...13               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1
Hornet 4 Drive...14       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1
Hornet Sportabout...15 Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0
Valiant...16                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1
Duster 360...17               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0
Merc 240D...18                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1
Merc 230...19                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1
Merc 280...20                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1
                       am gear carb
Mazda RX4...1           1    4    4
Mazda RX4 Wag...2       1    4    4
Datsun 710...3          1    4    1
Hornet 4 Drive...4      0    3    1
Hornet Sportabout...5   0    3    2
Valiant...6             0    3    1
Duster 360...7          0    3    4
Merc 240D...8           0    4    2
Merc 230...9            0    4    2
Merc 280...10           0    4    4
Mazda RX4...11          1    4    4
Mazda RX4 Wag...12      1    4    4
Datsun 710...13         1    4    1
Hornet 4 Drive...14     0    3    1
Hornet Sportabout...15  0    3    2
Valiant...16            0    3    1
Duster 360...17         0    3    4
Merc 240D...18          0    4    2
Merc 230...19           0    4    2
Merc 280...20           0    4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 连接数据框，保留所有行。</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
0           Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
1       Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
2          Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
3      Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
4   Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
5             Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
6          Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
7           Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
8            Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
9            Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2
10          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
11      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
12         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
13     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
14  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
15            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
16         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
17          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
18           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
19           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2

[20 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="追加时消除重复项-union" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="追加时消除重复项-union">
<span class="header-section-number">14.2</span> 追加时消除重复项 (<code>union</code>)</h2>
<p>本节演示如何在组合行时删除重复条目。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href="">Python pandas</a></li>
</ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 创建一个表，删除重复行。</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算新表中的行数。</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">count_star()</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">10</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 验证不同行的计数。</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> (</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="op">*</span> <span class="kw">FROM</span> double_mtcars_table</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">count_star()</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">10</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 追加行然后删除重复项。</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Mazda RX4            4    4
Mazda RX4 Wag        4    4
Datsun 710           4    1
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 230             4    2
Merc 280             4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 连接数据框然后删除重复项。</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>).drop_duplicates()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
0          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
1      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
2         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
3     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
4  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
5            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
6         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
7          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
8           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
9           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="删除行" class="level1" data-number="15"><h1 data-number="15">
<span class="header-section-number">15</span> 删除行</h1>
<p>本节介绍如何根据条件从表中删除行。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 从表中删除特定行。</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4'</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 验证删除后的行数。</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: right;">count_star()</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: right;">9</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 筛选掉指定的行。</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">!=</span> <span class="st">'Mazda RX4'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Mazda RX4 Wag        4    4
Datsun 710           4    1
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 230             4    2
Merc 280             4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择除指定行之外的所有行。</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">!=</span> <span class="st">'Mazda RX4'</span>]</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  108.0  ...  1.0   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  360.0  ...  0.0   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  146.7  ...  0.0   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  140.8  ...  0.0   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[9 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"model_name"</span>) <span class="op">!=</span> <span class="st">'Mazda RX4'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="更新行" class="level1" data-number="16"><h1 data-number="16">
<span class="header-section-number">16</span> 更新行</h1>
<p>本节演示如何修改表中的现有数据。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 选择要更新的行。</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 更新特定行的列值。</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> mtcars_table</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> mpg <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 验证更新。</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">999</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 在筛选的选择中更新值。</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">mpg =</span> <span class="dv">999</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4 Wag Mazda RX4 Wag 999   6  160 110  3.9 2.875 17.02  0  1    4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 .loc 更新特定值。</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.loc[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>, <span class="st">'mpg'</span>] <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                          model_name    mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4                  Mazda RX4   21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  999.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Datsun 710                Datsun 710   22.8  4.0  108.0  ...  1.0   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive   21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout   18.7  8.0  360.0  ...  0.0   3.0   2.0     19.7
Valiant                      Valiant   18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Duster 360                Duster 360   14.3  8.0  360.0  ...  0.0   3.0   4.0     15.3
Merc 240D                  Merc 240D   24.4  4.0  146.7  ...  0.0   4.0   2.0     25.4
Merc 230                    Merc 230   22.8  4.0  140.8  ...  0.0   4.0   2.0     23.8
Merc 280                    Merc 280   19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    pl.when(pl.col(<span class="st">"model_name"</span>) <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    .then(<span class="dv">999</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.col(<span class="st">"mpg"</span>))</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    .alias(<span class="st">"mpg"</span>)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>999.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="删除表" class="level1" data-number="17"><h1 data-number="17">
<span class="header-section-number">17</span> 删除表</h1>
<p>本节介绍如何从数据库中删除表。</p>
<p>删除表之前：</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 在删除一个表之前显示所有表。</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 34%">
<col style="width: 53%">
<col style="width: 2%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">new_mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">double_mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>删除表：</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 如果存在，则删除指定的表。</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> mtcars_table_group;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<p>删除表之后：</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 再次显示所有表以确认删除。</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 34%">
<col style="width: 53%">
<col style="width: 2%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">new_mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">double_mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="pivot-透视" class="level1" data-number="18"><h1 data-number="18">
<span class="header-section-number">18</span> PIVOT (透视)</h1>
<p>本节演示如何将数据从长格式转换为宽格式。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 为透视演示创建一个临时表。</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> cities;</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> cities (</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    country <span class="dt">VARCHAR</span>, name <span class="dt">VARCHAR</span>, <span class="dt">year</span> <span class="dt">INTEGER</span>, population <span class="dt">INTEGER</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> cities <span class="kw">VALUES</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2000</span>, <span class="dv">1005</span>),</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2010</span>, <span class="dv">1065</span>),</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2020</span>, <span class="dv">1158</span>),</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2000</span>, <span class="dv">564</span>),</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2010</span>, <span class="dv">608</span>),</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2020</span>, <span class="dv">738</span>),</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2000</span>, <span class="dv">8015</span>),</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2010</span>, <span class="dv">8175</span>),</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2020</span>, <span class="dv">8772</span>);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 查看原始数据。</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> cities;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>9 records</caption>
<thead><tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1005</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">608</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">8015</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">8175</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8772</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="对一列进行透视" class="level2" data-number="18.1"><h2 data-number="18.1" class="anchored" data-anchor-id="对一列进行透视">
<span class="header-section-number">18.1</span> 对一列进行透视</h2>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 对 'year' 列进行透视。</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="dt">year</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<thead><tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">2000</th>
<th style="text-align: right;">2010</th>
<th style="text-align: right;">2020</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">8579</td>
<td style="text-align: right;">8783</td>
<td style="text-align: right;">9510</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: right;">1005</td>
<td style="text-align: right;">1065</td>
<td style="text-align: right;">1158</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>year country  2000  2010  2020
0         NL  1005  1065  1158
1         US  8579  8783  9510</code></pre>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">2000</th>
<th data-quarto-table-cell-role="th">2010</th>
<th data-quarto-table-cell-role="th">2020</th>
</tr>
<tr class="even">
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"NL"</td>
<td>1005</td>
<td>1065</td>
<td>1158</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>8579</td>
<td>8783</td>
<td>9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="对两列进行透视" class="level2" data-number="18.2"><h2 data-number="18.2" class="anchored" data-anchor-id="对两列进行透视">
<span class="header-section-number">18.2</span> 对两列进行透视</h2>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 对 'country' 和 'name' 进行透视。</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> country, name</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population);</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>3 records</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">NL_Amsterdam</th>
<th style="text-align: right;">NL_New York City</th>
<th style="text-align: right;">NL_Seattle</th>
<th style="text-align: right;">US_Amsterdam</th>
<th style="text-align: right;">US_New York City</th>
<th style="text-align: right;">US_Seattle</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1005</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8015</td>
<td style="text-align: right;">564</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1065</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8175</td>
<td style="text-align: right;">608</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1158</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8772</td>
<td style="text-align: right;">738</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>year country           name  2000  2010  2020
0         NL      Amsterdam  1005  1065  1158
1         US  New York City  8015  8175  8772
2         US        Seattle   564   608   738</code></pre>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">2000</th>
<th data-quarto-table-cell-role="th">2010</th>
<th data-quarto-table-cell-role="th">2020</th>
</tr>
<tr class="even">
<td>str</td>
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"NL"</td>
<td>"Amsterdam"</td>
<td>1005</td>
<td>1065</td>
<td>1158</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"Seattle"</td>
<td>564</td>
<td>608</td>
<td>738</td>
</tr>
<tr class="odd">
<td>"US"</td>
<td>"New York City"</td>
<td>8015</td>
<td>8175</td>
<td>8772</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="unpivot-逆透视" class="level1" data-number="19"><h1 data-number="19">
<span class="header-section-number">19</span> UNPIVOT (逆透视)</h1>
<p>本节介绍如何将数据从宽格式转换为长格式。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 对先前透视的表进行逆透视。</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>UNPIVOT</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  PIVOT cities</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> <span class="dt">year</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> country</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="kw">COLUMNS</span>(<span class="op">*</span> EXCLUDE (country))</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    NAME <span class="dt">year</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">VALUE</span> population;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<thead><tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">year</th>
<th style="text-align: right;">population</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2000</td>
<td style="text-align: right;">1005</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2010</td>
<td style="text-align: right;">1065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2020</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2000</td>
<td style="text-align: right;">8579</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2010</td>
<td style="text-align: right;">8783</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2020</td>
<td style="text-align: right;">9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd <span class="op">=</span> cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd.melt(id_vars<span class="op">=</span><span class="st">'country'</span>, value_vars<span class="op">=</span>[<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>], var_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  country  year  population
0      NL  2000        1005
1      US  2000        8579
2      NL  2010        1065
3      US  2010        8783
4      NL  2020        1158
5      US  2020        9510</code></pre>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>cities_pl <span class="op">=</span> pl.from_pandas(cities_pd)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl <span class="op">=</span> cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl.unpivot(index<span class="op">=</span><span class="st">'country'</span>, on<span class="op">=</span>[<span class="st">'2000'</span>, <span class="st">'2010'</span>, <span class="st">'2020'</span>], variable_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
<tr class="even">
<td>str</td>
<td>str</td>
<td>i64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"NL"</td>
<td>"2000"</td>
<td>1005</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"2000"</td>
<td>8579</td>
</tr>
<tr class="odd">
<td>"NL"</td>
<td>"2010"</td>
<td>1065</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"2010"</td>
<td>8783</td>
</tr>
<tr class="odd">
<td>"NL"</td>
<td>"2020"</td>
<td>1158</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"2020"</td>
<td>9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="explain-解释" class="level1" data-number="20"><h1 data-number="20">
<span class="header-section-number">20</span> EXPLAIN (解释)</h1>
<p>本节演示如何分析查询的执行计划。</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示查询的逻辑执行计划。</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示详细的执行计划，包括计时信息。</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> <span class="kw">ANALYZE</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
</section><section id="显示精美的表格" class="level1" data-number="21"><h1 data-number="21">
<span class="header-section-number">21</span> 显示精美的表格</h1>
<p>本节介绍如何创建格式精美的表格以供演示。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 gt 库创建格式化的表格。</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div id="ibjcfiagah" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ibjcfiagah table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ibjcfiagah thead, #ibjcfiagah tbody, #ibjcfiagah tfoot, #ibjcfiagah tr, #ibjcfiagah td, #ibjcfiagah th {
  border-style: none;
}

#ibjcfiagah p {
  margin: 0;
  padding: 0;
}

#ibjcfiagah .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ibjcfiagah .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ibjcfiagah .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ibjcfiagah .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ibjcfiagah .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibjcfiagah .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibjcfiagah .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibjcfiagah .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ibjcfiagah .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ibjcfiagah .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ibjcfiagah .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ibjcfiagah .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ibjcfiagah .gt_spanner_row {
  border-bottom-style: hidden;
}

#ibjcfiagah .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ibjcfiagah .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ibjcfiagah .gt_from_md > :first-child {
  margin-top: 0;
}

#ibjcfiagah .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ibjcfiagah .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ibjcfiagah .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ibjcfiagah .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ibjcfiagah .gt_row_group_first td {
  border-top-width: 2px;
}

#ibjcfiagah .gt_row_group_first th {
  border-top-width: 2px;
}

#ibjcfiagah .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibjcfiagah .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ibjcfiagah .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ibjcfiagah .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibjcfiagah .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibjcfiagah .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ibjcfiagah .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ibjcfiagah .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ibjcfiagah .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibjcfiagah .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibjcfiagah .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibjcfiagah .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibjcfiagah .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibjcfiagah .gt_left {
  text-align: left;
}

#ibjcfiagah .gt_center {
  text-align: center;
}

#ibjcfiagah .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ibjcfiagah .gt_font_normal {
  font-weight: normal;
}

#ibjcfiagah .gt_font_bold {
  font-weight: bold;
}

#ibjcfiagah .gt_font_italic {
  font-style: italic;
}

#ibjcfiagah .gt_super {
  font-size: 65%;
}

#ibjcfiagah .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ibjcfiagah .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ibjcfiagah .gt_indent_1 {
  text-indent: 5px;
}

#ibjcfiagah .gt_indent_2 {
  text-indent: 10px;
}

#ibjcfiagah .gt_indent_3 {
  text-indent: 15px;
}

#ibjcfiagah .gt_indent_4 {
  text-indent: 20px;
}

#ibjcfiagah .gt_indent_5 {
  text-indent: 25px;
}

#ibjcfiagah .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ibjcfiagah div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Mazda RX4</td>
<td class="gt_row gt_right" headers="mpg">21.0</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">160.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.90</td>
<td class="gt_row gt_right" headers="wt">2.620</td>
<td class="gt_row gt_right" headers="qsec">16.46</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Mazda RX4 Wag</td>
<td class="gt_row gt_right" headers="mpg">21.0</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">160.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.90</td>
<td class="gt_row gt_right" headers="wt">2.875</td>
<td class="gt_row gt_right" headers="qsec">17.02</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Datsun 710</td>
<td class="gt_row gt_right" headers="mpg">22.8</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">108.0</td>
<td class="gt_row gt_right" headers="hp">93</td>
<td class="gt_row gt_right" headers="drat">3.85</td>
<td class="gt_row gt_right" headers="wt">2.320</td>
<td class="gt_row gt_right" headers="qsec">18.61</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Hornet 4 Drive</td>
<td class="gt_row gt_right" headers="mpg">21.4</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">258.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.08</td>
<td class="gt_row gt_right" headers="wt">3.215</td>
<td class="gt_row gt_right" headers="qsec">19.44</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Hornet Sportabout</td>
<td class="gt_row gt_right" headers="mpg">18.7</td>
<td class="gt_row gt_right" headers="cyl">8</td>
<td class="gt_row gt_right" headers="disp">360.0</td>
<td class="gt_row gt_right" headers="hp">175</td>
<td class="gt_row gt_right" headers="drat">3.15</td>
<td class="gt_row gt_right" headers="wt">3.440</td>
<td class="gt_row gt_right" headers="qsec">17.02</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Valiant</td>
<td class="gt_row gt_right" headers="mpg">18.1</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">225.0</td>
<td class="gt_row gt_right" headers="hp">105</td>
<td class="gt_row gt_right" headers="drat">2.76</td>
<td class="gt_row gt_right" headers="wt">3.460</td>
<td class="gt_row gt_right" headers="qsec">20.22</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Duster 360</td>
<td class="gt_row gt_right" headers="mpg">14.3</td>
<td class="gt_row gt_right" headers="cyl">8</td>
<td class="gt_row gt_right" headers="disp">360.0</td>
<td class="gt_row gt_right" headers="hp">245</td>
<td class="gt_row gt_right" headers="drat">3.21</td>
<td class="gt_row gt_right" headers="wt">3.570</td>
<td class="gt_row gt_right" headers="qsec">15.84</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Merc 240D</td>
<td class="gt_row gt_right" headers="mpg">24.4</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">146.7</td>
<td class="gt_row gt_right" headers="hp">62</td>
<td class="gt_row gt_right" headers="drat">3.69</td>
<td class="gt_row gt_right" headers="wt">3.190</td>
<td class="gt_row gt_right" headers="qsec">20.00</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Merc 230</td>
<td class="gt_row gt_right" headers="mpg">22.8</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">140.8</td>
<td class="gt_row gt_right" headers="hp">95</td>
<td class="gt_row gt_right" headers="drat">3.92</td>
<td class="gt_row gt_right" headers="wt">3.150</td>
<td class="gt_row gt_right" headers="qsec">22.90</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Merc 280</td>
<td class="gt_row gt_right" headers="mpg">19.2</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">167.6</td>
<td class="gt_row gt_right" headers="hp">123</td>
<td class="gt_row gt_right" headers="drat">3.92</td>
<td class="gt_row gt_right" headers="wt">3.440</td>
<td class="gt_row gt_right" headers="qsec">18.30</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 great_tables 库创建格式化的表格。</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pd)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div id="enbaimpino" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#enbaimpino table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#enbaimpino thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#enbaimpino p { margin: 0; padding: 0; }
 #enbaimpino .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #enbaimpino .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #enbaimpino .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #enbaimpino .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #enbaimpino .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #enbaimpino .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #enbaimpino .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #enbaimpino .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #enbaimpino .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #enbaimpino .gt_column_spanner_outer:first-child { padding-left: 0; }
 #enbaimpino .gt_column_spanner_outer:last-child { padding-right: 0; }
 #enbaimpino .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #enbaimpino .gt_spanner_row { border-bottom-style: hidden; }
 #enbaimpino .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #enbaimpino .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #enbaimpino .gt_from_md> :first-child { margin-top: 0; }
 #enbaimpino .gt_from_md> :last-child { margin-bottom: 0; }
 #enbaimpino .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #enbaimpino .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #enbaimpino .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #enbaimpino .gt_row_group_first td { border-top-width: 2px; }
 #enbaimpino .gt_row_group_first th { border-top-width: 2px; }
 #enbaimpino .gt_striped { color: #333333; background-color: #F4F4F4; }
 #enbaimpino .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #enbaimpino .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }
 #enbaimpino .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }
 #enbaimpino .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }
 #enbaimpino .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #enbaimpino .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #enbaimpino .gt_left { text-align: left; }
 #enbaimpino .gt_center { text-align: center; }
 #enbaimpino .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #enbaimpino .gt_font_normal { font-weight: normal; }
 #enbaimpino .gt_font_bold { font-weight: bold; }
 #enbaimpino .gt_font_italic { font-style: italic; }
 #enbaimpino .gt_super { font-size: 65%; }
 #enbaimpino .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #enbaimpino .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
<th id="new_mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">new_mpg</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Mazda RX4</td>
<td class="gt_row gt_right">21.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.62</td>
<td class="gt_row gt_right">16.46</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">22.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Mazda RX4 Wag</td>
<td class="gt_row gt_right">999.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.875</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">22.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Datsun 710</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">108.0</td>
<td class="gt_row gt_right">93.0</td>
<td class="gt_row gt_right">3.85</td>
<td class="gt_row gt_right">2.32</td>
<td class="gt_row gt_right">18.61</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">23.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Hornet 4 Drive</td>
<td class="gt_row gt_right">21.4</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">258.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.08</td>
<td class="gt_row gt_right">3.215</td>
<td class="gt_row gt_right">19.44</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">22.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Hornet Sportabout</td>
<td class="gt_row gt_right">18.7</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">175.0</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">19.7</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Valiant</td>
<td class="gt_row gt_right">18.1</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">225.0</td>
<td class="gt_row gt_right">105.0</td>
<td class="gt_row gt_right">2.76</td>
<td class="gt_row gt_right">3.46</td>
<td class="gt_row gt_right">20.22</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">19.1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Duster 360</td>
<td class="gt_row gt_right">14.3</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">245.0</td>
<td class="gt_row gt_right">3.21</td>
<td class="gt_row gt_right">3.57</td>
<td class="gt_row gt_right">15.84</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">15.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 240D</td>
<td class="gt_row gt_right">24.4</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">146.7</td>
<td class="gt_row gt_right">62.0</td>
<td class="gt_row gt_right">3.69</td>
<td class="gt_row gt_right">3.19</td>
<td class="gt_row gt_right">20.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">25.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Merc 230</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">140.8</td>
<td class="gt_row gt_right">95.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">22.9</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">23.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 280</td>
<td class="gt_row gt_right">19.2</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">167.6</td>
<td class="gt_row gt_right">123.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">18.3</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">20.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 great_tables 库创建格式化的表格。</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pl)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div id="nfqwutwtau" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#nfqwutwtau table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#nfqwutwtau thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#nfqwutwtau p { margin: 0; padding: 0; }
 #nfqwutwtau .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #nfqwutwtau .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #nfqwutwtau .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #nfqwutwtau .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #nfqwutwtau .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #nfqwutwtau .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #nfqwutwtau .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #nfqwutwtau .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #nfqwutwtau .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #nfqwutwtau .gt_column_spanner_outer:first-child { padding-left: 0; }
 #nfqwutwtau .gt_column_spanner_outer:last-child { padding-right: 0; }
 #nfqwutwtau .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #nfqwutwtau .gt_spanner_row { border-bottom-style: hidden; }
 #nfqwutwtau .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #nfqwutwtau .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #nfqwutwtau .gt_from_md> :first-child { margin-top: 0; }
 #nfqwutwtau .gt_from_md> :last-child { margin-bottom: 0; }
 #nfqwutwtau .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #nfqwutwtau .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #nfqwutwtau .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #nfqwutwtau .gt_row_group_first td { border-top-width: 2px; }
 #nfqwutwtau .gt_row_group_first th { border-top-width: 2px; }
 #nfqwutwtau .gt_striped { color: #333333; background-color: #F4F4F4; }
 #nfqwutwtau .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #nfqwutwtau .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; }
 #nfqwutwtau .gt_first_grand_summary_row_bottom { border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; }
 #nfqwutwtau .gt_last_grand_summary_row_top { border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; }
 #nfqwutwtau .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #nfqwutwtau .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #nfqwutwtau .gt_left { text-align: left; }
 #nfqwutwtau .gt_center { text-align: center; }
 #nfqwutwtau .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #nfqwutwtau .gt_font_normal { font-weight: normal; }
 #nfqwutwtau .gt_font_bold { font-weight: bold; }
 #nfqwutwtau .gt_font_italic { font-style: italic; }
 #nfqwutwtau .gt_super { font-size: 65%; }
 #nfqwutwtau .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #nfqwutwtau .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Mazda RX4</td>
<td class="gt_row gt_right">21.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.62</td>
<td class="gt_row gt_right">16.46</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Mazda RX4 Wag</td>
<td class="gt_row gt_right">21.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.875</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Datsun 710</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">108.0</td>
<td class="gt_row gt_right">93.0</td>
<td class="gt_row gt_right">3.85</td>
<td class="gt_row gt_right">2.32</td>
<td class="gt_row gt_right">18.61</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">1.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Hornet 4 Drive</td>
<td class="gt_row gt_right">21.4</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">258.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.08</td>
<td class="gt_row gt_right">3.215</td>
<td class="gt_row gt_right">19.44</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Hornet Sportabout</td>
<td class="gt_row gt_right">18.7</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">175.0</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">2.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Valiant</td>
<td class="gt_row gt_right">18.1</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">225.0</td>
<td class="gt_row gt_right">105.0</td>
<td class="gt_row gt_right">2.76</td>
<td class="gt_row gt_right">3.46</td>
<td class="gt_row gt_right">20.22</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Duster 360</td>
<td class="gt_row gt_right">14.3</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">245.0</td>
<td class="gt_row gt_right">3.21</td>
<td class="gt_row gt_right">3.57</td>
<td class="gt_row gt_right">15.84</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 240D</td>
<td class="gt_row gt_right">24.4</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">146.7</td>
<td class="gt_row gt_right">62.0</td>
<td class="gt_row gt_right">3.69</td>
<td class="gt_row gt_right">3.19</td>
<td class="gt_row gt_right">20.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Merc 230</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">140.8</td>
<td class="gt_row gt_right">95.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">22.9</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 280</td>
<td class="gt_row gt_right">19.2</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">167.6</td>
<td class="gt_row gt_right">123.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">18.3</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="窗口函数" class="level1" data-number="22"><h1 data-number="22">
<span class="header-section-number">22</span> 窗口函数</h1>
<p>本节演示如何使用窗口函数对一组与当前行相关的表行执行计算。</p>
<section id="排名" class="level2" data-number="22.1"><h2 data-number="22.1" class="anchored" data-anchor-id="排名">
<span class="header-section-number">22.1</span> 排名</h2>
<p>在分区内对行进行排名。这里我们在每个 <code>cyl</code> 组内按 <code>mpg</code>（降序）对汽车进行排名。</p>
<div class="tabset-margin-container"></div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href="">SQL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href="">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false" href="">Python pandas</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false" href="">Python Polars</a></li>
</ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, cyl, mpg, </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rank</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> cyl <span class="kw">ORDER</span> <span class="kw">BY</span> mpg <span class="kw">DESC</span>) <span class="kw">as</span> <span class="fu">rank</span> </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> mtcars_table </span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> cyl, <span class="fu">rank</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span>;</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>9 records</caption>
<thead><tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">999.0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model_name, cyl, mpg) <span class="sc">|&gt;</span> </span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span> </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(mpg))) <span class="sc">|&gt;</span> </span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cyl, rank) <span class="sc">|&gt;</span> </span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   cyl [3]
   model_name          cyl   mpg  rank
   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
 1 Merc 240D             4  24.4     1
 2 Datsun 710            4  22.8     2
 3 Merc 230              4  22.8     2
 4 Hornet 4 Drive        6  21.4     1
 5 Mazda RX4             6  21       2
 6 Mazda RX4 Wag         6  21       2
 7 Merc 280              6  19.2     4
 8 Valiant               6  18.1     5
 9 Hornet Sportabout     8  18.7     1
10 Duster 360            8  14.3     2</code></pre>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 组内排名</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[[<span class="st">'model_name'</span>, <span class="st">'cyl'</span>, <span class="st">'mpg'</span>]].assign(</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    rank<span class="op">=</span>mtcars_pd.groupby(<span class="st">'cyl'</span>)[<span class="st">'mpg'</span>].rank(method<span class="op">=</span><span class="st">'min'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>).sort_values([<span class="st">'cyl'</span>, <span class="st">'rank'</span>]).head(<span class="dv">10</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                          model_name  cyl    mpg  rank
Merc 240D                  Merc 240D  4.0   24.4   1.0
Datsun 710                Datsun 710  4.0   22.8   2.0
Merc 230                    Merc 230  4.0   22.8   2.0
Mazda RX4 Wag          Mazda RX4 Wag  6.0  999.0   1.0
Hornet 4 Drive        Hornet 4 Drive  6.0   21.4   2.0
Mazda RX4                  Mazda RX4  6.0   21.0   3.0
Merc 280                    Merc 280  6.0   19.2   4.0
Valiant                      Valiant  6.0   18.1   5.0
Hornet Sportabout  Hornet Sportabout  8.0   18.7   1.0
Duster 360                Duster 360  8.0   14.3   2.0</code></pre>
</div>
</div>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(<span class="st">"model_name"</span>, <span class="st">"cyl"</span>, <span class="st">"mpg"</span>).with_columns(</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"mpg"</span>).rank(method<span class="op">=</span><span class="st">"min"</span>, descending<span class="op">=</span><span class="va">True</span>).over(<span class="st">"cyl"</span>).alias(<span class="st">"rank"</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>).sort(<span class="st">"cyl"</span>, <span class="st">"rank"</span>).head(<span class="dv">10</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details><div class="cell-output-display">
<div>
<style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">rank</th>
</tr>
<tr class="even">
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>u32</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Merc 240D"</td>
<td>4.0</td>
<td>24.4</td>
<td>1</td>
</tr>
<tr class="even">
<td>"Datsun 710"</td>
<td>4.0</td>
<td>22.8</td>
<td>2</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>4.0</td>
<td>22.8</td>
<td>2</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>6.0</td>
<td>21.4</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>6.0</td>
<td>21.0</td>
<td>2</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>6.0</td>
<td>21.0</td>
<td>2</td>
</tr>
<tr class="odd">
<td>"Merc 280"</td>
<td>6.0</td>
<td>19.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>6.0</td>
<td>18.1</td>
<td>5</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>8.0</td>
<td>18.7</td>
<td>1</td>
</tr>
<tr class="even">
<td>"Duster 360"</td>
<td>8.0</td>
<td>14.3</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 断开与数据库的连接并关闭它。</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button>
</div>
</details>
</div>
</section></section><section id="参考资料" class="level1" data-number="23"><h1 data-number="23">
<span class="header-section-number">23</span> 参考资料:</h1>
<ul>
<li><a href="https://duckdb.org/docs/stable/clients/r.html">DuckDB R 客户端文档</a></li>
<li><a href="https://duckdb.org/docs/stable/sql/statements">DuckDB SQL 语句</a></li>
</ul>
<!-- --></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark_dimmed"><script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      if (authorPrefersDark) {
          [baseTheme, altTheme] = [altTheme, baseTheme];
      }
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "jcwinning/into_sql";
    script.dataset.repoId = "";
    script.dataset.category = "General";
    script.dataset.categoryId = "";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5>
<button class="btn-close" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold">
<div class="sourceCode" id="cb168" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "SQL handbook"</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tony Duan"</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>本文档提供了使用 SQL、R 和 Python 执行常见数据操作任务的综合指南。它可作为理解如何在这三种流行的数据分析工具中实现相似结果的参考。</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## 介绍数据分析工具</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>在数据分析中，我们使用不同的工具，每个工具都有其优势：</span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SQL**：擅长结构化查询和数据库操作</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**R**：强大的统计计算和数据可视化</span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Python**：多功能编程，拥有优秀的数据科学库</span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>本教程展示了如何在所有三个工具中完成相同的数据操作任务，帮助您为您的需求选择正确的方法。</span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a><span class="fu"># 设置与配置</span></span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a><span class="fu">py_require</span>(<span class="fu">c</span>(<span class="st">"pandas"</span>,<span class="st">"Great-Tables"</span>,<span class="st">"polars"</span>,<span class="st">"pyarrow"</span>))</span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-42"><a href="#cb168-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries for database interaction, data manipulation, and connections.</span></span>
<span id="cb168-43"><a href="#cb168-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb168-44"><a href="#cb168-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb168-45"><a href="#cb168-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb168-46"><a href="#cb168-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)</span>
<span id="cb168-47"><a href="#cb168-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span>
<span id="cb168-48"><a href="#cb168-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-49"><a href="#cb168-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the R dataframes.</span></span>
<span id="cb168-50"><a href="#cb168-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the existing mtcars dataset if it exists.</span></span>
<span id="cb168-51"><a href="#cb168-51" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mtcars)</span>
<span id="cb168-52"><a href="#cb168-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the mtcars dataframe from the base R dataset, adding the row names as a new column.</span></span>
<span id="cb168-53"><a href="#cb168-53" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">model_name =</span> <span class="fu">rownames</span>(mtcars), mtcars) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb168-54"><a href="#cb168-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the iris dataframe from the base R dataset.</span></span>
<span id="cb168-55"><a href="#cb168-55" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">=</span> iris <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb168-56"><a href="#cb168-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-57"><a href="#cb168-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the database file if it already exists to start with a clean slate.</span></span>
<span id="cb168-58"><a href="#cb168-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"my-db.duckdb"</span>)) {</span>
<span id="cb168-59"><a href="#cb168-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(<span class="st">"my-db.duckdb"</span>)</span>
<span id="cb168-60"><a href="#cb168-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-61"><a href="#cb168-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a connection to the DuckDB database.</span></span>
<span id="cb168-62"><a href="#cb168-62" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"my-db.duckdb"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span>
<span id="cb168-63"><a href="#cb168-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the iris and mtcars dataframes to the database as tables.</span></span>
<span id="cb168-64"><a href="#cb168-64" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"iris_table"</span>, iris, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb168-65"><a href="#cb168-65" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"mtcars_table"</span>, mtcars, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb168-66"><a href="#cb168-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-67"><a href="#cb168-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-68"><a href="#cb168-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-69"><a href="#cb168-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-72"><a href="#cb168-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-73"><a href="#cb168-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb168-74"><a href="#cb168-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb168-75"><a href="#cb168-75" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb168-76"><a href="#cb168-76" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb168-77"><a href="#cb168-77" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb168-78"><a href="#cb168-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-79"><a href="#cb168-79" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span>
<span id="cb168-80"><a href="#cb168-80" aria-hidden="true" tabindex="-1"></a><span class="co">#print(python_version())</span></span>
<span id="cb168-81"><a href="#cb168-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-82"><a href="#cb168-82" aria-hidden="true" tabindex="-1"></a>cities_pd <span class="op">=</span> pd.DataFrame({</span>
<span id="cb168-83"><a href="#cb168-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">'country'</span>: [<span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>],</span>
<span id="cb168-84"><a href="#cb168-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>],</span>
<span id="cb168-85"><a href="#cb168-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">'year'</span>: [<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>],</span>
<span id="cb168-86"><a href="#cb168-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">'population'</span>: [<span class="dv">1005</span>, <span class="dv">1065</span>, <span class="dv">1158</span>, <span class="dv">564</span>, <span class="dv">608</span>, <span class="dv">738</span>, <span class="dv">8015</span>, <span class="dv">8175</span>, <span class="dv">8772</span>]</span>
<span id="cb168-87"><a href="#cb168-87" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb168-88"><a href="#cb168-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-89"><a href="#cb168-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the R dataframes available in the Python environment.</span></span>
<span id="cb168-90"><a href="#cb168-90" aria-hidden="true" tabindex="-1"></a>mtcars_pd <span class="op">=</span> r.mtcars</span>
<span id="cb168-91"><a href="#cb168-91" aria-hidden="true" tabindex="-1"></a>iris_pd <span class="op">=</span> r.iris</span>
<span id="cb168-92"><a href="#cb168-92" aria-hidden="true" tabindex="-1"></a>mtcars_pl <span class="op">=</span> pl.from_pandas(mtcars_pd)</span>
<span id="cb168-93"><a href="#cb168-93" aria-hidden="true" tabindex="-1"></a>iris_pl <span class="op">=</span> pl.from_pandas(iris_pd)</span>
<span id="cb168-94"><a href="#cb168-94" aria-hidden="true" tabindex="-1"></a>cities_pl<span class="op">=</span>pl.from_pandas(cities_pd)</span>
<span id="cb168-95"><a href="#cb168-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-96"><a href="#cb168-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-97"><a href="#cb168-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-98"><a href="#cb168-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>DuckDB 数据库 <span class="in">`my-db.duckdb`</span> 中有 <span class="in">`iris_table`</span> 和 <span class="in">`mtcars_table`</span> 表。</span>
<span id="cb168-99"><a href="#cb168-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>R 环境中有 <span class="in">`iris`</span> 和 <span class="in">`mtcars`</span> 数据框。</span>
<span id="cb168-100"><a href="#cb168-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Python 环境中有 <span class="in">`iris`</span> 和 <span class="in">`mtcars`</span> 数据框。</span>
<span id="cb168-101"><a href="#cb168-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-102"><a href="#cb168-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># 显示所有表</span></span>
<span id="cb168-103"><a href="#cb168-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-104"><a href="#cb168-104" aria-hidden="true" tabindex="-1"></a>本节演示如何列出每个环境中的所有可用表或数据框。</span>
<span id="cb168-105"><a href="#cb168-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-106"><a href="#cb168-106" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-107"><a href="#cb168-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-108"><a href="#cb168-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-109"><a href="#cb168-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-112"><a href="#cb168-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-113"><a href="#cb168-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-114"><a href="#cb168-114" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示所连接数据库中的所有表。</span></span>
<span id="cb168-115"><a href="#cb168-115" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb168-116"><a href="#cb168-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-117"><a href="#cb168-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-118"><a href="#cb168-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-119"><a href="#cb168-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-122"><a href="#cb168-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-123"><a href="#cb168-123" aria-hidden="true" tabindex="-1"></a><span class="co"># 列出当前 R 环境中的所有数据框。</span></span>
<span id="cb168-124"><a href="#cb168-124" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.data.frame, <span class="fu">as.list</span>(.GlobalEnv))</span>
<span id="cb168-125"><a href="#cb168-125" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dflist)</span>
<span id="cb168-126"><a href="#cb168-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-127"><a href="#cb168-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-128"><a href="#cb168-128" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-129"><a href="#cb168-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-132"><a href="#cb168-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-133"><a href="#cb168-133" aria-hidden="true" tabindex="-1"></a><span class="co"># 列出当前 Python 环境中的所有 pandas 数据框。</span></span>
<span id="cb168-134"><a href="#cb168-134" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb168-135"><a href="#cb168-135" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">dir</span>() <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">eval</span>(var), pd.core.frame.DataFrame)]</span>
<span id="cb168-136"><a href="#cb168-136" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span>
<span id="cb168-137"><a href="#cb168-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-138"><a href="#cb168-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-139"><a href="#cb168-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-140"><a href="#cb168-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-143"><a href="#cb168-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-144"><a href="#cb168-144" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb168-145"><a href="#cb168-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-146"><a href="#cb168-146" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [name <span class="cf">for</span> name, val <span class="kw">in</span> <span class="bu">globals</span>().items() <span class="cf">if</span> <span class="bu">isinstance</span>(val, pl.DataFrame)]</span>
<span id="cb168-147"><a href="#cb168-147" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span>
<span id="cb168-148"><a href="#cb168-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-149"><a href="#cb168-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-150"><a href="#cb168-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-151"><a href="#cb168-151" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-152"><a href="#cb168-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-153"><a href="#cb168-153" aria-hidden="true" tabindex="-1"></a><span class="fu"># 描述表</span></span>
<span id="cb168-154"><a href="#cb168-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-155"><a href="#cb168-155" aria-hidden="true" tabindex="-1"></a>本节介绍如何获取表结构和统计信息的摘要。</span>
<span id="cb168-156"><a href="#cb168-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-157"><a href="#cb168-157" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-158"><a href="#cb168-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-159"><a href="#cb168-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-160"><a href="#cb168-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-163"><a href="#cb168-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-164"><a href="#cb168-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-165"><a href="#cb168-165" aria-hidden="true" tabindex="-1"></a><span class="co">-- 描述 mtcars_table 的列和数据类型。</span></span>
<span id="cb168-166"><a href="#cb168-166" aria-hidden="true" tabindex="-1"></a><span class="kw">DESCRIBE</span> mtcars_table;</span>
<span id="cb168-167"><a href="#cb168-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-168"><a href="#cb168-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-169"><a href="#cb168-169" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-170"><a href="#cb168-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-173"><a href="#cb168-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-174"><a href="#cb168-174" aria-hidden="true" tabindex="-1"></a><span class="co"># 提供 mtcars 数据框的详细摘要。</span></span>
<span id="cb168-175"><a href="#cb168-175" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mtcars)</span>
<span id="cb168-176"><a href="#cb168-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-177"><a href="#cb168-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-178"><a href="#cb168-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-179"><a href="#cb168-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-182"><a href="#cb168-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-183"><a href="#cb168-183" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成 mtcars 数据框的描述性统计信息。</span></span>
<span id="cb168-184"><a href="#cb168-184" aria-hidden="true" tabindex="-1"></a>mtcars_pd.describe(include<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb168-185"><a href="#cb168-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-186"><a href="#cb168-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-187"><a href="#cb168-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-188"><a href="#cb168-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-189"><a href="#cb168-189" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-190"><a href="#cb168-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-193"><a href="#cb168-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-194"><a href="#cb168-194" aria-hidden="true" tabindex="-1"></a>mtcars_pl.describe()</span>
<span id="cb168-195"><a href="#cb168-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-196"><a href="#cb168-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-197"><a href="#cb168-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-198"><a href="#cb168-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-199"><a href="#cb168-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-200"><a href="#cb168-200" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-201"><a href="#cb168-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-202"><a href="#cb168-202" aria-hidden="true" tabindex="-1"></a><span class="fu"># 显示列名</span></span>
<span id="cb168-203"><a href="#cb168-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-204"><a href="#cb168-204" aria-hidden="true" tabindex="-1"></a>本节演示如何检索表的列名。</span>
<span id="cb168-205"><a href="#cb168-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-206"><a href="#cb168-206" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-207"><a href="#cb168-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-208"><a href="#cb168-208" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-209"><a href="#cb168-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-212"><a href="#cb168-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-213"><a href="#cb168-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-214"><a href="#cb168-214" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示 mtcars_table 中列的信息。</span></span>
<span id="cb168-215"><a href="#cb168-215" aria-hidden="true" tabindex="-1"></a>PRAGMA table_info(mtcars_table);</span>
<span id="cb168-216"><a href="#cb168-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-217"><a href="#cb168-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-218"><a href="#cb168-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-219"><a href="#cb168-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-222"><a href="#cb168-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-223"><a href="#cb168-223" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取 mtcars 数据框的列名。</span></span>
<span id="cb168-224"><a href="#cb168-224" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span>
<span id="cb168-225"><a href="#cb168-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-226"><a href="#cb168-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-227"><a href="#cb168-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-228"><a href="#cb168-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-231"><a href="#cb168-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-232"><a href="#cb168-232" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 mtcars 数据框获取列名列表。</span></span>
<span id="cb168-233"><a href="#cb168-233" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb168-234"><a href="#cb168-234" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(mtcars_pd.columns.values)</span>
<span id="cb168-235"><a href="#cb168-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-236"><a href="#cb168-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-237"><a href="#cb168-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-238"><a href="#cb168-238" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-239"><a href="#cb168-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-242"><a href="#cb168-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-243"><a href="#cb168-243" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 mtcars 数据框获取列名列表。</span></span>
<span id="cb168-244"><a href="#cb168-244" aria-hidden="true" tabindex="-1"></a>mtcars_pl.columns</span>
<span id="cb168-245"><a href="#cb168-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-246"><a href="#cb168-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-247"><a href="#cb168-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-248"><a href="#cb168-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-249"><a href="#cb168-249" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-250"><a href="#cb168-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-251"><a href="#cb168-251" aria-hidden="true" tabindex="-1"></a><span class="fu"># 选择</span></span>
<span id="cb168-252"><a href="#cb168-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-253"><a href="#cb168-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## 选择前 6 行并重命名</span></span>
<span id="cb168-254"><a href="#cb168-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-255"><a href="#cb168-255" aria-hidden="true" tabindex="-1"></a>本节介绍如何选择列的子集、重命名它们并限制返回的行数。</span>
<span id="cb168-256"><a href="#cb168-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-257"><a href="#cb168-257" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-258"><a href="#cb168-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-259"><a href="#cb168-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-260"><a href="#cb168-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-263"><a href="#cb168-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-264"><a href="#cb168-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-265"><a href="#cb168-265" aria-hidden="true" tabindex="-1"></a><span class="co">-- 选择并重命名列，将结果限制为前 6 行。</span></span>
<span id="cb168-266"><a href="#cb168-266" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">6</span>;</span>
<span id="cb168-267"><a href="#cb168-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-268"><a href="#cb168-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-269"><a href="#cb168-269" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-270"><a href="#cb168-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-273"><a href="#cb168-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-274"><a href="#cb168-274" aria-hidden="true" tabindex="-1"></a><span class="co"># 从 mtcars 数据框的前 6 行中选择并重命名列。</span></span>
<span id="cb168-275"><a href="#cb168-275" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars, <span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl)</span>
<span id="cb168-276"><a href="#cb168-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-277"><a href="#cb168-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-278"><a href="#cb168-278" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-279"><a href="#cb168-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-282"><a href="#cb168-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-283"><a href="#cb168-283" aria-hidden="true" tabindex="-1"></a><span class="co"># 重命名 mtcars 数据框中的列。</span></span>
<span id="cb168-284"><a href="#cb168-284" aria-hidden="true" tabindex="-1"></a>mtcars_pd.rename(columns<span class="op">=</span>{<span class="st">'model_name'</span>: <span class="st">'model'</span>})</span>
<span id="cb168-285"><a href="#cb168-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-286"><a href="#cb168-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-287"><a href="#cb168-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-288"><a href="#cb168-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-291"><a href="#cb168-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-292"><a href="#cb168-292" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"model_name"</span>).alias(<span class="st">"model"</span>), pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).head(<span class="dv">6</span>)</span>
<span id="cb168-293"><a href="#cb168-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-294"><a href="#cb168-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-295"><a href="#cb168-295" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-296"><a href="#cb168-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-297"><a href="#cb168-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## 选择不同行</span></span>
<span id="cb168-298"><a href="#cb168-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-299"><a href="#cb168-299" aria-hidden="true" tabindex="-1"></a>本节演示如何根据指定的列检索唯一的行。</span>
<span id="cb168-300"><a href="#cb168-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-301"><a href="#cb168-301" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-302"><a href="#cb168-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-303"><a href="#cb168-303" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-304"><a href="#cb168-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-307"><a href="#cb168-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-308"><a href="#cb168-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-309"><a href="#cb168-309" aria-hidden="true" tabindex="-1"></a><span class="co">-- 选择 mpg 和 cyl 的不同组合。</span></span>
<span id="cb168-310"><a href="#cb168-310" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> mpg, cyl <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-311"><a href="#cb168-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-312"><a href="#cb168-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-313"><a href="#cb168-313" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-314"><a href="#cb168-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-317"><a href="#cb168-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-318"><a href="#cb168-318" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 和 cyl 获取不同的行。</span></span>
<span id="cb168-319"><a href="#cb168-319" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(mpg, cyl)</span>
<span id="cb168-320"><a href="#cb168-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-321"><a href="#cb168-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-322"><a href="#cb168-322" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-323"><a href="#cb168-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-326"><a href="#cb168-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-327"><a href="#cb168-327" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择特定列并删除重复行。</span></span>
<span id="cb168-328"><a href="#cb168-328" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> mtcars_pd[[<span class="st">"mpg"</span>, <span class="st">"cyl"</span>]]</span>
<span id="cb168-329"><a href="#cb168-329" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.drop_duplicates())</span>
<span id="cb168-330"><a href="#cb168-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-331"><a href="#cb168-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-332"><a href="#cb168-332" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-333"><a href="#cb168-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-336"><a href="#cb168-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-337"><a href="#cb168-337" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).unique()</span>
<span id="cb168-338"><a href="#cb168-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-339"><a href="#cb168-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-340"><a href="#cb168-340" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-341"><a href="#cb168-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-342"><a href="#cb168-342" aria-hidden="true" tabindex="-1"></a><span class="fu"># 检查行数和列数</span></span>
<span id="cb168-343"><a href="#cb168-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-344"><a href="#cb168-344" aria-hidden="true" tabindex="-1"></a>本节介绍如何查找表的维度。</span>
<span id="cb168-345"><a href="#cb168-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-346"><a href="#cb168-346" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-347"><a href="#cb168-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-348"><a href="#cb168-348" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-349"><a href="#cb168-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-352"><a href="#cb168-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-353"><a href="#cb168-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-354"><a href="#cb168-354" aria-hidden="true" tabindex="-1"></a><span class="co">-- 获取总行数。</span></span>
<span id="cb168-355"><a href="#cb168-355" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> row_number <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-356"><a href="#cb168-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-357"><a href="#cb168-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-360"><a href="#cb168-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-361"><a href="#cb168-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-362"><a href="#cb168-362" aria-hidden="true" tabindex="-1"></a><span class="co">-- 获取总列数。</span></span>
<span id="cb168-363"><a href="#cb168-363" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> column_number <span class="kw">FROM</span> (<span class="kw">DESCRIBE</span> mtcars_table);</span>
<span id="cb168-364"><a href="#cb168-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-365"><a href="#cb168-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-366"><a href="#cb168-366" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-367"><a href="#cb168-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-370"><a href="#cb168-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-371"><a href="#cb168-371" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取行数。</span></span>
<span id="cb168-372"><a href="#cb168-372" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars)</span>
<span id="cb168-373"><a href="#cb168-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-374"><a href="#cb168-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-377"><a href="#cb168-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-378"><a href="#cb168-378" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取列数。</span></span>
<span id="cb168-379"><a href="#cb168-379" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mtcars)</span>
<span id="cb168-380"><a href="#cb168-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-381"><a href="#cb168-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-382"><a href="#cb168-382" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-383"><a href="#cb168-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-386"><a href="#cb168-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-387"><a href="#cb168-387" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取行数。</span></span>
<span id="cb168-388"><a href="#cb168-388" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">0</span>]</span>
<span id="cb168-389"><a href="#cb168-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-390"><a href="#cb168-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-393"><a href="#cb168-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-394"><a href="#cb168-394" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取列数。</span></span>
<span id="cb168-395"><a href="#cb168-395" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">1</span>]</span>
<span id="cb168-396"><a href="#cb168-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-397"><a href="#cb168-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-398"><a href="#cb168-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-399"><a href="#cb168-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-400"><a href="#cb168-400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-401"><a href="#cb168-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-404"><a href="#cb168-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-405"><a href="#cb168-405" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取行数。</span></span>
<span id="cb168-406"><a href="#cb168-406" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">0</span>]</span>
<span id="cb168-407"><a href="#cb168-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-408"><a href="#cb168-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-411"><a href="#cb168-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-412"><a href="#cb168-412" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取列数。</span></span>
<span id="cb168-413"><a href="#cb168-413" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">1</span>]</span>
<span id="cb168-414"><a href="#cb168-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-415"><a href="#cb168-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-416"><a href="#cb168-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-417"><a href="#cb168-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-418"><a href="#cb168-418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-419"><a href="#cb168-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-420"><a href="#cb168-420" aria-hidden="true" tabindex="-1"></a><span class="fu"># 创建列</span></span>
<span id="cb168-421"><a href="#cb168-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-422"><a href="#cb168-422" aria-hidden="true" tabindex="-1"></a>本节演示如何基于现有数据向表中添加新列。</span>
<span id="cb168-423"><a href="#cb168-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-424"><a href="#cb168-424" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-425"><a href="#cb168-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-426"><a href="#cb168-426" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-427"><a href="#cb168-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-430"><a href="#cb168-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-431"><a href="#cb168-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-432"><a href="#cb168-432" aria-hidden="true" tabindex="-1"></a><span class="co">-- 通过对现有列执行计算来创建新列。</span></span>
<span id="cb168-433"><a href="#cb168-433" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, mpg <span class="op">+</span> <span class="dv">1</span> <span class="kw">AS</span> new_mpg <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-434"><a href="#cb168-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-435"><a href="#cb168-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-436"><a href="#cb168-436" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-437"><a href="#cb168-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-440"><a href="#cb168-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-441"><a href="#cb168-441" aria-hidden="true" tabindex="-1"></a><span class="co"># 向数据框添加新列。</span></span>
<span id="cb168-442"><a href="#cb168-442" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_mpg =</span> mpg <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb168-443"><a href="#cb168-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-444"><a href="#cb168-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-445"><a href="#cb168-445" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-446"><a href="#cb168-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-449"><a href="#cb168-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-450"><a href="#cb168-450" aria-hidden="true" tabindex="-1"></a><span class="co"># 在数据框中创建新列。</span></span>
<span id="cb168-451"><a href="#cb168-451" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="st">"new_mpg"</span>] <span class="op">=</span> mtcars_pd[<span class="st">"mpg"</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb168-452"><a href="#cb168-452" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span>
<span id="cb168-453"><a href="#cb168-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-454"><a href="#cb168-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-455"><a href="#cb168-455" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-456"><a href="#cb168-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-459"><a href="#cb168-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-460"><a href="#cb168-460" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns((pl.col(<span class="st">"mpg"</span>) <span class="op">+</span> <span class="dv">1</span>).alias(<span class="st">"new_mpg"</span>))</span>
<span id="cb168-461"><a href="#cb168-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-462"><a href="#cb168-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-463"><a href="#cb168-463" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-464"><a href="#cb168-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-465"><a href="#cb168-465" aria-hidden="true" tabindex="-1"></a><span class="fu"># 筛选</span></span>
<span id="cb168-466"><a href="#cb168-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-467"><a href="#cb168-467" aria-hidden="true" tabindex="-1"></a>本节介绍如何选择满足特定条件的行。</span>
<span id="cb168-468"><a href="#cb168-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-469"><a href="#cb168-469" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-470"><a href="#cb168-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-471"><a href="#cb168-471" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-472"><a href="#cb168-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-475"><a href="#cb168-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-476"><a href="#cb168-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-477"><a href="#cb168-477" aria-hidden="true" tabindex="-1"></a><span class="co">-- 使用 AND 运算符根据多个条件筛选行。</span></span>
<span id="cb168-478"><a href="#cb168-478" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">AND</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span>
<span id="cb168-479"><a href="#cb168-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-480"><a href="#cb168-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-483"><a href="#cb168-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-484"><a href="#cb168-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-485"><a href="#cb168-485" aria-hidden="true" tabindex="-1"></a><span class="co">-- 使用 OR 运算符筛选行。</span></span>
<span id="cb168-486"><a href="#cb168-486" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">OR</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span>
<span id="cb168-487"><a href="#cb168-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-488"><a href="#cb168-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-489"><a href="#cb168-489" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-490"><a href="#cb168-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-493"><a href="#cb168-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-494"><a href="#cb168-494" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 &amp; 运算符进行“与”筛选。</span></span>
<span id="cb168-495"><a href="#cb168-495" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">&amp;</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb168-496"><a href="#cb168-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-497"><a href="#cb168-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-500"><a href="#cb168-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-501"><a href="#cb168-501" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 | 运算符进行“或”筛选。</span></span>
<span id="cb168-502"><a href="#cb168-502" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">|</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb168-503"><a href="#cb168-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-504"><a href="#cb168-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-505"><a href="#cb168-505" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-506"><a href="#cb168-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-509"><a href="#cb168-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-510"><a href="#cb168-510" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 query 方法进行“与”筛选。</span></span>
<span id="cb168-511"><a href="#cb168-511" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 and cyl == 6'</span>)</span>
<span id="cb168-512"><a href="#cb168-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-513"><a href="#cb168-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-516"><a href="#cb168-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-517"><a href="#cb168-517" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 query 方法进行“或”筛选。</span></span>
<span id="cb168-518"><a href="#cb168-518" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 or cyl == 6'</span>)</span>
<span id="cb168-519"><a href="#cb168-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-520"><a href="#cb168-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-521"><a href="#cb168-521" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-522"><a href="#cb168-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-525"><a href="#cb168-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-526"><a href="#cb168-526" aria-hidden="true" tabindex="-1"></a><span class="co"># polars 的“与”筛选</span></span>
<span id="cb168-527"><a href="#cb168-527" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span>
<span id="cb168-528"><a href="#cb168-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-529"><a href="#cb168-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-532"><a href="#cb168-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-533"><a href="#cb168-533" aria-hidden="true" tabindex="-1"></a><span class="co"># polars 的“或”筛选</span></span>
<span id="cb168-534"><a href="#cb168-534" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">|</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span>
<span id="cb168-535"><a href="#cb168-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-536"><a href="#cb168-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-537"><a href="#cb168-537" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-538"><a href="#cb168-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-539"><a href="#cb168-539" aria-hidden="true" tabindex="-1"></a><span class="fu"># 排序</span></span>
<span id="cb168-540"><a href="#cb168-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-541"><a href="#cb168-541" aria-hidden="true" tabindex="-1"></a>本节演示如何根据一个或多个列对表进行排序。</span>
<span id="cb168-542"><a href="#cb168-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-543"><a href="#cb168-543" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-544"><a href="#cb168-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-545"><a href="#cb168-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-546"><a href="#cb168-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-549"><a href="#cb168-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-550"><a href="#cb168-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-551"><a href="#cb168-551" aria-hidden="true" tabindex="-1"></a><span class="co">-- 按 mpg 降序对结果进行排序，并显示前 3 行。</span></span>
<span id="cb168-552"><a href="#cb168-552" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">AS</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">ORDER</span> <span class="kw">BY</span> mpg <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">3</span>;</span>
<span id="cb168-553"><a href="#cb168-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-554"><a href="#cb168-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-555"><a href="#cb168-555" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-556"><a href="#cb168-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-559"><a href="#cb168-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-560"><a href="#cb168-560" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 mpg 降序排列数据框。</span></span>
<span id="cb168-561"><a href="#cb168-561" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb168-562"><a href="#cb168-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-563"><a href="#cb168-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-564"><a href="#cb168-564" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-565"><a href="#cb168-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-568"><a href="#cb168-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-569"><a href="#cb168-569" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 mpg 降序对数据框进行排序。</span></span>
<span id="cb168-570"><a href="#cb168-570" aria-hidden="true" tabindex="-1"></a>mtcars_pd[[<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>]].sort_values(by<span class="op">=</span><span class="st">'mpg'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">3</span>)</span>
<span id="cb168-571"><a href="#cb168-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-572"><a href="#cb168-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-573"><a href="#cb168-573" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-574"><a href="#cb168-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-577"><a href="#cb168-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-578"><a href="#cb168-578" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>).sort(<span class="st">"mpg"</span>, descending<span class="op">=</span><span class="va">True</span>).head(<span class="dv">3</span>)</span>
<span id="cb168-579"><a href="#cb168-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-580"><a href="#cb168-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-581"><a href="#cb168-581" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-582"><a href="#cb168-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-583"><a href="#cb168-583" aria-hidden="true" tabindex="-1"></a><span class="fu"># 分组</span></span>
<span id="cb168-584"><a href="#cb168-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-585"><a href="#cb168-585" aria-hidden="true" tabindex="-1"></a>本节介绍如何对行进行分组并执行聚合计算。</span>
<span id="cb168-586"><a href="#cb168-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-587"><a href="#cb168-587" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-588"><a href="#cb168-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-589"><a href="#cb168-589" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-590"><a href="#cb168-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-593"><a href="#cb168-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-594"><a href="#cb168-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-595"><a href="#cb168-595" aria-hidden="true" tabindex="-1"></a><span class="co">-- 按 model_name 分组，并计算 mpg 的总和和 cyl 的平均值。</span></span>
<span id="cb168-596"><a href="#cb168-596" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb168-597"><a href="#cb168-597" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span> <span class="kw">LIMIT</span> <span class="dv">5</span>;</span>
<span id="cb168-598"><a href="#cb168-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-599"><a href="#cb168-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-600"><a href="#cb168-600" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-601"><a href="#cb168-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-604"><a href="#cb168-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-605"><a href="#cb168-605" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 model_name 分组并汇总数据。</span></span>
<span id="cb168-606"><a href="#cb168-606" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">group_by</span>(model_name) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">total_mpg =</span> <span class="fu">sum</span>(mpg), <span class="at">cyl_mean =</span> <span class="fu">mean</span>(cyl)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb168-607"><a href="#cb168-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-608"><a href="#cb168-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-609"><a href="#cb168-609" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-610"><a href="#cb168-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-613"><a href="#cb168-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-614"><a href="#cb168-614" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 model_name 分组并聚合数据。</span></span>
<span id="cb168-615"><a href="#cb168-615" aria-hidden="true" tabindex="-1"></a>mtcars_pd.groupby(<span class="st">'model_name'</span>).agg({<span class="st">'mpg'</span>: <span class="st">'sum'</span>, <span class="st">'cyl'</span>: <span class="st">'mean'</span>}).head(<span class="dv">5</span>)</span>
<span id="cb168-616"><a href="#cb168-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-617"><a href="#cb168-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-618"><a href="#cb168-618" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-619"><a href="#cb168-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-622"><a href="#cb168-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-623"><a href="#cb168-623" aria-hidden="true" tabindex="-1"></a>mtcars_pl.group_by(<span class="st">"model_name"</span>).agg([</span>
<span id="cb168-624"><a href="#cb168-624" aria-hidden="true" tabindex="-1"></a>    pl.<span class="bu">sum</span>(<span class="st">"mpg"</span>).alias(<span class="st">"total_mpg"</span>),</span>
<span id="cb168-625"><a href="#cb168-625" aria-hidden="true" tabindex="-1"></a>    pl.mean(<span class="st">"cyl"</span>).alias(<span class="st">"cyl_mean"</span>)</span>
<span id="cb168-626"><a href="#cb168-626" aria-hidden="true" tabindex="-1"></a>]).head(<span class="dv">5</span>)</span>
<span id="cb168-627"><a href="#cb168-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-628"><a href="#cb168-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-629"><a href="#cb168-629" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-630"><a href="#cb168-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-631"><a href="#cb168-631" aria-hidden="true" tabindex="-1"></a><span class="fu"># 创建表</span></span>
<span id="cb168-632"><a href="#cb168-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-633"><a href="#cb168-633" aria-hidden="true" tabindex="-1"></a><span class="fu">## CREATE OR REPLACE</span></span>
<span id="cb168-634"><a href="#cb168-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-635"><a href="#cb168-635" aria-hidden="true" tabindex="-1"></a>此命令创建新表或覆盖现有表。</span>
<span id="cb168-636"><a href="#cb168-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-639"><a href="#cb168-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-640"><a href="#cb168-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-641"><a href="#cb168-641" aria-hidden="true" tabindex="-1"></a><span class="co">-- 创建一个临时表，如果它已存在则替换它。</span></span>
<span id="cb168-642"><a href="#cb168-642" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> mtcars_table_group <span class="kw">AS</span></span>
<span id="cb168-643"><a href="#cb168-643" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb168-644"><a href="#cb168-644" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span>
<span id="cb168-645"><a href="#cb168-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-646"><a href="#cb168-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-647"><a href="#cb168-647" aria-hidden="true" tabindex="-1"></a><span class="fu">## CREATE TABLE IF NOT EXISTS</span></span>
<span id="cb168-648"><a href="#cb168-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-649"><a href="#cb168-649" aria-hidden="true" tabindex="-1"></a>此命令仅在表尚不存在时创建表。</span>
<span id="cb168-650"><a href="#cb168-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-653"><a href="#cb168-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-654"><a href="#cb168-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-655"><a href="#cb168-655" aria-hidden="true" tabindex="-1"></a><span class="co">-- 仅在尚不存在的情况下创建新表。</span></span>
<span id="cb168-656"><a href="#cb168-656" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> new_mtcars_table_group <span class="kw">AS</span></span>
<span id="cb168-657"><a href="#cb168-657" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb168-658"><a href="#cb168-658" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span>
<span id="cb168-659"><a href="#cb168-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-660"><a href="#cb168-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-661"><a href="#cb168-661" aria-hidden="true" tabindex="-1"></a><span class="fu"># 唯一值</span></span>
<span id="cb168-662"><a href="#cb168-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-663"><a href="#cb168-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## 检查唯一值</span></span>
<span id="cb168-664"><a href="#cb168-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-665"><a href="#cb168-665" aria-hidden="true" tabindex="-1"></a>本节演示如何验证列中值的唯一性。</span>
<span id="cb168-666"><a href="#cb168-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-667"><a href="#cb168-667" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-668"><a href="#cb168-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-669"><a href="#cb168-669" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-670"><a href="#cb168-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-673"><a href="#cb168-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-674"><a href="#cb168-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-675"><a href="#cb168-675" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算总行数和不同 model_name 的数量。</span></span>
<span id="cb168-676"><a href="#cb168-676" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>), <span class="fu">count</span>(<span class="kw">DISTINCT</span> model_name) <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-677"><a href="#cb168-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-678"><a href="#cb168-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-679"><a href="#cb168-679" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-680"><a href="#cb168-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-683"><a href="#cb168-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-684"><a href="#cb168-684" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算总行数和不同 model_name 的数量。</span></span>
<span id="cb168-685"><a href="#cb168-685" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(mtcars_pd), mtcars_pd.model_name.nunique())</span>
<span id="cb168-686"><a href="#cb168-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-687"><a href="#cb168-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-688"><a href="#cb168-688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb168-689"><a href="#cb168-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-692"><a href="#cb168-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-693"><a href="#cb168-693" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算总行数和不同 model_name 的数量。</span></span>
<span id="cb168-694"><a href="#cb168-694" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.count(), pl.col(<span class="st">"model_name"</span>).n_unique())</span>
<span id="cb168-695"><a href="#cb168-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-696"><a href="#cb168-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-697"><a href="#cb168-697" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-698"><a href="#cb168-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-699"><a href="#cb168-699" aria-hidden="true" tabindex="-1"></a><span class="fu">## 获取重复和非重复数据</span></span>
<span id="cb168-700"><a href="#cb168-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-701"><a href="#cb168-701" aria-hidden="true" tabindex="-1"></a>本节演示如何根据单个列获取重复和非重复数据。</span>
<span id="cb168-702"><a href="#cb168-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-703"><a href="#cb168-703" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-704"><a href="#cb168-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-705"><a href="#cb168-705" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-706"><a href="#cb168-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-707"><a href="#cb168-707" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 显示所有重复项</span></span>
<span id="cb168-708"><a href="#cb168-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-711"><a href="#cb168-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-712"><a href="#cb168-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-713"><a href="#cb168-713" aria-hidden="true" tabindex="-1"></a><span class="co">-- 根据 mpg 列获取重复行。</span></span>
<span id="cb168-714"><a href="#cb168-714" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">&gt;</span> <span class="dv">1</span>);</span>
<span id="cb168-715"><a href="#cb168-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-716"><a href="#cb168-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-717"><a href="#cb168-717" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 保留非重复项</span></span>
<span id="cb168-718"><a href="#cb168-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-721"><a href="#cb168-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-722"><a href="#cb168-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-723"><a href="#cb168-723" aria-hidden="true" tabindex="-1"></a><span class="co">-- 根据 mpg 列获取非重复行。</span></span>
<span id="cb168-724"><a href="#cb168-724" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">=</span> <span class="dv">1</span>);</span>
<span id="cb168-725"><a href="#cb168-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-726"><a href="#cb168-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-727"><a href="#cb168-727" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb168-728"><a href="#cb168-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-729"><a href="#cb168-729" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 显示所有重复项</span></span>
<span id="cb168-730"><a href="#cb168-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-731"><a href="#cb168-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-734"><a href="#cb168-734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-735"><a href="#cb168-735" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取重复行。</span></span>
<span id="cb168-736"><a href="#cb168-736" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">duplicated</span>(mpg) <span class="sc">|</span> <span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span>
<span id="cb168-737"><a href="#cb168-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-738"><a href="#cb168-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-739"><a href="#cb168-739" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 保留非重复项</span></span>
<span id="cb168-740"><a href="#cb168-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-741"><a href="#cb168-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-744"><a href="#cb168-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-745"><a href="#cb168-745" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取非重复行。</span></span>
<span id="cb168-746"><a href="#cb168-746" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(mpg) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span>
<span id="cb168-747"><a href="#cb168-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-748"><a href="#cb168-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-749"><a href="#cb168-749" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-750"><a href="#cb168-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-751"><a href="#cb168-751" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 显示所有重复项</span></span>
<span id="cb168-752"><a href="#cb168-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-753"><a href="#cb168-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-756"><a href="#cb168-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-757"><a href="#cb168-757" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取重复行。</span></span>
<span id="cb168-758"><a href="#cb168-758" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb168-759"><a href="#cb168-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-760"><a href="#cb168-760" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 保留非重复项</span></span>
<span id="cb168-761"><a href="#cb168-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-764"><a href="#cb168-764" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-765"><a href="#cb168-765" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取非重复行。</span></span>
<span id="cb168-766"><a href="#cb168-766" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="op">~</span>mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb168-767"><a href="#cb168-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-768"><a href="#cb168-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-769"><a href="#cb168-769" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb168-770"><a href="#cb168-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-773"><a href="#cb168-773" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-774"><a href="#cb168-774" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取重复行。</span></span>
<span id="cb168-775"><a href="#cb168-775" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_duplicated())</span>
<span id="cb168-776"><a href="#cb168-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-777"><a href="#cb168-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-778"><a href="#cb168-778" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 保留非重复项</span></span>
<span id="cb168-779"><a href="#cb168-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-782"><a href="#cb168-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-783"><a href="#cb168-783" aria-hidden="true" tabindex="-1"></a><span class="co"># 根据 mpg 列获取非重复行。</span></span>
<span id="cb168-784"><a href="#cb168-784" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_unique())</span>
<span id="cb168-785"><a href="#cb168-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-786"><a href="#cb168-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-787"><a href="#cb168-787" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-788"><a href="#cb168-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-789"><a href="#cb168-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-790"><a href="#cb168-790" aria-hidden="true" tabindex="-1"></a><span class="fu"># 连接</span></span>
<span id="cb168-791"><a href="#cb168-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-794"><a href="#cb168-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-795"><a href="#cb168-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-796"><a href="#cb168-796" aria-hidden="true" tabindex="-1"></a><span class="co">-- 从新创建的临时表中选择所有数据。</span></span>
<span id="cb168-797"><a href="#cb168-797" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group t1;</span>
<span id="cb168-798"><a href="#cb168-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-799"><a href="#cb168-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-800"><a href="#cb168-800" aria-hidden="true" tabindex="-1"></a><span class="fu">## 左连接</span></span>
<span id="cb168-801"><a href="#cb168-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-802"><a href="#cb168-802" aria-hidden="true" tabindex="-1"></a>本节介绍如何执行左连接以组合来自两个表的数据。</span>
<span id="cb168-803"><a href="#cb168-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-804"><a href="#cb168-804" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-805"><a href="#cb168-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-806"><a href="#cb168-806" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-807"><a href="#cb168-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-810"><a href="#cb168-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-811"><a href="#cb168-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-812"><a href="#cb168-812" aria-hidden="true" tabindex="-1"></a><span class="co">-- 在 mtcars_table 和 mtcars_table_group 之间执行左连接。</span></span>
<span id="cb168-813"><a href="#cb168-813" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb168-814"><a href="#cb168-814" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> mtcars_table_group t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name</span>
<span id="cb168-815"><a href="#cb168-815" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span>;</span>
<span id="cb168-816"><a href="#cb168-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-817"><a href="#cb168-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-818"><a href="#cb168-818" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-819"><a href="#cb168-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-822"><a href="#cb168-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-823"><a href="#cb168-823" aria-hidden="true" tabindex="-1"></a><span class="co"># 对 mtcars 数据框与其自身执行左连接。</span></span>
<span id="cb168-824"><a href="#cb168-824" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">left_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb168-825"><a href="#cb168-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-826"><a href="#cb168-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-827"><a href="#cb168-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-828"><a href="#cb168-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-831"><a href="#cb168-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-832"><a href="#cb168-832" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 pandas 执行左连接。</span></span>
<span id="cb168-833"><a href="#cb168-833" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'left'</span>).head(<span class="dv">5</span>)</span>
<span id="cb168-834"><a href="#cb168-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-835"><a href="#cb168-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-836"><a href="#cb168-836" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-837"><a href="#cb168-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-840"><a href="#cb168-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-841"><a href="#cb168-841" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"left"</span>).head(<span class="dv">5</span>)</span>
<span id="cb168-842"><a href="#cb168-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-843"><a href="#cb168-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-844"><a href="#cb168-844" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-845"><a href="#cb168-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-846"><a href="#cb168-846" aria-hidden="true" tabindex="-1"></a><span class="fu">## 内连接</span></span>
<span id="cb168-847"><a href="#cb168-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-848"><a href="#cb168-848" aria-hidden="true" tabindex="-1"></a>本节演示如何执行内连接。</span>
<span id="cb168-849"><a href="#cb168-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-850"><a href="#cb168-850" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-851"><a href="#cb168-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-852"><a href="#cb168-852" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-853"><a href="#cb168-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-856"><a href="#cb168-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-857"><a href="#cb168-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-858"><a href="#cb168-858" aria-hidden="true" tabindex="-1"></a><span class="co">-- 使用子查询执行内连接。</span></span>
<span id="cb168-859"><a href="#cb168-859" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb168-860"><a href="#cb168-860" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name;</span>
<span id="cb168-861"><a href="#cb168-861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-862"><a href="#cb168-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-863"><a href="#cb168-863" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-864"><a href="#cb168-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-867"><a href="#cb168-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-868"><a href="#cb168-868" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行内连接。</span></span>
<span id="cb168-869"><a href="#cb168-869" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb168-870"><a href="#cb168-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-871"><a href="#cb168-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-872"><a href="#cb168-872" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-873"><a href="#cb168-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-876"><a href="#cb168-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-877"><a href="#cb168-877" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 pandas 执行内连接。</span></span>
<span id="cb168-878"><a href="#cb168-878" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'inner'</span>).head(<span class="dv">5</span>)</span>
<span id="cb168-879"><a href="#cb168-879" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-880"><a href="#cb168-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-881"><a href="#cb168-881" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-882"><a href="#cb168-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-885"><a href="#cb168-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-886"><a href="#cb168-886" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"inner"</span>).head(<span class="dv">5</span>)</span>
<span id="cb168-887"><a href="#cb168-887" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-888"><a href="#cb168-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-889"><a href="#cb168-889" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-890"><a href="#cb168-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-891"><a href="#cb168-891" aria-hidden="true" tabindex="-1"></a><span class="fu"># 追加行</span></span>
<span id="cb168-892"><a href="#cb168-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-893"><a href="#cb168-893" aria-hidden="true" tabindex="-1"></a><span class="fu">## 追加时不消除重复项 (`union all`)</span></span>
<span id="cb168-894"><a href="#cb168-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-895"><a href="#cb168-895" aria-hidden="true" tabindex="-1"></a>本节介绍如何组合来自两个表的行，并保留所有重复项。</span>
<span id="cb168-896"><a href="#cb168-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-897"><a href="#cb168-897" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-898"><a href="#cb168-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-899"><a href="#cb168-899" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-900"><a href="#cb168-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-903"><a href="#cb168-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-904"><a href="#cb168-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-905"><a href="#cb168-905" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算原始表中的行数。</span></span>
<span id="cb168-906"><a href="#cb168-906" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-907"><a href="#cb168-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-908"><a href="#cb168-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-911"><a href="#cb168-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-912"><a href="#cb168-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-913"><a href="#cb168-913" aria-hidden="true" tabindex="-1"></a><span class="co">-- 通过将 mtcars_table 追加到自身（包括重复项）来创建新表。</span></span>
<span id="cb168-914"><a href="#cb168-914" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb168-915"><a href="#cb168-915" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb168-916"><a href="#cb168-916" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb168-917"><a href="#cb168-917" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-918"><a href="#cb168-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-919"><a href="#cb168-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-922"><a href="#cb168-922" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-923"><a href="#cb168-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-924"><a href="#cb168-924" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算新表中的行数。</span></span>
<span id="cb168-925"><a href="#cb168-925" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span>
<span id="cb168-926"><a href="#cb168-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-927"><a href="#cb168-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-928"><a href="#cb168-928" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb168-929"><a href="#cb168-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-932"><a href="#cb168-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-933"><a href="#cb168-933" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 bind_rows 追加行。</span></span>
<span id="cb168-934"><a href="#cb168-934" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars)</span>
<span id="cb168-935"><a href="#cb168-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-936"><a href="#cb168-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-937"><a href="#cb168-937" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-938"><a href="#cb168-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-941"><a href="#cb168-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-942"><a href="#cb168-942" aria-hidden="true" tabindex="-1"></a><span class="co"># 连接数据框，保留所有行。</span></span>
<span id="cb168-943"><a href="#cb168-943" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb168-944"><a href="#cb168-944" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-945"><a href="#cb168-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-946"><a href="#cb168-946" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-947"><a href="#cb168-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-948"><a href="#cb168-948" aria-hidden="true" tabindex="-1"></a><span class="fu">## 追加时消除重复项 (`union`)</span></span>
<span id="cb168-949"><a href="#cb168-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-950"><a href="#cb168-950" aria-hidden="true" tabindex="-1"></a>本节演示如何在组合行时删除重复条目。</span>
<span id="cb168-951"><a href="#cb168-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-952"><a href="#cb168-952" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-953"><a href="#cb168-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-954"><a href="#cb168-954" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-955"><a href="#cb168-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-958"><a href="#cb168-958" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-959"><a href="#cb168-959" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-960"><a href="#cb168-960" aria-hidden="true" tabindex="-1"></a><span class="co">-- 创建一个表，删除重复行。</span></span>
<span id="cb168-961"><a href="#cb168-961" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb168-962"><a href="#cb168-962" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb168-963"><a href="#cb168-963" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb168-964"><a href="#cb168-964" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-965"><a href="#cb168-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-966"><a href="#cb168-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-969"><a href="#cb168-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-970"><a href="#cb168-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-971"><a href="#cb168-971" aria-hidden="true" tabindex="-1"></a><span class="co">-- 计算新表中的行数。</span></span>
<span id="cb168-972"><a href="#cb168-972" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span>
<span id="cb168-973"><a href="#cb168-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-974"><a href="#cb168-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-977"><a href="#cb168-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-978"><a href="#cb168-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-979"><a href="#cb168-979" aria-hidden="true" tabindex="-1"></a><span class="co">-- 验证不同行的计数。</span></span>
<span id="cb168-980"><a href="#cb168-980" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> (</span>
<span id="cb168-981"><a href="#cb168-981" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="op">*</span> <span class="kw">FROM</span> double_mtcars_table</span>
<span id="cb168-982"><a href="#cb168-982" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb168-983"><a href="#cb168-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-984"><a href="#cb168-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-985"><a href="#cb168-985" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb168-986"><a href="#cb168-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-989"><a href="#cb168-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-990"><a href="#cb168-990" aria-hidden="true" tabindex="-1"></a><span class="co"># 追加行然后删除重复项。</span></span>
<span id="cb168-991"><a href="#cb168-991" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span>
<span id="cb168-992"><a href="#cb168-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-993"><a href="#cb168-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-994"><a href="#cb168-994" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-995"><a href="#cb168-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-998"><a href="#cb168-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-999"><a href="#cb168-999" aria-hidden="true" tabindex="-1"></a><span class="co"># 连接数据框然后删除重复项。</span></span>
<span id="cb168-1000"><a href="#cb168-1000" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>).drop_duplicates()</span>
<span id="cb168-1001"><a href="#cb168-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1002"><a href="#cb168-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1003"><a href="#cb168-1003" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1004"><a href="#cb168-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1005"><a href="#cb168-1005" aria-hidden="true" tabindex="-1"></a><span class="fu"># 删除行</span></span>
<span id="cb168-1006"><a href="#cb168-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1007"><a href="#cb168-1007" aria-hidden="true" tabindex="-1"></a>本节介绍如何根据条件从表中删除行。</span>
<span id="cb168-1008"><a href="#cb168-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1009"><a href="#cb168-1009" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1010"><a href="#cb168-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1011"><a href="#cb168-1011" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-1012"><a href="#cb168-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1015"><a href="#cb168-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1016"><a href="#cb168-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1017"><a href="#cb168-1017" aria-hidden="true" tabindex="-1"></a><span class="co">-- 从表中删除特定行。</span></span>
<span id="cb168-1018"><a href="#cb168-1018" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4'</span>;</span>
<span id="cb168-1019"><a href="#cb168-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1020"><a href="#cb168-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1023"><a href="#cb168-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1024"><a href="#cb168-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1025"><a href="#cb168-1025" aria-hidden="true" tabindex="-1"></a><span class="co">-- 验证删除后的行数。</span></span>
<span id="cb168-1026"><a href="#cb168-1026" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb168-1027"><a href="#cb168-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1028"><a href="#cb168-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1029"><a href="#cb168-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-1030"><a href="#cb168-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1033"><a href="#cb168-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-1034"><a href="#cb168-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># 筛选掉指定的行。</span></span>
<span id="cb168-1035"><a href="#cb168-1035" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">!=</span> <span class="st">'Mazda RX4'</span>)</span>
<span id="cb168-1036"><a href="#cb168-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1037"><a href="#cb168-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1038"><a href="#cb168-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-1039"><a href="#cb168-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1042"><a href="#cb168-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1043"><a href="#cb168-1043" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择除指定行之外的所有行。</span></span>
<span id="cb168-1044"><a href="#cb168-1044" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">!=</span> <span class="st">'Mazda RX4'</span>]</span>
<span id="cb168-1045"><a href="#cb168-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1046"><a href="#cb168-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1047"><a href="#cb168-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-1048"><a href="#cb168-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1051"><a href="#cb168-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1052"><a href="#cb168-1052" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"model_name"</span>) <span class="op">!=</span> <span class="st">'Mazda RX4'</span>)</span>
<span id="cb168-1053"><a href="#cb168-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1054"><a href="#cb168-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1055"><a href="#cb168-1055" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1056"><a href="#cb168-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1057"><a href="#cb168-1057" aria-hidden="true" tabindex="-1"></a><span class="fu"># 更新行</span></span>
<span id="cb168-1058"><a href="#cb168-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1059"><a href="#cb168-1059" aria-hidden="true" tabindex="-1"></a>本节演示如何修改表中的现有数据。</span>
<span id="cb168-1060"><a href="#cb168-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1061"><a href="#cb168-1061" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1062"><a href="#cb168-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1063"><a href="#cb168-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb168-1064"><a href="#cb168-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1067"><a href="#cb168-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1068"><a href="#cb168-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1069"><a href="#cb168-1069" aria-hidden="true" tabindex="-1"></a><span class="co">-- 选择要更新的行。</span></span>
<span id="cb168-1070"><a href="#cb168-1070" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span>
<span id="cb168-1071"><a href="#cb168-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1072"><a href="#cb168-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1075"><a href="#cb168-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1076"><a href="#cb168-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1077"><a href="#cb168-1077" aria-hidden="true" tabindex="-1"></a><span class="co">-- 更新特定行的列值。</span></span>
<span id="cb168-1078"><a href="#cb168-1078" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> mtcars_table</span>
<span id="cb168-1079"><a href="#cb168-1079" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> mpg <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb168-1080"><a href="#cb168-1080" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span>
<span id="cb168-1081"><a href="#cb168-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1082"><a href="#cb168-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1085"><a href="#cb168-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1086"><a href="#cb168-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1087"><a href="#cb168-1087" aria-hidden="true" tabindex="-1"></a><span class="co">-- 验证更新。</span></span>
<span id="cb168-1088"><a href="#cb168-1088" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span>
<span id="cb168-1089"><a href="#cb168-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1090"><a href="#cb168-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1091"><a href="#cb168-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-1092"><a href="#cb168-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1095"><a href="#cb168-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-1096"><a href="#cb168-1096" aria-hidden="true" tabindex="-1"></a><span class="co"># 在筛选的选择中更新值。</span></span>
<span id="cb168-1097"><a href="#cb168-1097" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">mpg =</span> <span class="dv">999</span>)</span>
<span id="cb168-1098"><a href="#cb168-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1099"><a href="#cb168-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1100"><a href="#cb168-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-1101"><a href="#cb168-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1104"><a href="#cb168-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1105"><a href="#cb168-1105" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 .loc 更新特定值。</span></span>
<span id="cb168-1106"><a href="#cb168-1106" aria-hidden="true" tabindex="-1"></a>mtcars_pd.loc[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>, <span class="st">'mpg'</span>] <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb168-1107"><a href="#cb168-1107" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span>
<span id="cb168-1108"><a href="#cb168-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1109"><a href="#cb168-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1110"><a href="#cb168-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-1111"><a href="#cb168-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1114"><a href="#cb168-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1115"><a href="#cb168-1115" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns(</span>
<span id="cb168-1116"><a href="#cb168-1116" aria-hidden="true" tabindex="-1"></a>    pl.when(pl.col(<span class="st">"model_name"</span>) <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>)</span>
<span id="cb168-1117"><a href="#cb168-1117" aria-hidden="true" tabindex="-1"></a>    .then(<span class="dv">999</span>)</span>
<span id="cb168-1118"><a href="#cb168-1118" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.col(<span class="st">"mpg"</span>))</span>
<span id="cb168-1119"><a href="#cb168-1119" aria-hidden="true" tabindex="-1"></a>    .alias(<span class="st">"mpg"</span>)</span>
<span id="cb168-1120"><a href="#cb168-1120" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-1121"><a href="#cb168-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1122"><a href="#cb168-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1123"><a href="#cb168-1123" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1124"><a href="#cb168-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1125"><a href="#cb168-1125" aria-hidden="true" tabindex="-1"></a><span class="fu"># 删除表</span></span>
<span id="cb168-1126"><a href="#cb168-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1127"><a href="#cb168-1127" aria-hidden="true" tabindex="-1"></a>本节介绍如何从数据库中删除表。</span>
<span id="cb168-1128"><a href="#cb168-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1129"><a href="#cb168-1129" aria-hidden="true" tabindex="-1"></a>删除表之前：</span>
<span id="cb168-1130"><a href="#cb168-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1133"><a href="#cb168-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1134"><a href="#cb168-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1135"><a href="#cb168-1135" aria-hidden="true" tabindex="-1"></a><span class="co">-- 在删除一个表之前显示所有表。</span></span>
<span id="cb168-1136"><a href="#cb168-1136" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb168-1137"><a href="#cb168-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1138"><a href="#cb168-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1139"><a href="#cb168-1139" aria-hidden="true" tabindex="-1"></a>删除表：</span>
<span id="cb168-1140"><a href="#cb168-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1143"><a href="#cb168-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1144"><a href="#cb168-1144" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1145"><a href="#cb168-1145" aria-hidden="true" tabindex="-1"></a><span class="co">-- 如果存在，则删除指定的表。</span></span>
<span id="cb168-1146"><a href="#cb168-1146" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> mtcars_table_group;</span>
<span id="cb168-1147"><a href="#cb168-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1148"><a href="#cb168-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1149"><a href="#cb168-1149" aria-hidden="true" tabindex="-1"></a>删除表之后：</span>
<span id="cb168-1150"><a href="#cb168-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1153"><a href="#cb168-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1154"><a href="#cb168-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1155"><a href="#cb168-1155" aria-hidden="true" tabindex="-1"></a><span class="co">-- 再次显示所有表以确认删除。</span></span>
<span id="cb168-1156"><a href="#cb168-1156" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb168-1157"><a href="#cb168-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1158"><a href="#cb168-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1159"><a href="#cb168-1159" aria-hidden="true" tabindex="-1"></a><span class="fu"># PIVOT (透视)</span></span>
<span id="cb168-1160"><a href="#cb168-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1161"><a href="#cb168-1161" aria-hidden="true" tabindex="-1"></a>本节演示如何将数据从长格式转换为宽格式。</span>
<span id="cb168-1162"><a href="#cb168-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1165"><a href="#cb168-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1166"><a href="#cb168-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1167"><a href="#cb168-1167" aria-hidden="true" tabindex="-1"></a><span class="co">-- 为透视演示创建一个临时表。</span></span>
<span id="cb168-1168"><a href="#cb168-1168" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> cities;</span>
<span id="cb168-1169"><a href="#cb168-1169" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> cities (</span>
<span id="cb168-1170"><a href="#cb168-1170" aria-hidden="true" tabindex="-1"></a>    country <span class="dt">VARCHAR</span>, name <span class="dt">VARCHAR</span>, <span class="fu">year</span> <span class="dt">INTEGER</span>, population <span class="dt">INTEGER</span></span>
<span id="cb168-1171"><a href="#cb168-1171" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb168-1172"><a href="#cb168-1172" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> cities <span class="kw">VALUES</span></span>
<span id="cb168-1173"><a href="#cb168-1173" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2000</span>, <span class="dv">1005</span>),</span>
<span id="cb168-1174"><a href="#cb168-1174" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2010</span>, <span class="dv">1065</span>),</span>
<span id="cb168-1175"><a href="#cb168-1175" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2020</span>, <span class="dv">1158</span>),</span>
<span id="cb168-1176"><a href="#cb168-1176" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2000</span>, <span class="dv">564</span>),</span>
<span id="cb168-1177"><a href="#cb168-1177" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2010</span>, <span class="dv">608</span>),</span>
<span id="cb168-1178"><a href="#cb168-1178" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2020</span>, <span class="dv">738</span>),</span>
<span id="cb168-1179"><a href="#cb168-1179" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2000</span>, <span class="dv">8015</span>),</span>
<span id="cb168-1180"><a href="#cb168-1180" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2010</span>, <span class="dv">8175</span>),</span>
<span id="cb168-1181"><a href="#cb168-1181" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2020</span>, <span class="dv">8772</span>);</span>
<span id="cb168-1182"><a href="#cb168-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1183"><a href="#cb168-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1186"><a href="#cb168-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1187"><a href="#cb168-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1188"><a href="#cb168-1188" aria-hidden="true" tabindex="-1"></a><span class="co">-- 查看原始数据。</span></span>
<span id="cb168-1189"><a href="#cb168-1189" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> cities;</span>
<span id="cb168-1190"><a href="#cb168-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1191"><a href="#cb168-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1192"><a href="#cb168-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">## 对一列进行透视</span></span>
<span id="cb168-1193"><a href="#cb168-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1194"><a href="#cb168-1194" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1195"><a href="#cb168-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1196"><a href="#cb168-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-1197"><a href="#cb168-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1200"><a href="#cb168-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1201"><a href="#cb168-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1202"><a href="#cb168-1202" aria-hidden="true" tabindex="-1"></a><span class="co">-- 对 'year' 列进行透视。</span></span>
<span id="cb168-1203"><a href="#cb168-1203" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb168-1204"><a href="#cb168-1204" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="fu">year</span></span>
<span id="cb168-1205"><a href="#cb168-1205" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb168-1206"><a href="#cb168-1206" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country;</span>
<span id="cb168-1207"><a href="#cb168-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1208"><a href="#cb168-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1209"><a href="#cb168-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-1210"><a href="#cb168-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1213"><a href="#cb168-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1214"><a href="#cb168-1214" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb168-1215"><a href="#cb168-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1216"><a href="#cb168-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1217"><a href="#cb168-1217" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb168-1218"><a href="#cb168-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1221"><a href="#cb168-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1222"><a href="#cb168-1222" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb168-1223"><a href="#cb168-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1224"><a href="#cb168-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1225"><a href="#cb168-1225" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1226"><a href="#cb168-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1227"><a href="#cb168-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">## 对两列进行透视</span></span>
<span id="cb168-1228"><a href="#cb168-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1229"><a href="#cb168-1229" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1230"><a href="#cb168-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1231"><a href="#cb168-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-1232"><a href="#cb168-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1235"><a href="#cb168-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1236"><a href="#cb168-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1237"><a href="#cb168-1237" aria-hidden="true" tabindex="-1"></a><span class="co">-- 对 'country' 和 'name' 进行透视。</span></span>
<span id="cb168-1238"><a href="#cb168-1238" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb168-1239"><a href="#cb168-1239" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> country, name</span>
<span id="cb168-1240"><a href="#cb168-1240" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population);</span>
<span id="cb168-1241"><a href="#cb168-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1242"><a href="#cb168-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1243"><a href="#cb168-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-1244"><a href="#cb168-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1247"><a href="#cb168-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1248"><a href="#cb168-1248" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb168-1249"><a href="#cb168-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1250"><a href="#cb168-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1251"><a href="#cb168-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb168-1252"><a href="#cb168-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1255"><a href="#cb168-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1256"><a href="#cb168-1256" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb168-1257"><a href="#cb168-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1258"><a href="#cb168-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1259"><a href="#cb168-1259" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1260"><a href="#cb168-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1261"><a href="#cb168-1261" aria-hidden="true" tabindex="-1"></a><span class="fu"># UNPIVOT (逆透视)</span></span>
<span id="cb168-1262"><a href="#cb168-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1263"><a href="#cb168-1263" aria-hidden="true" tabindex="-1"></a>本节介绍如何将数据从宽格式转换为长格式。</span>
<span id="cb168-1264"><a href="#cb168-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1265"><a href="#cb168-1265" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1266"><a href="#cb168-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1267"><a href="#cb168-1267" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-1268"><a href="#cb168-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1271"><a href="#cb168-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1272"><a href="#cb168-1272" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1273"><a href="#cb168-1273" aria-hidden="true" tabindex="-1"></a><span class="co">-- 对先前透视的表进行逆透视。</span></span>
<span id="cb168-1274"><a href="#cb168-1274" aria-hidden="true" tabindex="-1"></a>UNPIVOT</span>
<span id="cb168-1275"><a href="#cb168-1275" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb168-1276"><a href="#cb168-1276" aria-hidden="true" tabindex="-1"></a>  PIVOT cities</span>
<span id="cb168-1277"><a href="#cb168-1277" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> <span class="fu">year</span></span>
<span id="cb168-1278"><a href="#cb168-1278" aria-hidden="true" tabindex="-1"></a>  <span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb168-1279"><a href="#cb168-1279" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> country</span>
<span id="cb168-1280"><a href="#cb168-1280" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-1281"><a href="#cb168-1281" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="kw">COLUMNS</span>(<span class="op">*</span> EXCLUDE (country))</span>
<span id="cb168-1282"><a href="#cb168-1282" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span></span>
<span id="cb168-1283"><a href="#cb168-1283" aria-hidden="true" tabindex="-1"></a>    NAME <span class="fu">year</span></span>
<span id="cb168-1284"><a href="#cb168-1284" aria-hidden="true" tabindex="-1"></a>    VALUE population;</span>
<span id="cb168-1285"><a href="#cb168-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1286"><a href="#cb168-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1287"><a href="#cb168-1287" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-1288"><a href="#cb168-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1289"><a href="#cb168-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1290"><a href="#cb168-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1291"><a href="#cb168-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1294"><a href="#cb168-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1295"><a href="#cb168-1295" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd <span class="op">=</span> cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb168-1296"><a href="#cb168-1296" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd.melt(id_vars<span class="op">=</span><span class="st">'country'</span>, value_vars<span class="op">=</span>[<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>], var_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span>
<span id="cb168-1297"><a href="#cb168-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1298"><a href="#cb168-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1299"><a href="#cb168-1299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb168-1300"><a href="#cb168-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1303"><a href="#cb168-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1304"><a href="#cb168-1304" aria-hidden="true" tabindex="-1"></a>cities_pl <span class="op">=</span> pl.from_pandas(cities_pd)</span>
<span id="cb168-1305"><a href="#cb168-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1306"><a href="#cb168-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1307"><a href="#cb168-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1310"><a href="#cb168-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1311"><a href="#cb168-1311" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl <span class="op">=</span> cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb168-1312"><a href="#cb168-1312" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl.unpivot(index<span class="op">=</span><span class="st">'country'</span>, on<span class="op">=</span>[<span class="st">'2000'</span>, <span class="st">'2010'</span>, <span class="st">'2020'</span>], variable_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span>
<span id="cb168-1313"><a href="#cb168-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1314"><a href="#cb168-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1315"><a href="#cb168-1315" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1316"><a href="#cb168-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1317"><a href="#cb168-1317" aria-hidden="true" tabindex="-1"></a><span class="fu"># EXPLAIN (解释)</span></span>
<span id="cb168-1318"><a href="#cb168-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1319"><a href="#cb168-1319" aria-hidden="true" tabindex="-1"></a>本节演示如何分析查询的执行计划。</span>
<span id="cb168-1320"><a href="#cb168-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1323"><a href="#cb168-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1324"><a href="#cb168-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb168-1325"><a href="#cb168-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1326"><a href="#cb168-1326" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示查询的逻辑执行计划。</span></span>
<span id="cb168-1327"><a href="#cb168-1327" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span></span>
<span id="cb168-1328"><a href="#cb168-1328" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb168-1329"><a href="#cb168-1329" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name;</span>
<span id="cb168-1330"><a href="#cb168-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1331"><a href="#cb168-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1334"><a href="#cb168-1334" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1335"><a href="#cb168-1335" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb168-1336"><a href="#cb168-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1337"><a href="#cb168-1337" aria-hidden="true" tabindex="-1"></a><span class="co">-- 显示详细的执行计划，包括计时信息。</span></span>
<span id="cb168-1338"><a href="#cb168-1338" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> <span class="kw">ANALYZE</span></span>
<span id="cb168-1339"><a href="#cb168-1339" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb168-1340"><a href="#cb168-1340" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name;</span>
<span id="cb168-1341"><a href="#cb168-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1342"><a href="#cb168-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1343"><a href="#cb168-1343" aria-hidden="true" tabindex="-1"></a><span class="fu"># 显示精美的表格</span></span>
<span id="cb168-1344"><a href="#cb168-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1345"><a href="#cb168-1345" aria-hidden="true" tabindex="-1"></a>本节介绍如何创建格式精美的表格以供演示。</span>
<span id="cb168-1346"><a href="#cb168-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1347"><a href="#cb168-1347" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1348"><a href="#cb168-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1349"><a href="#cb168-1349" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb168-1350"><a href="#cb168-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1353"><a href="#cb168-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-1354"><a href="#cb168-1354" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 gt 库创建格式化的表格。</span></span>
<span id="cb168-1355"><a href="#cb168-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb168-1356"><a href="#cb168-1356" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span>
<span id="cb168-1357"><a href="#cb168-1357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1358"><a href="#cb168-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1359"><a href="#cb168-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb168-1360"><a href="#cb168-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1363"><a href="#cb168-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1364"><a href="#cb168-1364" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 great_tables 库创建格式化的表格。</span></span>
<span id="cb168-1365"><a href="#cb168-1365" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb168-1366"><a href="#cb168-1366" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pd)</span>
<span id="cb168-1367"><a href="#cb168-1367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1368"><a href="#cb168-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1369"><a href="#cb168-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb168-1370"><a href="#cb168-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1373"><a href="#cb168-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1374"><a href="#cb168-1374" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 great_tables 库创建格式化的表格。</span></span>
<span id="cb168-1375"><a href="#cb168-1375" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb168-1376"><a href="#cb168-1376" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pl)</span>
<span id="cb168-1377"><a href="#cb168-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1378"><a href="#cb168-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1379"><a href="#cb168-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1380"><a href="#cb168-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1381"><a href="#cb168-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1382"><a href="#cb168-1382" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1383"><a href="#cb168-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1384"><a href="#cb168-1384" aria-hidden="true" tabindex="-1"></a><span class="fu"># 窗口函数</span></span>
<span id="cb168-1385"><a href="#cb168-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1386"><a href="#cb168-1386" aria-hidden="true" tabindex="-1"></a>本节演示如何使用窗口函数对一组与当前行相关的表行执行计算。</span>
<span id="cb168-1387"><a href="#cb168-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1388"><a href="#cb168-1388" aria-hidden="true" tabindex="-1"></a><span class="fu">## 排名</span></span>
<span id="cb168-1389"><a href="#cb168-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1390"><a href="#cb168-1390" aria-hidden="true" tabindex="-1"></a>在分区内对行进行排名。这里我们在每个 <span class="in">`cyl`</span> 组内按 <span class="in">`mpg`</span>（降序）对汽车进行排名。</span>
<span id="cb168-1391"><a href="#cb168-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1392"><a href="#cb168-1392" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb168-1393"><a href="#cb168-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1394"><a href="#cb168-1394" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb168-1395"><a href="#cb168-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1398"><a href="#cb168-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb168-1399"><a href="#cb168-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb168-1400"><a href="#cb168-1400" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, cyl, mpg, </span>
<span id="cb168-1401"><a href="#cb168-1401" aria-hidden="true" tabindex="-1"></a>       rank() OVER (PARTITION <span class="kw">BY</span> cyl <span class="kw">ORDER</span> <span class="kw">BY</span> mpg <span class="kw">DESC</span>) <span class="kw">as</span> rank </span>
<span id="cb168-1402"><a href="#cb168-1402" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> mtcars_table </span>
<span id="cb168-1403"><a href="#cb168-1403" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> cyl, rank</span>
<span id="cb168-1404"><a href="#cb168-1404" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span>;</span>
<span id="cb168-1405"><a href="#cb168-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1406"><a href="#cb168-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1407"><a href="#cb168-1407" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb168-1408"><a href="#cb168-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1411"><a href="#cb168-1411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-1412"><a href="#cb168-1412" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb168-1413"><a href="#cb168-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model_name, cyl, mpg) <span class="sc">|&gt;</span> </span>
<span id="cb168-1414"><a href="#cb168-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">|&gt;</span> </span>
<span id="cb168-1415"><a href="#cb168-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(mpg))) <span class="sc">|&gt;</span> </span>
<span id="cb168-1416"><a href="#cb168-1416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cyl, rank) <span class="sc">|&gt;</span> </span>
<span id="cb168-1417"><a href="#cb168-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb168-1418"><a href="#cb168-1418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1419"><a href="#cb168-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1420"><a href="#cb168-1420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb168-1421"><a href="#cb168-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1424"><a href="#cb168-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1425"><a href="#cb168-1425" aria-hidden="true" tabindex="-1"></a><span class="co"># 组内排名</span></span>
<span id="cb168-1426"><a href="#cb168-1426" aria-hidden="true" tabindex="-1"></a>mtcars_pd[[<span class="st">'model_name'</span>, <span class="st">'cyl'</span>, <span class="st">'mpg'</span>]].assign(</span>
<span id="cb168-1427"><a href="#cb168-1427" aria-hidden="true" tabindex="-1"></a>    rank<span class="op">=</span>mtcars_pd.groupby(<span class="st">'cyl'</span>)[<span class="st">'mpg'</span>].rank(method<span class="op">=</span><span class="st">'min'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb168-1428"><a href="#cb168-1428" aria-hidden="true" tabindex="-1"></a>).sort_values([<span class="st">'cyl'</span>, <span class="st">'rank'</span>]).head(<span class="dv">10</span>)</span>
<span id="cb168-1429"><a href="#cb168-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1430"><a href="#cb168-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1431"><a href="#cb168-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb168-1432"><a href="#cb168-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1435"><a href="#cb168-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb168-1436"><a href="#cb168-1436" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(<span class="st">"model_name"</span>, <span class="st">"cyl"</span>, <span class="st">"mpg"</span>).with_columns(</span>
<span id="cb168-1437"><a href="#cb168-1437" aria-hidden="true" tabindex="-1"></a>    pl.col(<span class="st">"mpg"</span>).rank(method<span class="op">=</span><span class="st">"min"</span>, descending<span class="op">=</span><span class="va">True</span>).over(<span class="st">"cyl"</span>).alias(<span class="st">"rank"</span>)</span>
<span id="cb168-1438"><a href="#cb168-1438" aria-hidden="true" tabindex="-1"></a>).sort(<span class="st">"cyl"</span>, <span class="st">"rank"</span>).head(<span class="dv">10</span>)</span>
<span id="cb168-1439"><a href="#cb168-1439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1440"><a href="#cb168-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1441"><a href="#cb168-1441" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb168-1442"><a href="#cb168-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1445"><a href="#cb168-1445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb168-1446"><a href="#cb168-1446" aria-hidden="true" tabindex="-1"></a><span class="co"># 断开与数据库的连接并关闭它。</span></span>
<span id="cb168-1447"><a href="#cb168-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb168-1448"><a href="#cb168-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb168-1449"><a href="#cb168-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1450"><a href="#cb168-1450" aria-hidden="true" tabindex="-1"></a><span class="fu"># 参考资料:</span></span>
<span id="cb168-1451"><a href="#cb168-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-1452"><a href="#cb168-1452" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">DuckDB R 客户端文档</span><span class="co">](https://duckdb.org/docs/stable/clients/r.html)</span></span>
<span id="cb168-1453"><a href="#cb168-1453" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">DuckDB SQL 语句</span><span class="co">](https://duckdb.org/docs/stable/sql/statements)</span></span>
</code></pre></div>
<button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button>
</div>
</div></div>
</div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
       
    </div>   
    <div class="nav-footer-center">
       
    </div>
    <div class="nav-footer-right">
<p>This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
</body>
</html>
